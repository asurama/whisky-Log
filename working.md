# Whisky Log - 개발 진행 상황

## ✅ **완료된 기능들**

### 1. **사용자 인증**
- Supabase Auth를 사용한 이메일/비밀번호 로그인/회원가입
- 로그아웃 기능

### 2. **위스키 컬렉션 관리**
- 위스키 추가/수정/삭제
- 브랜드 선택 또는 직접 입력
- 빈티지, 숙성연수, 시중가, 구매가, 할인율 자동 계산
- 구매장소, 구매일 기록
- 보틀 상태 관리 (미오픈/오픈)
- 이미지 업로드 (Supabase Storage)
- **기본 용량 750ml 설정** - 대부분의 위스키는 750ml이므로 기본값으로 설정, 특이한 용량만 수정

### 3. **시음 기록**
- 시음 타입별 기록 (바, 모임, 구매한 보틀)
- 노즈, 팔레트, 피니쉬 별도 평가 (1-10점, 소숫점 1자리)
- 전체 평점 자동 계산
- 상세 메모 작성
- 함께한 사람 기록
- **소비량 추적** - 시음 시 소비량 입력으로 남은 용량 자동 계산

### 4. **시음 기록 조회**
- 위스키별 시음 기록 조회
- 전체 시음 목록 조회
- 시음 기록 수정/삭제

### 5. **검색 및 필터링**
- 위스키 이름, 브랜드로 검색
- 보틀 상태별 필터링 (전체/오픈/미오픈)
- 브랜드별 필터링
- 가격대별 필터링
- 고급 검색 옵션

### 6. **통계 및 분석**
- 위스키 통계 (총 개수, 오픈/미오픈 개수, 총 구매 금액)
- 시음 통계 (총 시음 횟수, 평균 평점, 타입별 분포)
- **소비량 통계** (총 소비량, 총 용량, 남은 용량, 소비율)
- 브랜드별 위스키 분포 차트
- 시음 타입별 분포 파이 차트
- 가격대별 분포 차트

### 7. **위시리스트**
- 위시리스트 아이템 추가/수정/삭제
- 브랜드 선택 또는 직접 입력
- 우선순위 설정 (낮음/보통/높음)
- 구매 완료 시 위스키 컬렉션으로 이동
- 구매 시에만 구매가, 구매장소, 구매일 입력
- **기본 용량 750ml 설정** - 위스키 추가와 동일하게 기본값 적용

### 8. **이미지 업로드**
- 위스키 보틀 이미지 업로드
- Supabase Storage 활용
- 이미지 미리보기
- 모바일 카메라 지원
- 선택사항으로 설정

### 9. **데이터 내보내기/가져오기**
- 엑셀 파일로 데이터 내보내기 (위스키 컬렉션, 시음 기록, 위시리스트)
- 엑셀 파일에서 데이터 가져오기
- 백업 및 복원 기능
- 데이터 공유 기능

## 🔧 **기술 스택**

### Frontend
- **Next.js 15.4.5** (App Router)
- **TypeScript**
- **Tailwind CSS**
- **DaisyUI**
- **Recharts** (차트 라이브러리)
- **Headless UI** (모달, 드롭다운)
- **Heroicons** (아이콘)

### Backend & Database
- **Supabase**
  - PostgreSQL 데이터베이스
  - Authentication
  - Storage (이미지 업로드)
  - Row Level Security (RLS)

### 개발 환경
- **로컬**: Windows PowerShell (파일 편집)
- **원격**: Linux, zsh shell (실행 및 테스트)
- **Python 가상환경**: `WL`

## 📊 **데이터베이스 스키마**

### 테이블 구조
1. **users** - 사용자 정보 (Supabase Auth)
2. **brands** - 브랜드 정보
3. **bottles** - 위스키 보틀 정보
4. **tastings** - 시음 기록
5. **consumption_logs** - 소비량 로그
6. **wishlist** - 위시리스트

### 주요 필드
- **bottles**: `total_volume_ml`, `remaining_volume_ml`, `bottle_status`
- **tastings**: `consumed_volume_ml`, `tasting_type`, 평가 점수들
- **wishlist**: `priority`, `status`

## 🚀 **소비량 추적 기능 상세**

### 기능 설명
- **시음 기록 시 소비량 입력**: 시음 모달에서 소비량을 입력하면 자동으로 위스키의 남은 용량이 계산됩니다
- **남은 용량 시각화**: 위스키 카드에 남은 용량을 프로그레스 바로 표시
- **소비량 통계**: 통계 탭에서 총 소비량, 총 용량, 남은 용량, 소비율을 확인 가능

### 사용자 플로우
1. 위스키 카드에서 "시음" 버튼 클릭
2. 시음 정보 입력 (타입, 날짜, 장소 등)
3. **소비량 입력** (예: 30ml)
4. 평가 점수 및 메모 입력
5. 저장 시 자동으로 위스키의 남은 용량 업데이트

### 시각적 표시
- **위스키 카드**: 남은 용량을 색상별로 표시
  - 🟢 녹색: 충분한 양 (80% 이상)
  - 🟡 노란색: 적당한 양 (20-80%)
  - 🔴 빨간색: 부족한 양 (20% 이하)
- **통계 탭**: 소비량 통계 섹션에서 전체 소비 현황 확인

## 🥃 **기본 용량 750ml 설정**

### 기능 설명
- **기본 용량 자동 설정**: 위스키 추가 시 용량이 자동으로 750ml로 설정됩니다
- **사용자 친화적**: 대부분의 위스키는 750ml이므로 사용자가 별도로 입력할 필요가 없습니다
- **특이한 용량 지원**: 미니어처(50ml), 매그넘(1.5L) 등 특이한 용량의 위스키는 수정 가능합니다

### 적용 범위
- **위스키 추가 모달**: 기본값 750ml, 도움말 표시
- **위스키 수정 모달**: 동일하게 적용
- **위시리스트 모달**: 위스키 추가와 동일하게 적용

### 사용자 경험
- 💡 **도움말 표시**: "대부분의 위스키는 750ml입니다. 특이한 용량의 위스키만 수정하세요"
- 🥃 **아이콘 추가**: 용량 필드에 위스키 아이콘으로 직관성 향상
- 📝 **플레이스홀더**: "예: 750 (기본값)"으로 명확한 안내

## 📝 **Supabase 설정**

### Storage Bucket
- **버킷 이름**: `whisky-bottles`
- **권한**: Public bucket (RLS 비활성화)
- **용도**: 위스키 보틀 이미지 저장

### RLS 정책
- 모든 테이블에 사용자별 접근 제어
- 자신의 데이터만 조회/수정/삭제 가능

## 🎯 **다음 구현 예정 기능**

### 1. 알림 기능
- 위스키 오픈 후 오래된 경우 알림
- 위시리스트 아이템 가격 변동 알림
- 정기적인 시음 기록 리마인더

### 2. 데이터 내보내기/가져오기
- 위스키 컬렉션 CSV/Excel 내보내기
- 시음 기록 백업
- 다른 플랫폼과의 데이터 호환성

### 3. 고급 통계 기능
- 월별/연도별 소비량 차트
- 브랜드별 평점 비교
- 가격대별 만족도 분석
- 시음 패턴 분석

### 4. 모바일 최적화
- 반응형 디자인 개선
- 터치 인터페이스 최적화
- PWA (Progressive Web App) 기능

### 5. 다크/라이트 모드
- 테마 전환 기능
- 사용자 선호도 설정

### 6. 소셜 기능
- 위스키 리뷰 공유
- 친구들과 컬렉션 공유
- 커뮤니티 기능

## 🔄 **원격 실행 명령어**

```bash
# 개발 서버 실행
npm run dev

# 빌드
npm run build

# 프로덕션 실행
npm start
```

## 📱 **배포**

### 추천 플랫폼
- **Vercel**: Next.js 최적화, 자동 배포
- **Netlify**: 정적 사이트 호스팅
- **Supabase**: 백엔드 서비스

### 환경 변수
```
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
``` 

## 📊 **데이터 내보내기/가져오기 기능**

### **기능 설명:**
- **엑셀 파일로 데이터 내보내기/가져오기**
- **백업/복원 기능**으로 활용 가능
- **데이터 공유** 기능으로 활용 가능
- **중복 처리**: 새로운 데이터만 추가, 중복된 데이터는 건너뛰기

### **내보내기 데이터 형식:**
1. **위스키 컬렉션** 시트:
   - 위스키명, 브랜드, 빈티지, 숙성연도, 소매가, 구매가, 할인율, 구매장소, 구매일, 상태, 용량, 남은량, 메모, 이미지URL, **도수(ABV)**

2. **시음 기록** 시트:
   - 위스키명, 브랜드, 시음일, 시음시간, 장소, 시음타입, 코 평점, 코 메모, 입 평점, 입 메모, 피니시 평점, 피니시 메모, 전체평점, 메모

3. **위시리스트** 시트:
   - 이름, 브랜드, 빈티지, 숙성연도, 소매가, 용량, 위치, 메모, 우선순위, **도수(ABV)**

### **사용자 플로우:**
1. **내보내기**: 헤더의 "📊 내보내기" 버튼 클릭 → 엑셀 파일 다운로드
2. **가져오기**: 헤더의 "📥 가져오기" 버튼 클릭 → 엑셀 파일 선택 → 자동 처리
3. **결과 확인**: 처리 결과 알림창으로 확인

### **지원 파일 형식:**
- `.xlsx` (Excel 2007+)
- `.xls` (Excel 97-2003)

---

## 🥃 **도수(ABV) 필드 추가**

### **데이터베이스 스키마 업데이트:**
- `bottles` 테이블에 `abv` 컬럼 추가 (DECIMAL(4,1))
- `wishlist` 테이블에 `abv` 컬럼 추가 (DECIMAL(4,1))

### **앱 기능 업데이트:**
- 위스키 추가/수정 모달에 도수 입력 필드 추가
- 위시리스트 추가/수정 모달에 도수 입력 필드 추가
- 위스키 카드에 도수 표시
- 데이터 내보내기/가져오기에 도수 포함

### **UI 개선:**
- 도수 입력 필드에 % 단위 표시
- 도수 범위 검증 (0-100%)
- 위스키 카드에 도수 정보 표시 