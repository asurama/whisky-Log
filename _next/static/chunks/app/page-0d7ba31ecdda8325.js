(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2099:(e,t,n)=>{"use strict";n.r(t),n.d(t,{supabase:()=>i});let i=(0,n(2354).UU)("https://vnwkoqpzhxgpnofqjlii.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZud2tvcXB6aHhncG5vZnFqbGlpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ1NDQyMDAsImV4cCI6MjA3MDEyMDIwMH0.9KaCHySlbuLyIVhKYTSk0wcvyS5t5EIZRySJCjSdLVc")},2383:()=>{},2609:(e,t,n)=>{Promise.resolve().then(n.bind(n,8698))},3686:()=>{},7389:(e,t,n)=>{"use strict";n.d(t,{ToastProvider:()=>d,d:()=>s});var i=n(5155),r=n(9137),a=n.n(r),o=n(2115);let l=(0,o.createContext)(void 0),s=()=>{let e=(0,o.useContext)(l);if(!e)throw Error("useToast must be used within a ToastProvider");return e};function d(e){let{children:t}=e,[n,r]=(0,o.useState)([]),a=e=>{r(t=>t.filter(t=>t.id!==e))};return(0,i.jsxs)(l.Provider,{value:{showToast:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3,i=Date.now().toString(),o={id:i,message:e,type:t,duration:n};r(e=>[...e,o]),n>0&&setTimeout(()=>{a(i)},n)},hideToast:a},children:[t,(0,i.jsx)(c,{toasts:n,onHide:a})]})}function c(e){let{toasts:t,onHide:n}=e;return 0===t.length?null:(0,i.jsxs)("div",{style:{position:"fixed",top:"20px",right:"20px",zIndex:1e4,display:"flex",flexDirection:"column",gap:"8px"},className:"jsx-5de7ed1ad044b70b",children:[t.map(e=>(0,i.jsxs)("div",{style:{padding:"12px 16px",borderRadius:"8px",marginBottom:"8px",fontSize:"14px",fontWeight:"500",display:"flex",alignItems:"center",justifyContent:"space-between",minWidth:"280px",maxWidth:"400px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",backdropFilter:"blur(8px)",border:"1px solid rgba(255, 255, 255, 0.1)",animation:"slideIn 0.3s ease-out",cursor:"pointer",transition:"all 0.3s ease",...{success:{backgroundColor:"rgba(16, 185, 129, 0.9)",color:"white",borderColor:"rgba(16, 185, 129, 0.3)"},error:{backgroundColor:"rgba(239, 68, 68, 0.9)",color:"white",borderColor:"rgba(239, 68, 68, 0.3)"},warning:{backgroundColor:"rgba(245, 158, 11, 0.9)",color:"white",borderColor:"rgba(245, 158, 11, 0.3)"},info:{backgroundColor:"rgba(59, 130, 246, 0.9)",color:"white",borderColor:"rgba(59, 130, 246, 0.3)"}}[e.type]},onClick:()=>n(e.id),onMouseEnter:e=>{e.currentTarget.style.transform="translateX(-4px)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateX(0)"},className:"jsx-5de7ed1ad044b70b",children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},className:"jsx-5de7ed1ad044b70b",children:[(0,i.jsx)("span",{style:{fontSize:"16px"},className:"jsx-5de7ed1ad044b70b",children:(e=>{switch(e){case"success":return"✅";case"error":return"❌";case"warning":return"⚠️";default:return"ℹ️"}})(e.type)}),(0,i.jsx)("span",{className:"jsx-5de7ed1ad044b70b",children:e.message})]}),(0,i.jsx)("button",{onClick:t=>{t.stopPropagation(),n(e.id)},style:{background:"none",border:"none",color:"inherit",fontSize:"18px",cursor:"pointer",padding:"0",marginLeft:"12px",opacity:.7,transition:"opacity 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.opacity="1"},onMouseLeave:e=>{e.currentTarget.style.opacity="0.7"},className:"jsx-5de7ed1ad044b70b",children:"\xd7"})]},e.id)),(0,i.jsx)(a(),{id:"5de7ed1ad044b70b",children:"@keyframes slideIn{from{transform:translatex(100%);opacity:0}to{transform:translatex(0);opacity:1}}"})]})}},8125:(e,t,n)=>{"use strict";n.d(t,{A6:()=>l,Wl:()=>a,bB:()=>r,deleteImageFromSupabase:()=>s,w4:()=>o});var i=n(2099);function r(e){return new Promise((t,n)=>{let i=new FileReader;i.readAsDataURL(e),i.onload=()=>t(i.result),i.onerror=e=>n(e)})}function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return!(e.size>1024*t*1024)&&!!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(e.type)}function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:800,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:600,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.8;return new Promise((r,a)=>{try{let o=document.createElement("canvas"),l=o.getContext("2d");if(!l)return void a(Error("Canvas 2D 컨텍스트를 생성할 수 없습니다."));let s=new Image,d=URL.createObjectURL(e),c=()=>{URL.revokeObjectURL(d)};s.onload=()=>{try{let{width:d,height:p}=s;d>t&&(p=p*t/d,d=t),p>n&&(d=d*n/p,p=n),d<1&&(d=1),p<1&&(p=1);let x=Math.round(d),u=Math.round(p);o.width=x,o.height=u,l.drawImage(s,0,0,d,p),o.toBlob(t=>{if(t)try{let n=new File([t],e.name,{type:e.type||"image/jpeg",lastModified:Date.now()});c(),r(n)}catch(e){c(),a(Error("압축된 파일을 생성할 수 없습니다."))}else c(),a(Error("이미지를 Blob으로 변환할 수 없습니다."))},e.type||"image/jpeg",i)}catch(e){c(),a(Error("이미지를 Canvas에 그릴 수 없습니다."))}},s.onerror=e=>{c(),a(Error("이미지를 로드할 수 없습니다."))},s.src=d}catch(e){a(Error("이미지 압축을 초기화할 수 없습니다."))}})}async function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"tasting-images",n=arguments.length>2?arguments[2]:void 0;try{let r=Date.now(),a=Math.random().toString(36).substring(2,15),o=e.name.split(".").pop(),l="".concat(r,"_").concat(a,".").concat(o),s=n?"".concat(n,"/").concat(l):l,{data:d,error:c}=await i.supabase.storage.from(t).upload(s,e,{cacheControl:"3600",upsert:!1});if(c)throw Error("이미지 업로드 실패: ".concat(c.message));let{data:p}=i.supabase.storage.from(t).getPublicUrl(s);return p.publicUrl}catch(e){throw e}}async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"tasting-images";try{let n=e.split("/"),r=n[n.length-1],{error:a}=await i.supabase.storage.from(t).remove([r]);if(a)return!1;return!0}catch(e){return!1}}},8698:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ez});var i=n(5155),r=n(9137),a=n.n(r),o=n(2115),l=n(2099),s=n(3925);let d=e=>{let t=s.Wp.book_new();if(e.brands.length>0){let n=e.brands.map(e=>({브랜드명:e.name,국가:e.country||"",설명:e.description||"",생성일:e.created_at})),i=s.Wp.json_to_sheet(n);s.Wp.book_append_sheet(t,i,"브랜드")}if(e.bottles.length>0){let n=e.bottles.map(e=>({임시ID:e.temp_id,위스키명:e.name,브랜드ID:e.brand_id||"",커스텀브랜드:e.custom_brand||"",지역:e.region||"",빈티지:e.vintage||"",숙성연수:e.age_years||"",ABV:e.abv||"",캐스크타입:e.cask_type||"",색상:e.color||"",시중가:e.retail_price||"",구매가:e.purchase_price||"",할인율:e.discount_rate||"",구매장소:e.purchase_location||"",구매일:e.purchase_date||"",상태:e.bottle_status||e.status||"unopened","총용량(ml)":e.total_volume_ml||"","남은용량(ml)":e.remaining_volume_ml||"",메모:e.notes||"",생성일:e.created_at})),i=s.Wp.json_to_sheet(n);s.Wp.book_append_sheet(t,i,"위스키")}if(e.tastings.length>0){let n=e.tastings.map(e=>({위스키ID:e.bottle_id||"",위스키명:e.bottle_name||"",브랜드:e.bottle_brand||"",시음타입:e.tasting_type||"",시음날짜:e.tasting_date||"",시음시간:e.tasting_time||"",장소:e.location||"","소비량(ml)":e.consumed_volume_ml||"",Nose점수:e.nose_rating||"",Palate점수:e.palate_rating||"",Finish점수:e.finish_rating||"",Overall점수:e.overall_rating||"",Nose노트:e.nose_notes||"",Palate노트:e.palate_notes||"",Finish노트:e.finish_notes||"",함께한사람:e.companions||"",추가노트:e.additional_notes||"",생성일:e.created_at})),i=s.Wp.json_to_sheet(n);s.Wp.book_append_sheet(t,i,"시음기록")}if(e.wishlist.length>0){let n=e.wishlist.map(e=>({위스키명:e.name,브랜드:e.brand||"",빈티지:e.vintage||"",숙성연수:e.age_years||"",예상가격:e.estimated_price||"",우선순위:e.priority||"",메모:e.notes||"",생성일:e.created_at})),i=s.Wp.json_to_sheet(n);s.Wp.book_append_sheet(t,i,"위시리스트")}return t},c=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"json",n=arguments.length>2?arguments[2]:void 0,i=await n.from("tastings").select("*").eq("user_id",e.id);if(i.error)throw i.error;let r=i.data||[],a=[...new Set(r.map(e=>e.bottle_id).filter(Boolean))],o=await n.from("bottles").select("*").eq("user_id",e.id);if(o.error)throw o.error;let l=o.data||[],c=l.map(e=>e.id),p=a.filter(e=>!c.includes(e));if(p.length>0)for(let e of p)try{let t=await n.from("bottles").select("*").eq("id",e).single();t.data&&!t.error&&l.push(t.data)}catch(e){}let[x,u]=await Promise.all([n.from("wishlist").select("*").eq("user_id",e.id),n.from("brands").select("*")]);if(x.error)throw x.error;if(u.error)throw u.error;let g={bottles:l,tastings:r,wishlist:x.data||[],brands:u.data||[],exportDate:new Date().toISOString(),version:"1.0"};g.tastings.length>0&&g.tastings.forEach((e,t)=>{}),g.bottles.length>0&&[...new Set(g.tastings.map(e=>e.bottle_id).filter(Boolean))].forEach(e=>{g.bottles.some(t=>t.id===e)});let h=(e=>{e.bottles.length;let t=new Map,n=new Map;e.bottles.forEach((e,i)=>{if(!e.id)return;let r="temp_bottle_".concat(i+1);t.set(e.id,r),n.set(e.name,r)}),t.forEach((e,t)=>{});let i=e.bottles.map((e,t)=>{let{id:n,...i}=e;return{...i,temp_id:"temp_bottle_".concat(t+1)}}),r=e.tastings.map((i,r)=>{let{id:a,...o}=i,l={...o};i.bottle_id;let s=null,d=null;return i.bottle_id&&t.has(i.bottle_id)?(s=t.get(i.bottle_id),d=e.bottles.find(e=>e.id===i.bottle_id)):i.bottle_id&&!t.has(i.bottle_id)?i.bottle_name&&n.has(i.bottle_name)&&(s=n.get(i.bottle_name),d=e.bottles.find(e=>e.name===i.bottle_name)):!i.bottle_id&&i.bottle_name&&n.has(i.bottle_name)&&(s=n.get(i.bottle_name),d=e.bottles.find(e=>e.name===i.bottle_name)),d?(l.bottle_id=s,l.bottle_name=d.name,l.bottle_brand=d.custom_brand||d.brand_id):l.bottle_id=null,l});return{bottles:i,tastings:r,wishlist:e.wishlist.map(e=>{let{id:t,...n}=e;return n}),brands:e.brands.map(e=>{let{id:t,...n}=e;return n}),exportDate:e.exportDate,version:e.version}})(g);if("json"===t){let e=JSON.stringify(h,null,2),t="whisky-log-backup-".concat(new Date().toISOString().split("T")[0],".json"),n=new Blob([e],{type:"application/json"}),i=URL.createObjectURL(n),r=document.createElement("a");r.href=i,r.download=t,r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(i)}else if("csv"===t){let e=(e=>{let t=[];return t.push("=== 위스키 로그 백업 데이터 ==="),t.push("내보내기 날짜: ".concat(new Date().toLocaleString("ko-KR"))),t.push("버전: ".concat(e.version)),t.push(""),e.brands.length>0&&(t.push("=== 브랜드 ==="),t.push("ID,브랜드명,생성일"),e.brands.forEach(e=>{t.push("".concat(e.id,',"').concat(e.name,'",').concat(e.created_at))}),t.push("")),e.bottles.length>0&&(t.push("=== 위스키 ==="),t.push("ID,위스키명,브랜드ID,커스텀브랜드,빈티지,숙성연수,도수,시중가,구매가,할인율,구매장소,구매일,상태,총용량,남은용량,메모,생성일"),e.bottles.forEach(e=>{let n=[e.id,'"'.concat(e.name,'"'),e.brand_id||"",'"'.concat(e.custom_brand||"",'"'),e.vintage||"",e.age_years||"",e.abv||"",e.retail_price||"",e.purchase_price||"",e.discount_rate||"",'"'.concat(e.purchase_location||"",'"'),e.purchase_date||"",e.bottle_status||e.status||"unopened",e.total_volume_ml||"",e.remaining_volume_ml||"",'"'.concat(e.notes||"",'"'),e.created_at];t.push(n.join(","))}),t.push("")),e.tastings.length>0&&(t.push("=== 시음 기록 ==="),t.push("ID,위스키ID,시음타입,시음날짜,장소,소비량,Nose점수,Palate점수,Finish점수,Overall점수,Nose노트,Palate노트,Finish노트,함께한사람,추가노트,생성일"),e.tastings.forEach(e=>{let n=[e.id,e.bottle_id||"",e.tasting_type||"",e.tasting_date||"",'"'.concat(e.location||"",'"'),e.consumed_volume_ml||"",e.nose_rating||"",e.palate_rating||"",e.finish_rating||"",e.overall_rating||"",'"'.concat(e.nose_notes||"",'"'),'"'.concat(e.palate_notes||"",'"'),'"'.concat(e.finish_notes||"",'"'),'"'.concat(e.companions||"",'"'),'"'.concat(e.additional_notes||"",'"'),e.created_at];t.push(n.join(","))}),t.push("")),e.wishlist.length>0&&(t.push("=== 위시리스트 ==="),t.push("ID,위스키명,브랜드,빈티지,숙성연수,예상가격,우선순위,메모,생성일"),e.wishlist.forEach(e=>{let n=[e.id,'"'.concat(e.name,'"'),'"'.concat(e.brand||"",'"'),e.vintage||"",e.age_years||"",e.estimated_price||"",e.priority||"",'"'.concat(e.notes||"",'"'),e.created_at];t.push(n.join(","))})),t.join("\n")})(h),t="whisky-log-backup-".concat(new Date().toISOString().split("T")[0],".csv"),n=new Blob([e],{type:"text/csv;charset=utf-8"}),i=URL.createObjectURL(n),r=document.createElement("a");r.href=i,r.download=t,r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(i)}else if("excel"===t){let e="whisky-log-backup-".concat(new Date().toISOString().split("T")[0],".xlsx"),t=d(h),n=new Blob([s.M9(t,{bookType:"xlsx",type:"array"})],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),i=URL.createObjectURL(n),r=document.createElement("a");r.href=i,r.download=e,r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(i)}return"".concat(t.toUpperCase()," 형식으로 데이터가 성공적으로 내보내기되었습니다!")};class p{loadConfig(){let e=localStorage.getItem("whisky-log-backup-config");return e?JSON.parse(e):{autoBackupEnabled:!1,backupInterval:60,maxBackups:10}}saveConfig(){localStorage.setItem("whisky-log-backup-config",JSON.stringify(this.config))}updateConfig(e){this.config={...this.config,...e},this.saveConfig(),this.restartAutoBackup()}getConfig(){return this.config}startAutoBackup(){if(!this.config.autoBackupEnabled)return;let e=Date.now()-(this.config.lastBackupTime||0),t=60*this.config.backupInterval*1e3;e>=t&&this.createBackup(),this.intervalId=setInterval(()=>{this.createBackup()},t)}restartAutoBackup(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null),this.startAutoBackup()}stopAutoBackup(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)}async createBackup(){if(!this.isBackingUp&&this.config.autoBackupEnabled)try{this.isBackingUp=!0;let{data:{user:e}}=await l.supabase.auth.getUser();if(!(null==e?void 0:e.id))return;let t=await this.fetchAllData(e.id),n=d(t),i=await this.workbookToBuffer(n),r="backup_".concat(Date.now()),a="whisky-log-backup-".concat(new Date().toISOString().split("T")[0],"-").concat(Date.now(),".xlsx"),o={id:r,timestamp:Date.now(),filename:a,size:i.byteLength,recordCount:{bottles:t.bottles.length,tastings:t.tastings.length,brands:t.brands.length,wishlist:t.wishlist.length}},{error:s}=await l.supabase.storage.from("backups").upload("".concat(e.id,"/").concat(a),i,{contentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",metadata:{backupMetadata:JSON.stringify(o)}});if(s)return;await this.saveBackupMetadata(e.id,o),await this.cleanupOldBackups(e.id),this.config.lastBackupTime=Date.now(),this.saveConfig()}catch(e){}finally{this.isBackingUp=!1}}async fetchAllData(e){let{data:t}=await l.supabase.from("bottles").select("*").eq("user_id",e),{data:n}=await l.supabase.from("tastings").select("*").eq("user_id",e),{data:i}=await l.supabase.from("brands").select("*"),{data:r}=await l.supabase.from("wishlist").select("*").eq("user_id",e);return{bottles:t||[],tastings:n||[],brands:i||[],wishlist:r||[],version:"1.0",exportDate:new Date().toISOString()}}async workbookToBuffer(e){return new Promise((t,i)=>{let r=n(3925).M9(e,{bookType:"xlsx",type:"array"}),a=new ArrayBuffer(r.length),o=new Uint8Array(a);for(let e=0;e<r.length;e++)o[e]=r[e];t(a)})}async saveBackupMetadata(e,t){let{error:n}=await l.supabase.from("backup_metadata").upsert({user_id:e,backup_id:t.id,metadata:t})}async cleanupOldBackups(e){try{let{data:t}=await l.supabase.storage.from("backups").list(e);if(!t||t.length<=this.config.maxBackups)return;let n=t.filter(e=>e.name.endsWith(".xlsx")).sort((e,t)=>{var n,i;let r=parseInt((null==(n=e.name.split("-").pop())?void 0:n.split(".")[0])||"0"),a=parseInt((null==(i=t.name.split("-").pop())?void 0:i.split(".")[0])||"0");return r-a});for(let t of n.slice(0,n.length-this.config.maxBackups))await l.supabase.storage.from("backups").remove(["".concat(e,"/").concat(t.name)])}catch(e){}}async getBackupList(e){try{let{data:t,error:n}=await l.supabase.from("backup_metadata").select("metadata").eq("user_id",e).order("created_at",{ascending:!1});if(n)throw n;return(null==t?void 0:t.map(e=>e.metadata))||[]}catch(e){return[]}}async restoreFromBackup(e,t){try{let{data:i}=await l.supabase.from("backup_metadata").select("metadata").eq("user_id",e).eq("backup_id",t).single();if(!i)throw Error("백업을 찾을 수 없습니다.");let r=i.metadata,{data:a,error:o}=await l.supabase.storage.from("backups").download("".concat(e,"/").concat(r.filename));if(o||!a)throw Error("백업 파일을 다운로드할 수 없습니다.");let s=await a.arrayBuffer();return n(3925).LF(s,{type:"array"}),!0}catch(e){return!1}}constructor(){this.intervalId=null,this.isBackingUp=!1,this.config=this.loadConfig(),this.startAutoBackup()}}let x=null,u=()=>{x||(x=new p)},g=()=>{x&&(x.stopAutoBackup(),x=null)};var h=n(4134).hp;class b{static getInstance(){return b.instance||(b.instance=new b),b.instance}async loadConfig(){try{let e=localStorage.getItem("enhanced_backup_config");e&&(this.config={...this.config,...JSON.parse(e)})}catch(e){}}async saveConfig(e){this.config={...this.config,...e};try{localStorage.setItem("enhanced_backup_config",JSON.stringify(this.config))}catch(e){}}getConfig(){return{...this.config}}async startAutoBackup(){this.config.enabled&&this.config.auto_backup_enabled&&(this.stopAutoBackup(),this.backupInterval=setInterval(async()=>{try{await this.createBackup(),this.config.notification_enabled&&this.showNotification("백업이 완료되었습니다!","success")}catch(e){this.config.notification_enabled&&this.showNotification("자동 백업에 실패했습니다.","error")}},60*this.config.interval_hours*6e4),await this.createBackup())}stopAutoBackup(){this.backupInterval&&(clearInterval(this.backupInterval),this.backupInterval=null)}async createBackup(){this.config.auto_backup_enabled;let e=(await l.supabase.auth.getUser()).data.user;if(!e)throw Error("사용자 인증이 필요합니다.");let t="backup_".concat(e.id,"_").concat(Date.now()),n=new Date().toISOString();try{let i,r=await this.fetchAllUserData(),a=await this.getLastBackup(),o=!!(this.config.incremental_backup&&a),d=o&&a?await this.calculateChanges(r,a):null,c=await this.createExcelWorkbook(r,o,d);i=this.config.compression_enabled?await this.compressWorkbook(c):s.M9(c,{type:"buffer",bookType:"xlsx"});let p="".concat(t,".").concat(this.config.compression_enabled?"zip":"xlsx"),{error:x}=await l.supabase.storage.from("backups").upload("".concat(e.id,"/").concat(p),i,{contentType:this.config.compression_enabled?"application/zip":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});if(x)throw x;let u={timestamp:n,version:"2.0.0",data_types:["bottles","tastings","wishlist"],record_counts:{bottles:r.bottles.length,tastings:r.tastings.length,wishlist:r.wishlist.length},total_size:i.length,checksum:await this.calculateChecksum(i),is_incremental:o,previous_backup_id:null==a?void 0:a.backup_id,changes_since_last:d||{bottles_added:0,bottles_updated:0,bottles_deleted:0,tastings_added:0,tastings_updated:0,tastings_deleted:0}};return await this.saveBackupMetadata(e.id,t,u),this.config.backup_verification&&await this.verifyBackup(t,u),this.config.auto_cleanup&&await this.cleanupOldBackups(e.id),t}catch(e){throw e}}async fetchAllUserData(){let e=(await l.supabase.auth.getUser()).data.user;if(!e)throw Error("사용자 인증이 필요합니다.");let[t,n,i]=await Promise.all([l.supabase.from("bottles").select("*").eq("user_id",e.id),l.supabase.from("tastings").select("*").eq("user_id",e.id),l.supabase.from("wishlist").select("*").eq("user_id",e.id)]);if(t.error)throw t.error;if(n.error)throw n.error;if(i.error)throw i.error;return{bottles:t.data||[],tastings:n.data||[],wishlist:i.data||[]}}async getLastBackup(){let e=(await l.supabase.auth.getUser()).data.user;if(!e)return null;let{data:t,error:n}=await l.supabase.from("backup_metadata").select("*").eq("user_id",e.id).order("created_at",{ascending:!1}).limit(1).single();return n||!t?null:t}async calculateChanges(e,t){return{bottles_added:0,bottles_updated:0,bottles_deleted:0,tastings_added:0,tastings_updated:0,tastings_deleted:0}}async createExcelWorkbook(e,t,n){let i=s.Wp.book_new(),r=s.Wp.json_to_sheet(e.bottles),a=s.Wp.json_to_sheet(e.tastings),o=s.Wp.json_to_sheet(e.wishlist);s.Wp.book_append_sheet(i,r,"Bottles"),s.Wp.book_append_sheet(i,a,"Tastings"),s.Wp.book_append_sheet(i,o,"Wishlist");let l={backup_timestamp:new Date().toISOString(),is_incremental:t,changes:n?JSON.stringify(n):"N/A"},d=s.Wp.json_to_sheet([l]);return s.Wp.book_append_sheet(i,d,"Metadata"),i}async compressWorkbook(e){return s.M9(e,{type:"buffer",bookType:"xlsx"})}async calculateChecksum(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e[n],t&=t;return t.toString(16)}async saveBackupMetadata(e,t,n){let{data:i,error:r}=await l.supabase.from("backup_metadata").insert({user_id:e,backup_id:t,metadata:n});if(r)throw r}async verifyBackup(e,t){try{let n=(await l.supabase.auth.getUser()).data.user;if(!n)return!1;let i="".concat(e,".").concat(this.config.compression_enabled?"zip":"xlsx"),{data:r,error:a}=await l.supabase.storage.from("backups").download("".concat(n.id,"/").concat(i));if(a||!r||r.size!==t.total_size)return!1;let o=await r.arrayBuffer(),s=h.from(o);return await this.calculateChecksum(s)===t.checksum}catch(e){return!1}}async cleanupOldBackups(e){try{let{data:t,error:n}=await l.supabase.from("backup_metadata").select("backup_id, created_at").eq("user_id",e).order("created_at",{ascending:!1});if(n||!t)return;if(t.length>this.config.max_backups)for(let n of t.slice(this.config.max_backups))await this.deleteBackup(e,n.backup_id)}catch(e){}}async deleteBackup(e,t){try{await l.supabase.from("backup_metadata").delete().eq("user_id",e).eq("backup_id",t);let n="".concat(t,".").concat(this.config.compression_enabled?"zip":"xlsx");await l.supabase.storage.from("backups").remove(["".concat(e,"/").concat(n)])}catch(e){throw e}}async getBackupList(){let e=(await l.supabase.auth.getUser()).data.user;if(!e)return[];try{let{data:n,error:i}=await l.supabase.from("backup_metadata").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});if(i){var t;return"PGRST205"===i.code||"404"===i.code||null==(t=i.message)||t.includes("404"),[]}return n||[]}catch(e){return[]}}async restoreFromBackup(e){let t=(await l.supabase.auth.getUser()).data.user;if(!t)throw Error("사용자 인증이 필요합니다.");try{let n="".concat(e,".").concat(this.config.compression_enabled?"zip":"xlsx"),{data:i,error:r}=await l.supabase.storage.from("backups").download("".concat(t.id,"/").concat(n));if(r||!i)throw Error("백업 파일을 찾을 수 없습니다.");let a=await i.arrayBuffer(),o=s.LF(a,{type:"buffer"}),d=s.Wp.sheet_to_json(o.Sheets.Bottles),c=s.Wp.sheet_to_json(o.Sheets.Tastings),p=s.Wp.sheet_to_json(o.Sheets.Wishlist);await Promise.all([l.supabase.from("bottles").delete().eq("user_id",t.id),l.supabase.from("tastings").delete().eq("user_id",t.id),l.supabase.from("wishlist").delete().eq("user_id",t.id)]),d.length>0&&await l.supabase.from("bottles").insert(d),c.length>0&&await l.supabase.from("tastings").insert(c),p.length>0&&await l.supabase.from("wishlist").insert(p)}catch(e){throw e}}showNotification(e,t){"Notification"in window&&"granted"===Notification.permission&&new Notification("위스키 로그",{body:e,icon:"/favicon.ico"})}constructor(){this.backupInterval=null,this.config={enabled:!1,auto_backup_enabled:!1,interval_hours:24,max_backups:10,incremental_backup:!0,compression_enabled:!0,notification_enabled:!0,auto_cleanup:!0,backup_verification:!0},this.loadConfig()}}let m=()=>b.getInstance();var f=n(7389);let y=()=>{let[e,t]=(0,o.useState)("desktop"),[n,i]=(0,o.useState)(0),[r,a]=(0,o.useState)(0),[l,s]=(0,o.useState)("portrait");return(0,o.useEffect)(()=>{let e=()=>{let e=window.innerWidth,n=window.innerHeight;i(e),a(n),s(e>n?"landscape":"portrait"),e<=767?t("mobile"):e>=768&&e<=1023?t("tablet"):e>=1024&&e<=1279?t("tablet-landscape"):t("desktop")};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),{deviceType:e,isMobile:"mobile"===e,isTablet:"tablet"===e,isTabletLandscape:"tablet-landscape"===e,isDesktop:"desktop"===e,screenWidth:n,screenHeight:r,orientation:l}};function v(e){let{src:t,alt:n,className:r="",style:a={},placeholder:l="\uD83E\uDD43",onLoad:s,onError:d}=e,[c,p]=(0,o.useState)(!1),[x,u]=(0,o.useState)(!1),[g,h]=(0,o.useState)(!1),b=(0,o.useRef)(null),m=(0,o.useRef)(null);return(0,o.useEffect)(()=>(b.current&&(m.current=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){var t;h(!0),null==(t=m.current)||t.unobserve(e.target)}})},{rootMargin:"50px",threshold:.1}),m.current.observe(b.current)),()=>{m.current&&m.current.disconnect()}),[]),(0,i.jsxs)("div",{ref:b,className:"image-optimizer ".concat(r),style:{position:"relative",overflow:"hidden",backgroundColor:"#374151",...a},children:[!c&&!x&&(0,i.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"48px",color:"#6b7280",backgroundColor:"#374151",zIndex:1},children:l}),g&&!x&&(0,i.jsx)("img",{src:(e=>{if(!e)return"";if(e.includes("supabase.co"))try{let t=new URL(e);return t.searchParams.set("quality","85"),t.searchParams.set("width","300"),t.searchParams.set("height","200"),t.toString()}catch(e){}return e})(t),alt:n,style:{width:"100%",height:"100%",objectFit:"cover",opacity:+!!c,transition:"opacity 0.3s ease-in-out",...a},onLoad:()=>{p(!0),null==s||s()},onError:()=>{u(!0),null==d||d()},loading:"lazy",decoding:"async"}),x&&(0,i.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"48px",color:"#6b7280",backgroundColor:"#374151"},children:"\uD83D\uDDBC️"})]})}function j(e){var t;let{bottle:n,onEdit:r,onDelete:a,onAddTasting:l,onViewTastings:s,onImageChange:d,onClick:c}=e,[p,x]=(0,o.useState)(!1),{showToast:u}=(0,f.d)(),{isMobile:g,isTablet:h}=y(),b=async()=>{if(confirm("정말로 이 위스키를 삭제하시겠습니까?"))try{a(n.id),u("위스키가 삭제되었습니다.","success")}catch(e){u("삭제 중 오류가 발생했습니다.","error")}};return(0,i.jsxs)("div",{className:"mobile-card",style:{backgroundColor:"#1F2937",borderRadius:"12px",padding:g?"16px":h?"18px":"20px",border:"1px solid #374151",transition:"all 0.2s ease",transform:p?"translateY(-2px)":"translateY(0)",boxShadow:p?"0 8px 25px rgba(0, 0, 0, 0.3)":"0 4px 6px rgba(0, 0, 0, 0.1)",position:"relative",cursor:c?"pointer":"default",touchAction:"pan-y",minHeight:n.image_url?"auto":"280px",display:"flex",flexDirection:"column"},onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),onClick:c,children:[(0,i.jsx)("div",{style:{marginBottom:"12px",textAlign:"center"},children:(0,i.jsx)("div",{style:{width:"100%",height:g?"160px":h?"170px":"180px",borderRadius:"8px",overflow:"hidden",backgroundColor:"#374151",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",position:"relative"},onClick:e=>{e.stopPropagation(),c&&c()},children:n.image_url?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(v,{src:n.image_url,alt:n.name,style:{width:"100%",height:"100%",objectFit:"cover",backgroundColor:"#374151"}}),(0,i.jsx)("div",{style:{position:"absolute",top:"12px",left:"12px",padding:"6px 12px",borderRadius:"20px",fontSize:"12px",fontWeight:"600",backgroundColor:"rgba(0, 0, 0, 0.7)",color:"white",backdropFilter:"blur(8px)"},children:"empty"===n.bottle_status?"빈병":"low"===n.bottle_status?"부족":"opened"===n.bottle_status?"오픈":"unopened"===n.bottle_status?"미오픈":"상태"})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{style:{fontSize:"48px",color:"#6B7280",display:"flex",flexDirection:"column",alignItems:"center",gap:"8px"},children:[(0,i.jsx)("span",{children:"\uD83E\uDD43"}),(0,i.jsx)("span",{style:{fontSize:"12px",color:"#9CA3AF"},children:"이미지 없음"})]}),(0,i.jsx)("div",{style:{position:"absolute",top:"12px",left:"12px",padding:"6px 12px",borderRadius:"20px",fontSize:"12px",fontWeight:"600",backgroundColor:"rgba(0, 0, 0, 0.7)",color:"white",backdropFilter:"blur(8px)"},children:"empty"===n.bottle_status?"빈병":"low"===n.bottle_status?"부족":"opened"===n.bottle_status?"오픈":"unopened"===n.bottle_status?"미오픈":"상태"})]})})}),(0,i.jsxs)("div",{style:{marginBottom:"12px"},children:[(0,i.jsx)("h3",{style:{fontSize:"16px",fontWeight:"600",color:"white",marginBottom:"4px",lineHeight:"1.3"},children:n.name}),(0,i.jsx)("p",{style:{fontSize:"14px",color:"#9CA3AF",marginBottom:"4px"},children:(null==(t=n.brands)?void 0:t.name)||n.custom_brand}),(0,i.jsxs)("div",{style:{display:"flex",gap:"8px",marginBottom:"4px"},children:[(0,i.jsxs)("span",{className:"tag tag-info",style:{fontSize:"12px",color:"#9CA3AF",backgroundColor:"#374151",padding:"2px 6px",borderRadius:"4px"},children:[n.remaining_volume_ml,"ml / ",n.total_volume_ml,"ml"]}),n.abv&&(0,i.jsxs)("span",{style:{fontSize:"12px",color:"#9CA3AF",backgroundColor:"#374151",padding:"2px 6px",borderRadius:"4px"},children:[n.abv,"%"]})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[n.age_years&&(0,i.jsxs)("span",{style:{fontSize:"12px",color:"#9CA3AF",backgroundColor:"#374151",padding:"2px 6px",borderRadius:"4px"},children:[n.age_years,"년"]}),n.vintage&&(0,i.jsxs)("span",{style:{fontSize:"12px",color:"#9CA3AF",backgroundColor:"#374151",padding:"2px 6px",borderRadius:"4px"},children:[n.vintage,"년 빈티지"]}),n.bottled_year&&(0,i.jsxs)("span",{style:{fontSize:"12px",color:"#9CA3AF",backgroundColor:"#374151",padding:"2px 6px",borderRadius:"4px"},children:[n.bottled_year,"년 병입"]}),n.cask_type&&(0,i.jsx)("span",{style:{fontSize:"12px",color:"#9CA3AF",backgroundColor:"#374151",padding:"2px 6px",borderRadius:"4px"},children:n.cask_type}),n.retail_price&&(0,i.jsxs)("span",{style:{fontSize:"12px",color:"#9CA3AF",backgroundColor:"#374151",padding:"2px 6px",borderRadius:"4px"},children:["₩",Number(n.retail_price).toLocaleString()]})]})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[(0,i.jsx)("button",{type:"button",className:"mobile-button",onClick:e=>{e.preventDefault(),e.stopPropagation(),r(n)},style:{flex:1,padding:"8px 12px",backgroundColor:"#3B82F6",border:"none",borderRadius:"6px",color:"white",cursor:"pointer",fontSize:"12px",fontWeight:"500"},children:"✏️ 수정"}),(0,i.jsx)("button",{type:"button",className:"mobile-button",onClick:e=>{e.preventDefault(),e.stopPropagation(),l(n)},style:{flex:1,padding:"8px 12px",backgroundColor:"#10B981",border:"none",borderRadius:"6px",color:"white",cursor:"pointer",fontSize:"12px",fontWeight:"500"},children:"\uD83C\uDF77 시음 추가"})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"8px",marginTop:"8px"},children:[(0,i.jsxs)("button",{type:"button",className:"mobile-button",onClick:e=>{e.preventDefault(),e.stopPropagation(),s(n)},disabled:!n.tasting_count||0===n.tasting_count,style:{flex:1,padding:"8px 12px",backgroundColor:n.tasting_count&&n.tasting_count>0?"#8B5CF6":"#6B7280",border:"none",borderRadius:"6px",color:"white",cursor:n.tasting_count&&n.tasting_count>0?"pointer":"not-allowed",fontSize:"12px",fontWeight:"500",opacity:n.tasting_count&&n.tasting_count>0?1:.6},children:["\uD83D\uDCCA 기록 보기 (",n.tasting_count||0,")"]}),(0,i.jsx)("button",{type:"button",className:"mobile-button",onClick:e=>{e.preventDefault(),e.stopPropagation(),b()},style:{width:"44px",height:"36px",padding:"0",backgroundColor:"#EF4444",border:"none",borderRadius:"6px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"500",display:"flex",alignItems:"center",justifyContent:"center"},children:"\uD83D\uDDD1️"})]})]})}function _(e){let{onFiltersChange:t,onSearch:n,brands:r=[],currentFilters:a,searchType:l}=e,{isMobile:s}=y(),[d,c]=(0,o.useState)(!1),[p,x]=(0,o.useState)(a),u=(e,t)=>{x(n=>({...n,[e]:t}))},g=()=>Object.values(p).some(e=>Array.isArray(e)?e.length>0:""!==e);return(0,i.jsxs)("div",{style:{backgroundColor:"#1F2937",borderRadius:"12px",padding:s?"12px":"16px",marginBottom:"20px",border:"1px solid #374151"},children:[(0,i.jsx)("div",{style:{marginBottom:"16px"},children:(0,i.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,i.jsx)("input",{type:"text",placeholder:"bottles"===l?"위스키명, 브랜드, 메모로 검색...":"위스키명, 브랜드, 시음 노트로 검색...",value:p.searchTerm,onChange:e=>u("searchTerm",e.target.value),onKeyPress:e=>{"Enter"===e.key&&(t(p),n())},style:{flex:1,padding:s?"10px 12px":"12px 16px",borderRadius:"8px",border:"1px solid #4B5563",backgroundColor:"#374151",color:"white",fontSize:s?"14px":"16px"}}),(0,i.jsx)("button",{onClick:()=>{t(p),n()},style:{padding:s?"10px 16px":"12px 20px",backgroundColor:"#3B82F6",color:"white",border:"none",borderRadius:"8px",fontSize:s?"14px":"16px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},children:"\uD83D\uDD0D 검색"})]})}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:d?"16px":"0"},children:[(0,i.jsxs)("button",{onClick:()=>c(!d),style:{backgroundColor:"transparent",border:"none",color:"#3B82F6",cursor:"pointer",fontSize:"14px",fontWeight:"500",display:"flex",alignItems:"center",gap:"8px"},children:[(0,i.jsx)("span",{children:"\uD83D\uDD0D 고급 필터"}),g()&&(0,i.jsx)("span",{style:{backgroundColor:"#EF4444",color:"white",borderRadius:"50%",width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",fontWeight:"600"},children:Object.values(p).filter(e=>Array.isArray(e)?e.length>0:""!==e).length}),(0,i.jsx)("span",{style:{transform:d?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.3s ease"},children:"▼"})]}),g()&&(0,i.jsx)("button",{onClick:()=>{let e={searchTerm:"",brandFilter:"",priceMin:"",priceMax:"",ageMin:"",ageMax:"",statusFilter:"",vintageMin:"",vintageMax:"",abvMin:"",abvMax:"",ratingMin:"",ratingMax:"",regionFilter:"",caskTypeFilter:"",dateAddedMin:"",dateAddedMax:""};x(e),t(e),n()},style:{backgroundColor:"transparent",border:"none",color:"#EF4444",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:"필터 초기화"})]}),d&&(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:s?"1fr":"repeat(auto-fit, minmax(250px, 1fr))",gap:s?"12px":"16px",padding:s?"12px":"16px",backgroundColor:"#111827",borderRadius:"8px",border:"1px solid #374151"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:s?"6px":"8px",fontSize:s?"13px":"14px",color:"#9CA3AF"},children:"브랜드"}),(0,i.jsxs)("select",{value:p.brandFilter,onChange:e=>u("brandFilter",e.target.value),style:{width:"100%",padding:s?"6px 10px":"8px 12px",border:"1px solid #374151",borderRadius:"6px",backgroundColor:"#1F2937",color:"white",fontSize:s?"13px":"14px"},children:[(0,i.jsx)("option",{value:"",children:"모든 브랜드"}),(null==r?void 0:r.map(e=>(0,i.jsx)("option",{value:e.id,children:e.name},e.id)))||[]]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:s?"6px":"8px",fontSize:s?"13px":"14px",color:"#9CA3AF"},children:"가격 범위 (원)"}),(0,i.jsxs)("div",{style:{display:"flex",gap:"12px"},children:[(0,i.jsx)("input",{type:"number",placeholder:"최소",value:p.priceMin,onChange:e=>u("priceMin",e.target.value),style:{flex:1,padding:s?"6px 10px":"8px 12px",border:"1px solid #374151",borderRadius:"6px",backgroundColor:"#1F2937",color:"white",fontSize:s?"13px":"14px"}}),(0,i.jsx)("input",{type:"number",placeholder:"최대",value:p.priceMax,onChange:e=>u("priceMax",e.target.value),style:{flex:1,padding:s?"6px 10px":"8px 12px",border:"1px solid #374151",borderRadius:"6px",backgroundColor:"#1F2937",color:"white",fontSize:s?"13px":"14px"}})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:s?"6px":"8px",fontSize:s?"13px":"14px",color:"#9CA3AF"},children:"숙성연수"}),(0,i.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,i.jsx)("input",{type:"number",placeholder:"최소",value:p.ageMin,onChange:e=>u("ageMin",e.target.value),style:{flex:1,padding:s?"6px 10px":"8px 12px",border:"1px solid #374151",borderRadius:"6px",backgroundColor:"#1F2937",color:"white",fontSize:s?"13px":"14px"}}),(0,i.jsx)("input",{type:"number",placeholder:"최대",value:p.ageMax,onChange:e=>u("ageMax",e.target.value),style:{flex:1,padding:s?"6px 10px":"8px 12px",border:"1px solid #374151",borderRadius:"6px",backgroundColor:"#1F2937",color:"white",fontSize:s?"13px":"14px"}})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:s?"6px":"8px",fontSize:s?"13px":"14px",color:"#9CA3AF"},children:"상태"}),(0,i.jsxs)("select",{value:p.statusFilter,onChange:e=>u("statusFilter",e.target.value),style:{width:"100%",padding:s?"6px 10px":"8px 12px",border:"1px solid #374151",borderRadius:"6px",backgroundColor:"#1F2937",color:"white",fontSize:s?"13px":"14px"},children:[(0,i.jsx)("option",{value:"",children:"모든 상태"}),(0,i.jsx)("option",{value:"unopened",children:"미오픈"}),(0,i.jsx)("option",{value:"opened",children:"오픈"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:s?"6px":"8px",fontSize:s?"13px":"14px",color:"#9CA3AF"},children:"빈티지"}),(0,i.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,i.jsx)("input",{type:"number",placeholder:"최소",value:p.vintageMin,onChange:e=>u("vintageMin",e.target.value),style:{flex:1,padding:s?"6px 10px":"8px 12px",border:"1px solid #374151",borderRadius:"6px",backgroundColor:"#1F2937",color:"white",fontSize:s?"13px":"14px"}}),(0,i.jsx)("input",{type:"number",placeholder:"최대",value:p.vintageMax,onChange:e=>u("vintageMax",e.target.value),style:{flex:1,padding:s?"6px 10px":"8px 12px",border:"1px solid #374151",borderRadius:"6px",backgroundColor:"#1F2937",color:"white",fontSize:s?"13px":"14px"}})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:s?"6px":"8px",fontSize:s?"13px":"14px",color:"#9CA3AF"},children:"캐스크 타입"}),(0,i.jsxs)("select",{value:p.caskTypeFilter,onChange:e=>u("caskTypeFilter",e.target.value),style:{width:"100%",padding:s?"6px 10px":"8px 12px",border:"1px solid #374151",borderRadius:"6px",backgroundColor:"#1F2937",color:"white",fontSize:s?"13px":"14px"},children:[(0,i.jsx)("option",{value:"",children:"모든 캐스크 타입"}),(0,i.jsx)("option",{value:"Sherry",children:"Sherry"}),(0,i.jsx)("option",{value:"Bourbon",children:"Bourbon"}),(0,i.jsx)("option",{value:"Port",children:"Port"}),(0,i.jsx)("option",{value:"Madeira",children:"Madeira"}),(0,i.jsx)("option",{value:"Wine",children:"Wine"}),(0,i.jsx)("option",{value:"Rum",children:"Rum"}),(0,i.jsx)("option",{value:"Cognac",children:"Cognac"}),(0,i.jsx)("option",{value:"Virgin Oak",children:"Virgin Oak"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#9CA3AF"},children:"도수 (%)"}),(0,i.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,i.jsx)("input",{type:"number",step:"0.1",placeholder:"최소",value:p.abvMin,onChange:e=>u("abvMin",e.target.value),style:{flex:1,padding:"8px 12px",border:"1px solid #374151",borderRadius:"6px",backgroundColor:"#1F2937",color:"white",fontSize:"14px"}}),(0,i.jsx)("input",{type:"number",step:"0.1",placeholder:"최대",value:p.abvMax,onChange:e=>u("abvMax",e.target.value),style:{flex:1,padding:"8px 12px",border:"1px solid #374151",borderRadius:"6px",backgroundColor:"#1F2937",color:"white",fontSize:"14px"}})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#9CA3AF"},children:"평점"}),(0,i.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,i.jsx)("input",{type:"number",step:"0.1",min:"0",max:"10",placeholder:"최소",value:p.ratingMin,onChange:e=>u("ratingMin",e.target.value),style:{flex:1,padding:"8px 12px",border:"1px solid #374151",borderRadius:"6px",backgroundColor:"#1F2937",color:"white",fontSize:"14px"}}),(0,i.jsx)("input",{type:"number",step:"0.1",min:"0",max:"10",placeholder:"최대",value:p.ratingMax,onChange:e=>u("ratingMax",e.target.value),style:{flex:1,padding:"8px 12px",border:"1px solid #374151",borderRadius:"6px",backgroundColor:"#1F2937",color:"white",fontSize:"14px"}})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#9CA3AF"},children:"지역"}),(0,i.jsxs)("select",{value:p.regionFilter,onChange:e=>u("regionFilter",e.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #374151",borderRadius:"6px",backgroundColor:"#1F2937",color:"white",fontSize:"14px"},children:[(0,i.jsx)("option",{value:"",children:"모든 지역"}),(0,i.jsx)("option",{value:"scotch",children:"스코틀랜드"}),(0,i.jsx)("option",{value:"irish",children:"아일랜드"}),(0,i.jsx)("option",{value:"american",children:"미국"}),(0,i.jsx)("option",{value:"japanese",children:"일본"}),(0,i.jsx)("option",{value:"canadian",children:"캐나다"}),(0,i.jsx)("option",{value:"other",children:"기타"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#9CA3AF"},children:"캐스크 타입"}),(0,i.jsxs)("select",{value:p.caskTypeFilter,onChange:e=>u("caskTypeFilter",e.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #374151",borderRadius:"6px",backgroundColor:"#1F2937",color:"white",fontSize:"14px"},children:[(0,i.jsx)("option",{value:"",children:"모든 타입"}),(0,i.jsx)("option",{value:"sherry",children:"셰리 캐스크"}),(0,i.jsx)("option",{value:"bourbon",children:"버번 캐스크"}),(0,i.jsx)("option",{value:"port",children:"포트 캐스크"}),(0,i.jsx)("option",{value:"wine",children:"와인 캐스크"}),(0,i.jsx)("option",{value:"other",children:"기타"})]})]})]})]})}function w(e){let{currentFilters:t,onFiltersChange:n,onSearch:r,isSearchMode:a,onResetSearch:o,brands:l}=e;return(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsx)(_,{currentFilters:t,onFiltersChange:n,onSearch:r,searchType:"bottles",brands:l}),a&&(0,i.jsx)("div",{style:{marginTop:"12px",textAlign:"center"},children:(0,i.jsx)("button",{onClick:o,style:{padding:"8px 16px",backgroundColor:"#6B7280",border:"none",borderRadius:"6px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:"\uD83D\uDD04 검색 초기화"})})]})}function C(e){let{type:t,count:n=1,className:r=""}=e,[l,s]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{let e=setTimeout(()=>s(!0),100);return()=>clearTimeout(e)},[]),(0,i.jsxs)(i.Fragment,{children:[(()=>{switch(t){case"card":return(0,i.jsxs)("div",{className:"skeleton-card ".concat(r),style:{backgroundColor:"#374151",borderRadius:"12px",padding:"20px",border:"1px solid #4B5563",animation:l?"pulse 1.5s ease-in-out infinite":"none"},children:[(0,i.jsx)("div",{style:{width:"100%",height:"200px",backgroundColor:"#4B5563",borderRadius:"8px",marginBottom:"16px",animation:"pulse 1.5s ease-in-out infinite"}}),(0,i.jsx)("div",{style:{width:"70%",height:"24px",backgroundColor:"#4B5563",borderRadius:"4px",marginBottom:"8px",animation:"pulse 1.5s ease-in-out infinite"}}),(0,i.jsx)("div",{style:{width:"50%",height:"16px",backgroundColor:"#4B5563",borderRadius:"4px",marginBottom:"16px",animation:"pulse 1.5s ease-in-out infinite"}}),(0,i.jsxs)("div",{style:{display:"flex",gap:"8px",marginBottom:"16px"},children:[(0,i.jsx)("div",{style:{width:"60px",height:"24px",backgroundColor:"#4B5563",borderRadius:"12px",animation:"pulse 1.5s ease-in-out infinite"}}),(0,i.jsx)("div",{style:{width:"80px",height:"24px",backgroundColor:"#4B5563",borderRadius:"12px",animation:"pulse 1.5s ease-in-out infinite"}})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,i.jsx)("div",{style:{flex:1,height:"36px",backgroundColor:"#4B5563",borderRadius:"6px",animation:"pulse 1.5s ease-in-out infinite"}}),(0,i.jsx)("div",{style:{flex:1,height:"36px",backgroundColor:"#4B5563",borderRadius:"6px",animation:"pulse 1.5s ease-in-out infinite"}})]})]});case"list":return(0,i.jsx)("div",{className:"skeleton-list ".concat(r),style:{display:"flex",flexDirection:"column",gap:"12px"},children:Array.from({length:n}).map((e,t)=>(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px",backgroundColor:"#374151",borderRadius:"8px",border:"1px solid #4B5563"},children:[(0,i.jsx)("div",{style:{width:"40px",height:"40px",backgroundColor:"#4B5563",borderRadius:"50%",animation:"pulse 1.5s ease-in-out infinite"}}),(0,i.jsxs)("div",{style:{flex:1},children:[(0,i.jsx)("div",{style:{width:"60%",height:"16px",backgroundColor:"#4B5563",borderRadius:"4px",marginBottom:"4px",animation:"pulse 1.5s ease-in-out infinite"}}),(0,i.jsx)("div",{style:{width:"40%",height:"12px",backgroundColor:"#4B5563",borderRadius:"4px",animation:"pulse 1.5s ease-in-out infinite"}})]})]},t))});case"text":return(0,i.jsx)("div",{className:"skeleton-text ".concat(r),style:{display:"flex",flexDirection:"column",gap:"8px"},children:Array.from({length:n}).map((e,t)=>(0,i.jsx)("div",{style:{width:t===n-1?"60%":"100%",height:"16px",backgroundColor:"#4B5563",borderRadius:"4px",animation:"pulse 1.5s ease-in-out infinite"}},t))});case"image":return(0,i.jsx)("div",{className:"skeleton-image ".concat(r),style:{width:"100%",height:"200px",backgroundColor:"#4B5563",borderRadius:"8px",animation:"pulse 1.5s ease-in-out infinite"}});case"grid":return(0,i.jsx)("div",{className:"skeleton-grid ".concat(r),style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))",gap:"16px"},children:Array.from({length:n}).map((e,t)=>(0,i.jsxs)("div",{style:{backgroundColor:"#374151",borderRadius:"12px",padding:"16px",border:"1px solid #4B5563",animation:"pulse 1.5s ease-in-out infinite"},children:[(0,i.jsx)("div",{style:{width:"100%",height:"150px",backgroundColor:"#4B5563",borderRadius:"8px",marginBottom:"12px",animation:"pulse 1.5s ease-in-out infinite"}}),(0,i.jsx)("div",{style:{width:"70%",height:"20px",backgroundColor:"#4B5563",borderRadius:"4px",marginBottom:"8px",animation:"pulse 1.5s ease-in-out infinite"}}),(0,i.jsx)("div",{style:{width:"50%",height:"14px",backgroundColor:"#4B5563",borderRadius:"4px",marginBottom:"12px",animation:"pulse 1.5s ease-in-out infinite"}}),(0,i.jsxs)("div",{style:{display:"flex",gap:"6px"},children:[(0,i.jsx)("div",{style:{width:"50px",height:"20px",backgroundColor:"#4B5563",borderRadius:"10px",animation:"pulse 1.5s ease-in-out infinite"}}),(0,i.jsx)("div",{style:{width:"70px",height:"20px",backgroundColor:"#4B5563",borderRadius:"10px",animation:"pulse 1.5s ease-in-out infinite"}})]})]},t))});default:return null}})(),(0,i.jsx)(a(),{id:"c56488220b00ab20",children:"@keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}"})]})}function k(e){let{user:t,brands:n,onShowWhiskyModal:r,onShowTastingModal:a,onShowTastingHistory:s,onShowDetailModal:d}=e,[c,p]=(0,o.useState)([]),[x,u]=(0,o.useState)(!0),[g,h]=(0,o.useState)(1),[b,m]=(0,o.useState)(!0),{isMobile:v,isTablet:_,isTabletLandscape:k,isDesktop:S}=y(),[D,B]=(0,o.useState)({searchTerm:"",brandFilter:"",priceMin:"",priceMax:"",ageMin:"",ageMax:"",statusFilter:"",vintageMin:"",vintageMax:"",abvMin:"",abvMax:"",ratingMin:"",ratingMax:"",regionFilter:"",caskTypeFilter:"",dateAddedMin:"",dateAddedMax:""}),[z,F]=(0,o.useState)(!1),{showToast:R}=(0,f.d)(),A=async()=>{try{let{data:e,error:n}=await l.supabase.from("bottles").select("\n          *,\n          brands (id, name, country, region, description),\n          tastings (id)\n        ").eq("user_id",t.id).order("created_at",{ascending:!1});if(n)throw n;let i=e.map(e=>{var t;let n=(null==(t=e.tastings)?void 0:t.length)||0;return{...e,tasting_count:n}});p(i)}catch(e){R("데이터를 가져오는 중 오류가 발생했습니다.","error")}finally{u(!1)}};(0,o.useEffect)(()=>{t&&A()},[t]);let W=(0,o.useMemo)(()=>z?c.filter(e=>{var t,i,r;if(D.searchTerm){let n=D.searchTerm.toLowerCase(),i=e.name.toLowerCase().includes(n),r=((null==(t=e.brands)?void 0:t.name)||e.custom_brand||"").toLowerCase().includes(n);if(!i&&!r)return!1}if(D.brandFilter){let t=(null==(i=n.find(e=>e.id===D.brandFilter))?void 0:i.name)||"";if(!((null==(r=e.brands)?void 0:r.name)||e.custom_brand||"").toLowerCase().includes(t.toLowerCase()))return!1}return!(D.priceMin&&e.retail_price<parseFloat(D.priceMin)||D.priceMax&&e.retail_price>parseFloat(D.priceMax)||D.ageMin&&e.age_years<parseInt(D.ageMin)||D.ageMax&&e.age_years>parseInt(D.ageMax)||D.statusFilter&&e.bottle_status!==D.statusFilter||D.vintageMin&&e.vintage<parseInt(D.vintageMin)||D.vintageMax&&e.vintage>parseInt(D.vintageMax)||D.abvMin&&e.abv<parseFloat(D.abvMin)||D.abvMax&&e.abv>parseFloat(D.abvMax))&&(!D.caskTypeFilter||e.cask_type===D.caskTypeFilter)}):c,[c,D,z,n]),I=W.slice(0,12*g),T=e=>{r(e)},E=async e=>{try{let{error:t}=await l.supabase.from("bottles").delete().eq("id",e);if(t)throw t;p(t=>t.filter(t=>t.id!==e)),R("위스키가 삭제되었습니다.","success")}catch(e){R("삭제 중 오류가 발생했습니다.","error")}},M=e=>{a(e)},N=e=>{s(e)},L=e=>{r(e)};if(x)return(0,i.jsx)(C,{type:"grid",count:6});let O=n||[];return(0,i.jsxs)("div",{style:{padding:"20px"},children:[(0,i.jsx)(w,{currentFilters:D,onFiltersChange:e=>{B(e),F(!0),h(1)},onSearch:()=>{F(!0),h(1)},isSearchMode:z,onResetSearch:()=>{B({searchTerm:"",brandFilter:"",priceMin:"",priceMax:"",ageMin:"",ageMax:"",statusFilter:"",vintageMin:"",vintageMax:"",abvMin:"",abvMax:"",ratingMin:"",ratingMax:"",regionFilter:"",caskTypeFilter:"",dateAddedMin:"",dateAddedMax:""}),F(!1),h(1)},brands:O}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[(0,i.jsxs)("span",{style:{color:"#9CA3AF",fontSize:"14px"},children:[z?"".concat(W.length,"개"):"".concat(c.length,"개"),"의 위스키"]}),(0,i.jsx)("button",{onClick:()=>r(),style:{padding:"8px 16px",backgroundColor:"#3B82F6",border:"none",borderRadius:"6px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:"위스키 추가"})]}),(0,i.jsx)("div",{style:{display:"grid",gridTemplateColumns:v?"1fr":_?"repeat(2, 1fr)":k?"repeat(3, 1fr)":"repeat(auto-fill, minmax(320px, 1fr))",gap:v?"16px":_?"20px":"24px",marginBottom:"24px",maxWidth:"100%",overflowX:"hidden",overflowY:"visible",touchAction:"pan-y",WebkitOverflowScrolling:"touch",WebkitUserSelect:"none",userSelect:"none"},children:I.map(e=>(0,i.jsx)(j,{bottle:e,onEdit:T,onDelete:E,onAddTasting:M,onViewTastings:N,onImageChange:L,onClick:()=>{d(e)}},e.id))}),I.length<W.length&&(0,i.jsx)("div",{style:{textAlign:"center",marginTop:"24px"},children:(0,i.jsxs)("button",{onClick:()=>{I.length<W.length&&h(e=>e+1)},style:{padding:"12px 24px",backgroundColor:"#3B82F6",border:"none",borderRadius:"8px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"500"},children:["더 보기 (",W.length-I.length,"개)"]})})]})}async function S(e){if("undefined"!=typeof navigator&&"function"==typeof navigator.share)try{return await navigator.share({title:e.title,text:e.text,url:e.url}),!0}catch(e){}return!1}async function D(e){try{if("undefined"!=typeof navigator&&navigator.clipboard&&window.isSecureContext)return await navigator.clipboard.writeText(e),!0;{let t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",document.body.appendChild(t),t.focus(),t.select();let n=document.execCommand("copy");if(document.body.removeChild(t),n)return!0;return!1}}catch(e){return!1}}function B(e){var t,n,r,a,s,d,c;let{user:p,brands:x,onShowTastingModal:u}=e,[g,h]=(0,o.useState)([]),[b,m]=(0,o.useState)([]),[f,v]=(0,o.useState)([]),[j,w]=(0,o.useState)(!0),[C,k]=(0,o.useState)(!1),{isMobile:B,isTablet:z,isTabletLandscape:F}=y(),[R,A]=(0,o.useState)({searchTerm:"",brandFilter:"",priceMin:"",priceMax:"",ageMin:"",ageMax:"",statusFilter:"",vintageMin:"",vintageMax:"",abvMin:"",abvMax:"",ratingMin:"",ratingMax:"",regionFilter:"",caskTypeFilter:"",dateAddedMin:"",dateAddedMax:""}),[W,I]=(0,o.useState)(!1),[T,E]=(0,o.useState)([]),[M,N]=(0,o.useState)(null),[L,O]=(0,o.useState)(!1);(0,o.useEffect)(()=>{p&&(P(),U(),x?v(x):q())},[p,x]),(0,o.useEffect)(()=>{if(!W)return void E(g);let e=g;if(R.searchTerm){let t=R.searchTerm.toLowerCase();e=e.filter(e=>{var n,i,r,a;let o=(null==(n=e.bottles)?void 0:n.name)||e.bottle_name||"",l=(null==(r=e.bottles)||null==(i=r.brands)?void 0:i.name)||(null==(a=e.bottles)?void 0:a.custom_brand)||e.bottle_brand||"",s=e.nose_notes||e.palate_notes||e.finish_notes||e.additional_notes||"";return o.toLowerCase().includes(t)||l.toLowerCase().includes(t)||s.toLowerCase().includes(t)})}if(R.brandFilter){let t=f.find(e=>e.id===R.brandFilter),n=null==t?void 0:t.name;n&&(e=e.filter(e=>{var t,i,r;return((null==(i=e.bottles)||null==(t=i.brands)?void 0:t.name)||(null==(r=e.bottles)?void 0:r.custom_brand)||e.bottle_brand||"").toLowerCase().includes(n.toLowerCase())}))}(R.ratingMin||R.ratingMax)&&(e=e.filter(e=>{let t=e.overall_rating||0,n=R.ratingMin?parseFloat(R.ratingMin):0,i=R.ratingMax?parseFloat(R.ratingMax):1/0;return t>=n&&t<=i})),E(e)},[g,R,W]);let P=async()=>{try{w(!0);let{data:e,error:t}=await l.supabase.from("tastings").select("\n          *,\n          bottles (\n            name,\n            custom_brand,\n            vintage,\n            age_years,\n            brands (name)\n          )\n        ").eq("user_id",p.id).order("tasting_date",{ascending:!1});if(t)throw t;h(e||[])}catch(e){}finally{w(!1)}},U=async()=>{try{let{data:e,error:t}=await l.supabase.from("bottles").select("\n          *,\n          brands (name)\n        ").eq("user_id",p.id).order("name");if(t)throw t;m(e||[])}catch(e){}},q=async()=>{try{let{data:e,error:t}=await l.supabase.from("brands").select("*").order("name");if(t)throw t;v(e||[])}catch(e){}},H=async e=>{if(confirm("정말로 이 시음 기록을 삭제하시겠습니까?"))try{let{error:t}=await l.supabase.from("tastings").delete().eq("id",e);if(t)throw t;P(),alert("시음 기록이 성공적으로 삭제되었습니다!")}catch(e){alert("시음 기록 삭제 중 오류가 발생했습니다.")}},G=e=>{try{let t=function(e){var t,n,i,r;let a=(null==(t=e.bottles)?void 0:t.name)||e.bottle_name||"바/모임 시음",o=(null==(i=e.bottles)||null==(n=i.brands)?void 0:n.name)||(null==(r=e.bottles)?void 0:r.custom_brand)||e.bottle_brand||"",l=new Date(e.tasting_date).toLocaleDateString("ko-KR"),s="bar"===e.tasting_type?"바":"meeting"===e.tasting_type?"모임":"보틀",d="\uD83E\uDD43 ".concat(a);return o&&(d+=" (".concat(o,")")),d+="\n\uD83D\uDCC5 ".concat(l),d+="\n\uD83D\uDCCD ".concat(s,"에서 시음"),e.location&&(d+="\n\uD83C\uDFE0 ".concat(e.location)),e.overall_rating&&(d+="\n⭐ 종합 평점: ".concat(e.overall_rating,"/10")),(e.nose_rating||e.palate_rating||e.finish_rating)&&(d+="\n\uD83D\uDCCA 세부 평점:",e.nose_rating&&(d+=" 노즈(".concat(e.nose_rating,")")),e.palate_rating&&(d+=" 팔레트(".concat(e.palate_rating,")")),e.finish_rating&&(d+=" 피니시(".concat(e.finish_rating,")"))),(e.nose_notes||e.palate_notes||e.finish_notes||e.additional_notes)&&(d+="\n\uD83D\uDCDD 시음 노트:",e.nose_notes&&(d+="\n  노즈: ".concat(e.nose_notes)),e.palate_notes&&(d+="\n  팔레트: ".concat(e.palate_notes)),e.finish_notes&&(d+="\n  피니시: ".concat(e.finish_notes)),e.additional_notes&&(d+="\n  추가: ".concat(e.additional_notes))),d+="\n\n#위스키 #시음기록 #위스키로그",{title:"".concat(a," 시음 기록"),text:d,imageUrl:e.image_url}}(e);if(!t.text||t.text.length<10)return void alert("공유할 내용이 부족합니다.");!function(e){if("undefined"!=typeof navigator&&"function"==typeof navigator.share)return S(e);!function(e){var t,n,i,r,a,o;let l=document.createElement("div");l.style.cssText="\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: rgba(0, 0, 0, 0.8);\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    z-index: 10000;\n  ";let s=document.createElement("div");s.style.cssText="\n    background: #1F2937;\n    border-radius: 12px;\n    padding: 24px;\n    max-width: 400px;\n    width: 90%;\n    color: white;\n  ",s.innerHTML='\n    <h3 style="margin: 0 0 20px 0; font-size: 18px;">공유하기</h3>\n    <div style="display: grid; gap: 12px;">\n      <button id="kakaoTalkBtn" style="\n        padding: 12px;\n        background: #FEE500;\n        color: #000;\n        border: none;\n        border-radius: 8px;\n        cursor: pointer;\n        font-weight: 600;\n      ">\uD83D\uDCAC 카카오톡 (클립보드 복사 후 붙여넣기)</button>\n      \n      <button id="telegramBtn" style="\n        padding: 12px;\n        background: #0088CC;\n        color: white;\n        border: none;\n        border-radius: 8px;\n        cursor: pointer;\n        font-weight: 600;\n      ">\uD83D\uDCF1 텔레그램</button>\n      \n      <button id="twitterBtn" style="\n        padding: 12px;\n        background: #1DA1F2;\n        color: white;\n        border: none;\n        border-radius: 8px;\n        cursor: pointer;\n        font-weight: 600;\n      ">\uD83D\uDC26 트위터/X</button>\n      \n      <button id="facebookBtn" style="\n        padding: 12px;\n        background: #1877F2;\n        color: white;\n        border: none;\n        border-radius: 8px;\n        cursor: pointer;\n        font-weight: 600;\n      ">\uD83D\uDCD8 페이스북</button>\n      \n      <button id="clipboardBtn" style="\n        padding: 12px;\n        background: #374151;\n        color: white;\n        border: none;\n        border-radius: 8px;\n        cursor: pointer;\n        font-weight: 600;\n      ">\uD83D\uDCCB 클립보드 복사 (추천)</button>\n    </div>\n    \n    <div style="\n      margin-top: 16px;\n      padding: 12px;\n      background: rgba(59, 130, 246, 0.1);\n      border: 1px solid rgba(59, 130, 246, 0.3);\n      border-radius: 8px;\n      font-size: 12px;\n      color: #60a5fa;\n    ">\n      \uD83D\uDCA1 <strong>카카오톡 공유 팁:</strong><br>\n      • 클립보드 복사를 먼저 사용하세요<br>\n      • 복사된 텍스트를 카카오톡에 붙여넣기 하세요<br>\n      • 더 안정적이고 빠릅니다!\n    </div>\n    \n    <button id="closeBtn" style="\n      margin-top: 20px;\n      width: 100%;\n      padding: 12px;\n      background: #6B7280;\n      color: white;\n      border: none;\n      border-radius: 8px;\n      cursor: pointer;\n    ">닫기</button>\n  ',l.className="share-modal",l.appendChild(s),document.body.appendChild(l);let d="".concat(e.title,"\n\n").concat(e.text);null==(t=document.getElementById("kakaoTalkBtn"))||t.addEventListener("click",()=>{D(d).then(e=>{e?alert("✅ 클립보드에 복사되었습니다!\n\n\uD83D\uDCF1 카카오톡 사용법:\n1. 카카오톡 앱을 열어주세요\n2. 원하는 채팅방을 선택하세요\n3. Ctrl+V (또는 붙여넣기)를 눌러주세요\n4. 시음 기록이 공유됩니다!"):(alert("❌ 클립보드 복사에 실패했습니다.\n\n\uD83D\uDCCB 수동 복사 방법:\n1. 아래 텍스트를 선택하세요\n2. Ctrl+C로 복사하세요\n3. 카카오톡에 붙여넣기 하세요"),prompt("복사할 텍스트:",d))});let t=encodeURIComponent(e.text),n="https://accounts.kakao.com/login/?continue=https://center-pf.kakao.com/_mxfDd/chat";"undefined"!=typeof navigator&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?window.open("https://story.kakao.com/share?text=".concat(t),"_blank"):window.open(n,"_blank","width=600,height=400")||(window.location.href=n),setTimeout(()=>{alert("카카오톡 공유가 열렸습니다.\n만약 공유가 안된다면:\n1. 클립보드 복사를 사용하세요\n2. 수동으로 카카오톡에 붙여넣기 하세요")},1e3),l.remove()}),null==(n=document.getElementById("telegramBtn"))||n.addEventListener("click",()=>{let t=encodeURIComponent(e.text),n="https://t.me/share/url?url=".concat(encodeURIComponent(window.location.href),"&text=").concat(t);window.open(n,"_blank","width=600,height=400"),l.remove()}),null==(i=document.getElementById("twitterBtn"))||i.addEventListener("click",()=>{let t=encodeURIComponent(e.text);window.open("https://twitter.com/intent/tweet?text=".concat(t),"_blank","width=600,height=400"),l.remove()}),null==(r=document.getElementById("facebookBtn"))||r.addEventListener("click",()=>{let t=encodeURIComponent(window.location.href),n=encodeURIComponent(e.text),i="https://www.facebook.com/sharer/sharer.php?u=".concat(t,"&quote=").concat(n);window.open(i,"_blank","width=600,height=400"),l.remove()}),null==(a=document.getElementById("clipboardBtn"))||a.addEventListener("click",async()=>{await D(d)?alert("클립보드에 복사되었습니다!"):(alert("클립보드 복사에 실패했습니다. 수동으로 복사해주세요."),prompt("다음 텍스트를 복사해주세요:",d)),l.remove()}),null==(o=document.getElementById("closeBtn"))||o.addEventListener("click",()=>{l.remove()}),l.addEventListener("click",e=>{e.target===l&&l.remove()})}(e)}(t)}catch(e){alert("공유 기능을 사용할 수 없습니다. 오류: "+(e instanceof Error?e.message:"알 수 없는 오류"))}},[Y,J]=(0,o.useState)(!1),[V,K]=(0,o.useState)(""),X=()=>{if(0===b.length)return void alert("먼저 위스키를 추가해주세요.");if(1===b.length){u&&u({bottles:b[0]});return}J(!0),K("")},Z=b.filter(e=>{var t,n,i,r;if(!V)return!0;let a=V.toLowerCase(),o=(null==(t=e.name)?void 0:t.toLowerCase())||"",l=((null==(n=e.brands)?void 0:n.name)||e.custom_brand||"").toLowerCase(),s=(null==(i=e.vintage)?void 0:i.toString())||"",d=(null==(r=e.age_years)?void 0:r.toString())||"";return o.includes(a)||l.includes(a)||s.includes(a)||d.includes(a)}),Q=()=>{u&&u(null)},$=e=>{u&&u(e)};return j?(0,i.jsx)("div",{style:{padding:"20px",textAlign:"center"},children:(0,i.jsx)("p",{children:"시음 기록 로딩중..."})}):(0,i.jsxs)("div",{style:{padding:"20px"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,i.jsxs)("h2",{children:["시음 목록 (",T.length,"개)"]}),W&&(0,i.jsx)("button",{onClick:()=>{I(!1),A({searchTerm:"",brandFilter:"",priceMin:"",priceMax:"",ageMin:"",ageMax:"",statusFilter:"",vintageMin:"",vintageMax:"",abvMin:"",abvMax:"",ratingMin:"",ratingMax:"",regionFilter:"",caskTypeFilter:"",dateAddedMin:"",dateAddedMax:""})},style:{padding:"6px 12px",backgroundColor:"#6B7280",border:"none",borderRadius:"6px",color:"white",cursor:"pointer",fontSize:"12px",fontWeight:"500"},children:"검색 초기화"})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:B?"6px":"8px",flexDirection:B?"column":"row"},children:[(0,i.jsx)("button",{onClick:X,style:{padding:B?"6px 12px":"8px 16px",backgroundColor:"#3B82F6",border:"none",borderRadius:"6px",color:"white",cursor:"pointer",fontSize:B?"12px":"13px",fontWeight:"500",whiteSpace:"nowrap"},children:B?"보유 위스키 추가":"보유 위스키 시음 추가"}),(0,i.jsx)("button",{onClick:Q,style:{padding:B?"6px 12px":"8px 16px",backgroundColor:"#10B981",border:"none",borderRadius:"6px",color:"white",cursor:"pointer",fontSize:B?"12px":"13px",fontWeight:"500",whiteSpace:"nowrap"},children:B?"바/모임 추가":"바/모임 시음 추가"})]})]}),(0,i.jsx)("div",{style:{marginBottom:"20px"},children:(0,i.jsx)(_,{brands:[],currentFilters:R,onFiltersChange:e=>{A(e),I(!0)},onSearch:()=>{I(!0)},searchType:"tastings"})}),b.length>0&&(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px",cursor:"pointer"},onClick:()=>k(!C),children:[(0,i.jsxs)("h3",{style:{margin:0},children:["위스키별 시음 (",b.length,"개)"]}),(0,i.jsx)("span",{style:{fontSize:"18px",color:"#9CA3AF"},children:C?"▼":"▶"})]}),C&&(0,i.jsx)("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap",maxHeight:"200px",overflowY:"auto",padding:"12px",backgroundColor:"rgba(55, 65, 81, 0.3)",borderRadius:"8px",border:"1px solid rgba(75, 85, 99, 0.5)"},children:b.map(e=>(0,i.jsx)("button",{onClick:t=>{t.stopPropagation(),u&&u({bottles:e})},style:{padding:"6px 12px",backgroundColor:"#374151",border:"none",borderRadius:"6px",color:"white",cursor:"pointer",fontSize:"12px",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#4B5563"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="#374151"},children:e.name},e.id))})]}),(0,i.jsx)("div",{style:{display:"grid",gridTemplateColumns:B?"1fr":z?"repeat(2, 1fr)":F?"repeat(3, 1fr)":"repeat(auto-fill, minmax(380px, 1fr))",gap:B?"16px":z?"20px":"24px",maxWidth:"100%",overflowX:"hidden"},children:T.map((e,t)=>{var n,r,a,o,l,s,d;return(0,i.jsxs)("div",{className:"fade-in",style:{animationDelay:"".concat(.1*t,"s"),cursor:"pointer",transition:"all 0.2s ease",backgroundColor:"#1F2937",borderRadius:"12px",padding:"16px",border:"1px solid #374151"},onClick:()=>{N(e),O(!0),sessionStorage.setItem("scrollPosition",window.scrollY.toString())},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 8px 25px rgba(0, 0, 0, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none"},children:[(0,i.jsxs)("div",{style:{position:"relative",marginBottom:"20px",borderRadius:"12px",overflow:"hidden",height:"180px",background:"linear-gradient(135deg, #374151 0%, #4b5563 100%)"},children:[e.image_url||(null==(n=e.bottles)?void 0:n.image_url)?(0,i.jsx)("img",{src:e.image_url||(null==(r=e.bottles)?void 0:r.image_url),alt:(null==(a=e.bottles)?void 0:a.name)||"시음 기록",style:{width:"100%",height:"100%",objectFit:"cover"}}):(0,i.jsx)("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"48px",color:"#6b7280"},children:"\uD83C\uDF77"}),(0,i.jsx)("div",{style:{position:"absolute",top:"12px",left:"12px",padding:"6px 12px",borderRadius:"20px",fontSize:"12px",fontWeight:"600",backgroundColor:"bar"===e.tasting_type?"rgba(16, 185, 129, 0.9)":"meeting"===e.tasting_type?"rgba(59, 130, 246, 0.9)":"rgba(245, 158, 11, 0.9)",color:"white",backdropFilter:"blur(8px)"},children:"bar"===e.tasting_type?"바":"meeting"===e.tasting_type?"모임":"보틀"}),(0,i.jsx)("div",{style:{position:"absolute",top:"12px",right:"12px",padding:"6px 12px",borderRadius:"20px",fontSize:"12px",fontWeight:"600",backgroundColor:"rgba(0, 0, 0, 0.7)",color:"white",backdropFilter:"blur(8px)"},children:new Date(e.tasting_date).toLocaleDateString("ko-KR")})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{style:{margin:"0 0 8px 0",fontSize:"18px",fontWeight:"700",color:"white",lineHeight:"1.3"},children:(null==(o=e.bottles)?void 0:o.name)||e.bottle_name||"바/모임 시음"}),(0,i.jsx)("p",{style:{margin:"0 0 16px 0",color:"#9CA3AF",fontSize:"14px",fontWeight:"500"},children:(null==(s=e.bottles)||null==(l=s.brands)?void 0:l.name)||(null==(d=e.bottles)?void 0:d.custom_brand)||e.bottle_brand||""}),(0,i.jsx)("div",{style:{marginBottom:"20px",padding:"16px",backgroundColor:"rgba(17, 24, 39, 0.5)",borderRadius:"8px",border:"1px solid rgba(75, 85, 99, 0.3)"},children:(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"12px"},children:[e.nose_rating&&(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{style:{color:"#9CA3AF",fontSize:"12px"},children:"노즈"}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px",marginTop:"4px"},children:[(0,i.jsx)("span",{style:{color:"white",fontSize:"16px",fontWeight:"600"},children:e.nose_rating}),(0,i.jsx)("div",{style:{display:"flex",gap:"2px"},children:[...Array(10)].map((t,n)=>(0,i.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:n<e.nose_rating?"#FBBF24":"#374151"}},n))})]})]}),e.palate_rating&&(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{style:{color:"#9CA3AF",fontSize:"12px"},children:"팔레트"}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px",marginTop:"4px"},children:[(0,i.jsx)("span",{style:{color:"white",fontSize:"16px",fontWeight:"600"},children:e.palate_rating}),(0,i.jsx)("div",{style:{display:"flex",gap:"2px"},children:[...Array(10)].map((t,n)=>(0,i.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:n<e.palate_rating?"#FBBF24":"#374151"}},n))})]})]}),e.finish_rating&&(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{style:{color:"#9CA3AF",fontSize:"12px"},children:"피니시"}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px",marginTop:"4px"},children:[(0,i.jsx)("span",{style:{color:"white",fontSize:"16px",fontWeight:"600"},children:e.finish_rating}),(0,i.jsx)("div",{style:{display:"flex",gap:"2px"},children:[...Array(10)].map((t,n)=>(0,i.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:n<e.finish_rating?"#FBBF24":"#374151"}},n))})]})]}),e.overall_rating&&(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{style:{color:"#9CA3AF",fontSize:"12px"},children:"종합"}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px",marginTop:"4px"},children:[(0,i.jsx)("span",{style:{color:"#FBBF24",fontSize:"18px",fontWeight:"700"},children:e.overall_rating}),(0,i.jsx)("div",{style:{display:"flex",gap:"2px"},children:[...Array(10)].map((t,n)=>(0,i.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:n<Math.round(e.overall_rating)?"#FBBF24":"#374151"}},n))})]})]})]})}),(e.nose_notes||e.palate_notes||e.finish_notes||e.additional_notes)&&(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsx)("h4",{style:{margin:"0 0 12px 0",fontSize:"14px",color:"#9CA3AF",fontWeight:"600"},children:"시음 노트"}),(0,i.jsxs)("div",{style:{padding:"12px",backgroundColor:"rgba(17, 24, 39, 0.3)",borderRadius:"6px",fontSize:"13px",lineHeight:"1.5",color:"#D1D5DB"},children:[e.nose_notes&&(0,i.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,i.jsx)("strong",{style:{color:"#FBBF24"},children:"노즈:"})," ",e.nose_notes]}),e.palate_notes&&(0,i.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,i.jsx)("strong",{style:{color:"#FBBF24"},children:"팔레트:"})," ",e.palate_notes]}),e.finish_notes&&(0,i.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,i.jsx)("strong",{style:{color:"#FBBF24"},children:"피니시:"})," ",e.finish_notes]}),e.additional_notes&&(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{style:{color:"#FBBF24"},children:"추가:"})," ",e.additional_notes]})]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"12px"},children:[(0,i.jsx)("button",{onClick:t=>{t.stopPropagation(),t.preventDefault(),$(e)},style:{padding:"10px 16px",backgroundColor:"rgba(59, 130, 246, 0.1)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"8px",color:"#60a5fa",cursor:"pointer",fontSize:"14px",fontWeight:"600",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="rgba(59, 130, 246, 0.2)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="rgba(59, 130, 246, 0.1)"},children:"✏️ 수정"}),(0,i.jsx)("button",{onClick:t=>{t.stopPropagation(),t.preventDefault(),G(e)},style:{padding:"10px 16px",backgroundColor:"rgba(16, 185, 129, 0.1)",border:"1px solid rgba(16, 185, 129, 0.3)",borderRadius:"8px",color:"#34d399",cursor:"pointer",fontSize:"14px",fontWeight:"600",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="rgba(16, 185, 129, 0.2)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="rgba(16, 185, 129, 0.1)"},children:"\uD83D\uDCE4 공유"}),(0,i.jsx)("button",{onClick:t=>{t.stopPropagation(),t.preventDefault(),H(e.id)},style:{padding:"10px 16px",backgroundColor:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"8px",color:"#f87171",cursor:"pointer",fontSize:"14px",fontWeight:"600",transition:"all 0.3s ease"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="rgba(239, 68, 68, 0.2)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="rgba(239, 68, 68, 0.1)"},children:"\uD83D\uDDD1️ 삭제"})]})]})]},e.id)})}),0===g.length&&!j&&(0,i.jsxs)("div",{style:{textAlign:"center",padding:"40px",color:"#9CA3AF"},children:[(0,i.jsx)("p",{children:"시음 기록이 없습니다."}),(0,i.jsxs)("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginTop:"16px"},children:[(0,i.jsx)("button",{onClick:X,style:{padding:"10px 20px",backgroundColor:"#3B82F6",border:"none",borderRadius:"8px",color:"white",cursor:"pointer"},children:"보유 위스키 시음 추가"}),(0,i.jsx)("button",{onClick:Q,style:{padding:"10px 20px",backgroundColor:"#10B981",border:"none",borderRadius:"8px",color:"white",cursor:"pointer"},children:"바/모임 시음 추가"})]})]}),L&&M&&(0,i.jsx)("div",{style:{position:"fixed",top:B?(()=>{let e=sessionStorage.getItem("scrollPosition");return e?"".concat(e,"px"):"0px"})():"0px",left:0,right:0,bottom:B?(()=>{let e=sessionStorage.getItem("scrollPosition");return e?"calc(100vh - ".concat(e,"px)"):"100vh"})():"0px",backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"20px",overflowY:"auto",transform:"translateZ(0)"},children:(0,i.jsxs)("div",{style:{width:"100%",maxWidth:"600px",transform:"scale(1.05)",transformOrigin:"center center",marginTop:"auto",marginBottom:"auto",transition:"transform 0.3s ease"},children:[(0,i.jsx)("button",{onClick:()=>{O(!1),N(null);let e=sessionStorage.getItem("scrollPosition");e&&(window.scrollTo(0,parseInt(e)),sessionStorage.removeItem("scrollPosition"))},style:{position:"absolute",top:"20px",right:"20px",width:"40px",height:"40px",backgroundColor:"rgba(239, 68, 68, 0.9)",border:"none",borderRadius:"50%",color:"white",cursor:"pointer",fontSize:"20px",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2001,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.3)"},children:"\xd7"}),(0,i.jsxs)("div",{className:"card hover-lift fade-in",style:{cursor:"default",transform:"none",boxShadow:"none"},children:[(0,i.jsxs)("div",{style:{position:"relative",marginBottom:"20px",borderRadius:"12px",overflow:"hidden",height:"180px",background:"linear-gradient(135deg, #374151 0%, #4b5563 100%)"},children:[M.image_url||(null==(t=M.bottles)?void 0:t.image_url)?(0,i.jsx)("img",{src:M.image_url||(null==(n=M.bottles)?void 0:n.image_url),alt:(null==(r=M.bottles)?void 0:r.name)||"시음 기록",style:{width:"100%",height:"100%",objectFit:"cover"}}):(0,i.jsx)("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"48px",color:"#6b7280"},children:"\uD83C\uDF77"}),(0,i.jsx)("div",{style:{position:"absolute",top:"12px",left:"12px",padding:"6px 12px",borderRadius:"20px",fontSize:"12px",fontWeight:"600",backgroundColor:"bar"===M.tasting_type?"rgba(16, 185, 129, 0.9)":"meeting"===M.tasting_type?"rgba(59, 130, 246, 0.9)":"rgba(245, 158, 11, 0.9)",color:"white",backdropFilter:"blur(8px)"},children:"bar"===M.tasting_type?"바":"meeting"===M.tasting_type?"모임":"보틀"}),(0,i.jsx)("div",{style:{position:"absolute",top:"12px",right:"12px",padding:"6px 12px",borderRadius:"20px",fontSize:"12px",fontWeight:"600",backgroundColor:"rgba(0, 0, 0, 0.7)",color:"white",backdropFilter:"blur(8px)"},children:new Date(M.tasting_date).toLocaleDateString("ko-KR")})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{style:{margin:"0 0 8px 0",fontSize:"18px",fontWeight:"700",color:"white",lineHeight:"1.3"},children:(null==(a=M.bottles)?void 0:a.name)||M.bottle_name||"바/모임 시음"}),(0,i.jsx)("p",{style:{margin:"0 0 16px 0",color:"#9CA3AF",fontSize:"14px",fontWeight:"500"},children:(null==(d=M.bottles)||null==(s=d.brands)?void 0:s.name)||(null==(c=M.bottles)?void 0:c.custom_brand)||M.bottle_brand||""}),(0,i.jsx)("div",{style:{marginBottom:"20px",padding:"16px",backgroundColor:"rgba(17, 24, 39, 0.5)",borderRadius:"8px",border:"1px solid rgba(75, 85, 99, 0.3)"},children:(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"12px"},children:[M.nose_rating&&(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{style:{color:"#9CA3AF",fontSize:"12px"},children:"노즈"}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px",marginTop:"4px"},children:[(0,i.jsx)("span",{style:{color:"white",fontSize:"16px",fontWeight:"600"},children:M.nose_rating}),(0,i.jsx)("div",{style:{display:"flex",gap:"2px"},children:[...Array(10)].map((e,t)=>(0,i.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:t<M.nose_rating?"#FBBF24":"#374151"}},t))})]})]}),M.palate_rating&&(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{style:{color:"#9CA3AF",fontSize:"12px"},children:"팔레트"}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px",marginTop:"4px"},children:[(0,i.jsx)("span",{style:{color:"white",fontSize:"16px",fontWeight:"600"},children:M.palate_rating}),(0,i.jsx)("div",{style:{display:"flex",gap:"2px"},children:[...Array(10)].map((e,t)=>(0,i.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:t<M.palate_rating?"#FBBF24":"#374151"}},t))})]})]}),M.finish_rating&&(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{style:{color:"#9CA3AF",fontSize:"12px"},children:"피니시"}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px",marginTop:"4px"},children:[(0,i.jsx)("span",{style:{color:"white",fontSize:"16px",fontWeight:"600"},children:M.finish_rating}),(0,i.jsx)("div",{style:{display:"flex",gap:"2px"},children:[...Array(10)].map((e,t)=>(0,i.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:t<M.finish_rating?"#FBBF24":"#374151"}},t))})]})]}),M.overall_rating&&(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{style:{color:"#9CA3AF",fontSize:"12px"},children:"종합"}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px",marginTop:"4px"},children:[(0,i.jsx)("span",{style:{color:"#FBBF24",fontSize:"18px",fontWeight:"700"},children:M.overall_rating}),(0,i.jsx)("div",{style:{display:"flex",gap:"2px"},children:[...Array(10)].map((e,t)=>(0,i.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:t<Math.round(M.overall_rating)?"#FBBF24":"#374151"}},t))})]})]})]})}),(M.nose_notes||M.palate_notes||M.finish_notes||M.additional_notes)&&(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsx)("h4",{style:{margin:"0 0 12px 0",fontSize:"14px",color:"#9CA3AF",fontWeight:"600"},children:"시음 노트"}),(0,i.jsxs)("div",{style:{padding:"12px",backgroundColor:"rgba(17, 24, 39, 0.3)",borderRadius:"6px",fontSize:"13px",lineHeight:"1.5",color:"#D1D5DB"},children:[M.nose_notes&&(0,i.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,i.jsx)("strong",{style:{color:"#FBBF24"},children:"노즈:"})," ",M.nose_notes]}),M.palate_notes&&(0,i.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,i.jsx)("strong",{style:{color:"#FBBF24"},children:"팔레트:"})," ",M.palate_notes]}),M.finish_notes&&(0,i.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,i.jsx)("strong",{style:{color:"#FBBF24"},children:"피니시:"})," ",M.finish_notes]}),M.additional_notes&&(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{style:{color:"#FBBF24"},children:"추가:"})," ",M.additional_notes]})]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"12px",position:"relative",zIndex:10},children:[(0,i.jsx)("button",{onClick:e=>{e.stopPropagation(),e.preventDefault(),$(M),O(!1)},style:{padding:"10px 16px",backgroundColor:"rgba(59, 130, 246, 0.1)",border:"1px solid rgba(59, 130, 246, 0.3)",borderRadius:"8px",color:"#60a5fa",cursor:"pointer",fontSize:"14px",fontWeight:"600",transition:"all 0.3s ease",position:"relative",zIndex:5},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="rgba(59, 130, 246, 0.2)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="rgba(59, 130, 246, 0.1)"},children:"✏️ 수정"}),(0,i.jsx)("button",{onClick:e=>{e.stopPropagation(),e.preventDefault(),G(M)},style:{padding:"10px 16px",backgroundColor:"rgba(16, 185, 129, 0.1)",border:"1px solid rgba(16, 185, 129, 0.3)",borderRadius:"8px",color:"#34d399",cursor:"pointer",fontSize:"14px",fontWeight:"600",transition:"all 0.3s ease",position:"relative",zIndex:5},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="rgba(16, 185, 129, 0.2)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="rgba(16, 185, 129, 0.1)"},children:"\uD83D\uDCE4 공유"}),(0,i.jsx)("button",{onClick:e=>{e.stopPropagation(),e.preventDefault(),H(M.id),O(!1)},style:{padding:"10px 16px",backgroundColor:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"8px",color:"#f87171",cursor:"pointer",fontSize:"14px",fontWeight:"600",transition:"all 0.3s ease",position:"relative",zIndex:5},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="rgba(239, 68, 68, 0.2)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="rgba(239, 68, 68, 0.1)"},children:"\uD83D\uDDD1️ 삭제"})]})]})]})]})}),Y&&(0,i.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:(0,i.jsxs)("div",{style:{backgroundColor:"#1F2937",borderRadius:"12px",padding:"24px",maxWidth:"500px",width:"90%",maxHeight:"80vh",overflow:"auto"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[(0,i.jsx)("h3",{style:{margin:0,fontSize:"18px",fontWeight:"600"},children:"시음 기록을 추가할 위스키 선택"}),(0,i.jsx)("button",{onClick:()=>J(!1),style:{background:"none",border:"none",fontSize:"24px",color:"#9CA3AF",cursor:"pointer",padding:"4px"},children:"\xd7"})]}),(0,i.jsx)("div",{style:{marginBottom:"16px"},children:(0,i.jsx)("input",{type:"text",placeholder:"위스키명, 브랜드, 빈티지로 검색...",value:V,onChange:e=>K(e.target.value),style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",fontSize:"14px"},autoFocus:!0})}),(0,i.jsx)("div",{style:{display:"grid",gap:"12px"},children:Z.length>0?Z.map(e=>{var t;return(0,i.jsxs)("button",{onClick:()=>{u&&u({bottles:e}),J(!1)},style:{width:"100%",padding:"16px",backgroundColor:"#374151",border:"1px solid #4B5563",borderRadius:"8px",color:"white",textAlign:"left",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#4B5563",e.currentTarget.style.borderColor="#60A5FA"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="#374151",e.currentTarget.style.borderColor="#4B5563"},children:[(0,i.jsx)("div",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"4px"},children:e.name}),(0,i.jsxs)("div",{style:{fontSize:"14px",color:"#9CA3AF"},children:[(null==(t=e.brands)?void 0:t.name)||e.custom_brand,e.vintage&&" • ".concat(e.vintage),e.age_years&&" • ".concat(e.age_years,"년")]})]},e.id)}):(0,i.jsx)("div",{style:{textAlign:"center",padding:"40px 20px",color:"#9CA3AF",fontSize:"16px"},children:V?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{style:{fontSize:"20px",marginBottom:"8px"},children:"\uD83D\uDD0D"}),(0,i.jsx)("div",{children:"검색 결과가 없습니다."}),(0,i.jsx)("div",{style:{fontSize:"14px",marginTop:"8px"},children:"다른 검색어를 시도해보세요."})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{style:{fontSize:"20px",marginBottom:"8px"},children:"\uD83D\uDCDD"}),(0,i.jsx)("div",{children:"위스키를 검색해보세요."})]})})}),(0,i.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:"20px",gap:"12px"},children:(0,i.jsx)("button",{onClick:()=>J(!1),style:{padding:"10px 20px",backgroundColor:"#6B7280",border:"none",borderRadius:"6px",color:"white",cursor:"pointer",fontSize:"14px"},children:"취소"})})]})})]})}function z(e){let{user:t,brands:n}=e,[r,a]=(0,o.useState)(null),[s,d]=(0,o.useState)(!0),[c,p]=(0,o.useState)("all"),[x,u]=(0,o.useState)("overview"),{showToast:g}=(0,f.d)();(0,o.useEffect)(()=>{t&&h()},[t,c]);let h=async()=>{d(!0);try{let[e,n,i]=await Promise.all([l.supabase.from("bottles").select("\n          *,\n          brands (name)\n        ").eq("user_id",t.id),l.supabase.from("tastings").select("\n          *,\n          bottles (\n            name,\n            brands (name),\n            custom_brand\n          )\n        ").eq("user_id",t.id),l.supabase.from("wishlist").select("*").eq("user_id",t.id)]);if(e.error)throw e.error;if(n.error)throw n.error;if(i.error)throw i.error;let r=e.data||[],o=n.error?[]:n.data||[],s=i.data||[],d=b(r,o,s,c),p=m(d);a(p)}catch(e){g("통계 데이터를 불러오는데 실패했습니다.","error")}finally{d(!1)}},b=(e,t,n,i)=>{let r,a=new Date;switch(i){case"1month":r=new Date(a.getTime()-2592e6);break;case"3months":r=new Date(a.getTime()-7776e6);break;case"6months":r=new Date(a.getTime()-15552e6);break;case"1year":r=new Date(a.getTime()-31536e6);break;default:return{bottles:e,tastings:t,wishlist:n}}let o=e.filter(e=>new Date(e.created_at)>=r);return{bottles:o,tastings:t.filter(e=>new Date(e.tasting_date)>=r),wishlist:n.filter(e=>new Date(e.created_at)>=r)}},m=e=>{let{bottles:t,tastings:n,wishlist:i}=e,r=t.length,a=n.length,o=i.length,l=n.filter(e=>e.overall_rating).map(e=>e.overall_rating),s=l.length>0?l.reduce((e,t)=>e+t,0)/l.length:0,d=t.filter(e=>e.purchase_price).reduce((e,t)=>e+(t.purchase_price||0),0),c=Object.entries(t.reduce((e,t)=>{var n;let i="기타";return(null==(n=t.brands)?void 0:n.name)?i=t.brands.name:t.custom_brand&&t.custom_brand.trim()&&(i=t.custom_brand.trim()),e[i]||(e[i]={count:0,totalValue:0}),e[i].count++,e[i].totalValue+=t.purchase_price||0,e},{})).map(e=>{let[t,n]=e;return{name:t,count:n.count,totalValue:n.totalValue}}).sort((e,t)=>t.count-e.count).slice(0,5),p=n.filter(e=>{var t;return e.overall_rating&&(null==(t=e.bottles)?void 0:t.name)}).map(e=>{var t;let n="기타";return(null==(t=e.bottles.brands)?void 0:t.name)?n=e.bottles.brands.name:e.bottles.custom_brand&&e.bottles.custom_brand.trim()&&(n=e.bottles.custom_brand.trim()),{name:e.bottles.name,rating:e.overall_rating,brand:n}}).sort((e,t)=>t.rating-e.rating).slice(0,5),x=n.filter(e=>e.tasting_date).map(e=>{var t;return{name:(null==(t=e.bottles)?void 0:t.name)||e.bottle_name||"Unknown",date:e.tasting_date,rating:e.overall_rating||0}}).sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()).slice(0,5),u=[{min:0,max:5e4,label:"5만원 이하"},{min:5e4,max:1e5,label:"5-10만원"},{min:1e5,max:2e5,label:"10-20만원"},{min:2e5,max:5e5,label:"20-50만원"},{min:5e5,max:1/0,label:"50만원 이상"}].map(e=>({range:e.label,count:t.filter(t=>t.purchase_price&&t.purchase_price>=e.min&&t.purchase_price<e.max).length})),g=y(n),h=v(t),b=j(t);return{totalBottles:r,totalTastings:a,totalWishlist:o,averageRating:Math.round(10*s)/10,totalValue:d,topBrands:c,topRatedBottles:p,recentTastings:x,priceDistribution:u,monthlyConsumption:g,regionStats:h,ageDistribution:b,abvDistribution:_(t),vintageAnalysis:w(t)}},y=e=>{let t={};return e.forEach(e=>{if(e.tasting_date&&e.consumed_volume_ml){let n=new Date(e.tasting_date),i="".concat(n.getFullYear(),"-").concat(String(n.getMonth()+1).padStart(2,"0"));t[i]=(t[i]||0)+e.consumed_volume_ml}}),Object.entries(t).map(e=>{let[t,n]=e;return{month:t,volume:n}}).sort((e,t)=>e.month.localeCompare(t.month)).slice(-6)},v=e=>{let t={};return e.forEach(e=>{var n;let i=(null==(n=e.brands)?void 0:n.country)||"Unknown";t[i]||(t[i]={count:0,ratings:[]}),t[i].count++}),Object.entries(t).map(e=>{let[t,n]=e;return{region:t,count:n.count,avgRating:n.ratings.length>0?n.ratings.reduce((e,t)=>e+t,0)/n.ratings.length:0}}).sort((e,t)=>t.count-e.count)},j=e=>[{min:0,max:3,label:"3년 이하"},{min:3,max:5,label:"3-5년"},{min:5,max:10,label:"5-10년"},{min:10,max:15,label:"10-15년"},{min:15,max:1/0,label:"15년 이상"}].map(t=>({age:t.label,count:e.filter(e=>e.age_years&&e.age_years>=t.min&&e.age_years<t.max).length})),_=e=>[{min:0,max:40,label:"40% 이하"},{min:40,max:43,label:"40-43%"},{min:43,max:46,label:"43-46%"},{min:46,max:50,label:"46-50%"},{min:50,max:1/0,label:"50% 이상"}].map(t=>({abv:t.label,count:e.filter(e=>e.abv&&e.abv>=t.min&&e.abv<t.max).length})),w=e=>{let t={};return e.forEach(e=>{if(e.vintage){let n=e.vintage.toString();t[n]||(t[n]={count:0,totalPrice:0}),t[n].count++,t[n].totalPrice+=e.purchase_price||0}}),Object.entries(t).map(e=>{let[t,n]=e;return{year:t,count:n.count,avgPrice:n.totalPrice/n.count}}).sort((e,t)=>parseInt(t.year)-parseInt(e.year)).slice(0,10)},C=e=>new Intl.NumberFormat("ko-KR").format(e);return s?(0,i.jsxs)("div",{style:{padding:"20px",textAlign:"center",color:"#9CA3AF"},children:[(0,i.jsx)("div",{style:{fontSize:"24px",marginBottom:"12px"},children:"\uD83D\uDCCA"}),"통계를 계산하고 있습니다..."]}):r?(0,i.jsxs)("div",{style:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px",flexWrap:"wrap",gap:"16px"},children:[(0,i.jsx)("h2",{style:{margin:0,fontSize:"24px",fontWeight:"600"},children:"\uD83D\uDCCA 고급 통계 및 분석"}),(0,i.jsx)("div",{style:{display:"flex",gap:"8px"},children:[{value:"all",label:"전체"},{value:"1month",label:"1개월"},{value:"3months",label:"3개월"},{value:"6months",label:"6개월"},{value:"1year",label:"1년"}].map(e=>(0,i.jsx)("button",{onClick:()=>p(e.value),style:{padding:"8px 12px",backgroundColor:c===e.value?"#3B82F6":"#374151",color:"white",border:"none",borderRadius:"6px",fontSize:"14px",cursor:"pointer",transition:"all 0.2s ease"},children:e.label},e.value))})]}),(0,i.jsx)("div",{style:{display:"flex",gap:"8px",marginBottom:"24px"},children:[{value:"overview",label:"개요",icon:"\uD83D\uDCC8"},{value:"trends",label:"트렌드",icon:"\uD83D\uDCCA"},{value:"insights",label:"인사이트",icon:"\uD83D\uDCA1"}].map(e=>(0,i.jsxs)("button",{onClick:()=>u(e.value),style:{padding:"12px 16px",backgroundColor:x===e.value?"#10B981":"#374151",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"8px"},children:[(0,i.jsx)("span",{children:e.icon}),e.label]},e.value))}),"overview"===x&&(0,i.jsxs)("div",{style:{display:"grid",gap:"24px"},children:[(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:[(0,i.jsxs)("div",{style:{backgroundColor:"#374151",padding:"20px",borderRadius:"12px",textAlign:"center"},children:[(0,i.jsx)("div",{style:{fontSize:"32px",marginBottom:"8px"},children:"\uD83E\uDD43"}),(0,i.jsx)("div",{style:{fontSize:"24px",fontWeight:"600",marginBottom:"4px"},children:r.totalBottles}),(0,i.jsx)("div",{style:{color:"#9CA3AF",fontSize:"14px"},children:"총 보틀"})]}),(0,i.jsxs)("div",{style:{backgroundColor:"#374151",padding:"20px",borderRadius:"12px",textAlign:"center"},children:[(0,i.jsx)("div",{style:{fontSize:"32px",marginBottom:"8px"},children:"\uD83C\uDF77"}),(0,i.jsx)("div",{style:{fontSize:"24px",fontWeight:"600",marginBottom:"4px"},children:r.totalTastings}),(0,i.jsx)("div",{style:{color:"#9CA3AF",fontSize:"14px"},children:"총 시음"})]}),(0,i.jsxs)("div",{style:{backgroundColor:"#374151",padding:"20px",borderRadius:"12px",textAlign:"center"},children:[(0,i.jsx)("div",{style:{fontSize:"32px",marginBottom:"8px"},children:"⭐"}),(0,i.jsx)("div",{style:{fontSize:"24px",fontWeight:"600",marginBottom:"4px"},children:r.averageRating}),(0,i.jsx)("div",{style:{color:"#9CA3AF",fontSize:"14px"},children:"평균 평점"})]}),(0,i.jsxs)("div",{style:{backgroundColor:"#374151",padding:"20px",borderRadius:"12px",textAlign:"center"},children:[(0,i.jsx)("div",{style:{fontSize:"32px",marginBottom:"8px"},children:"\uD83D\uDCB0"}),(0,i.jsx)("div",{style:{fontSize:"24px",fontWeight:"600",marginBottom:"4px"},children:C(r.totalValue)}),(0,i.jsx)("div",{style:{color:"#9CA3AF",fontSize:"14px"},children:"총 가치"})]})]}),(0,i.jsxs)("div",{style:{backgroundColor:"#374151",padding:"20px",borderRadius:"12px"},children:[(0,i.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:"600"},children:"\uD83C\uDFC6 상위 브랜드"}),(0,i.jsx)("div",{style:{display:"grid",gap:"12px"},children:r.topBrands.map((e,t)=>(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px",backgroundColor:"#1F2937",borderRadius:"8px"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,i.jsx)("div",{style:{width:"24px",height:"24px",backgroundColor:t<3?"#F59E0B":"#6B7280",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",fontWeight:"600",color:"white"},children:t+1}),(0,i.jsx)("span",{style:{fontWeight:"500"},children:e.name})]}),(0,i.jsxs)("div",{style:{textAlign:"right"},children:[(0,i.jsxs)("div",{style:{fontSize:"16px",fontWeight:"600"},children:[e.count,"개"]}),(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF"},children:C(e.totalValue)})]})]},e.name))})]}),(0,i.jsxs)("div",{style:{backgroundColor:"#374151",padding:"20px",borderRadius:"12px"},children:[(0,i.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:"600"},children:"⭐ 상위 평점 보틀"}),(0,i.jsx)("div",{style:{display:"grid",gap:"12px"},children:r.topRatedBottles.map((e,t)=>(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px",backgroundColor:"#1F2937",borderRadius:"8px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontWeight:"500",marginBottom:"4px"},children:e.name}),(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF"},children:e.brand})]}),(0,i.jsxs)("div",{style:{backgroundColor:"#10B981",color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"14px",fontWeight:"600"},children:[e.rating,"점"]})]},e.name))})]})]}),"trends"===x&&(0,i.jsxs)("div",{style:{display:"grid",gap:"24px"},children:[(0,i.jsxs)("div",{style:{backgroundColor:"#374151",padding:"20px",borderRadius:"12px"},children:[(0,i.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:"600"},children:"\uD83D\uDCC8 월별 소비량"}),(0,i.jsx)("div",{style:{display:"grid",gap:"12px"},children:r.monthlyConsumption.map(e=>(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px",backgroundColor:"#1F2937",borderRadius:"8px"},children:[(0,i.jsx)("span",{children:e.month}),(0,i.jsxs)("span",{style:{fontWeight:"600"},children:[e.volume,"ml"]})]},e.month))})]}),(0,i.jsxs)("div",{style:{backgroundColor:"#374151",padding:"20px",borderRadius:"12px"},children:[(0,i.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:"600"},children:"\uD83D\uDCB0 가격 분포"}),(0,i.jsx)("div",{style:{display:"grid",gap:"12px"},children:r.priceDistribution.map(e=>(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px",backgroundColor:"#1F2937",borderRadius:"8px"},children:[(0,i.jsx)("span",{children:e.range}),(0,i.jsxs)("span",{style:{fontWeight:"600"},children:[e.count,"개"]})]},e.range))})]}),(0,i.jsxs)("div",{style:{backgroundColor:"#374151",padding:"20px",borderRadius:"12px"},children:[(0,i.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:"600"},children:"\uD83D\uDD70️ 연령 분포"}),(0,i.jsx)("div",{style:{display:"grid",gap:"12px"},children:r.ageDistribution.map(e=>(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px",backgroundColor:"#1F2937",borderRadius:"8px"},children:[(0,i.jsx)("span",{children:e.age}),(0,i.jsxs)("span",{style:{fontWeight:"600"},children:[e.count,"개"]})]},e.age))})]})]}),"insights"===x&&(0,i.jsxs)("div",{style:{display:"grid",gap:"24px"},children:[(0,i.jsxs)("div",{style:{backgroundColor:"#374151",padding:"20px",borderRadius:"12px"},children:[(0,i.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:"600"},children:"\uD83C\uDF0D 지역별 통계"}),(0,i.jsx)("div",{style:{display:"grid",gap:"12px"},children:r.regionStats.map(e=>(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px",backgroundColor:"#1F2937",borderRadius:"8px"},children:[(0,i.jsx)("span",{children:e.region}),(0,i.jsxs)("div",{style:{textAlign:"right"},children:[(0,i.jsxs)("div",{style:{fontWeight:"600"},children:[e.count,"개"]}),e.avgRating>0&&(0,i.jsxs)("div",{style:{fontSize:"12px",color:"#9CA3AF"},children:["평균 ",e.avgRating.toFixed(1),"점"]})]})]},e.region))})]}),(0,i.jsxs)("div",{style:{backgroundColor:"#374151",padding:"20px",borderRadius:"12px"},children:[(0,i.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:"600"},children:"\uD83C\uDF76 도수 분포"}),(0,i.jsx)("div",{style:{display:"grid",gap:"12px"},children:r.abvDistribution.map(e=>(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px",backgroundColor:"#1F2937",borderRadius:"8px"},children:[(0,i.jsx)("span",{children:e.abv}),(0,i.jsxs)("span",{style:{fontWeight:"600"},children:[e.count,"개"]})]},e.abv))})]}),(0,i.jsxs)("div",{style:{backgroundColor:"#374151",padding:"20px",borderRadius:"12px"},children:[(0,i.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:"600"},children:"\uD83C\uDF47 빈티지 분석"}),(0,i.jsx)("div",{style:{display:"grid",gap:"12px"},children:r.vintageAnalysis.map(e=>(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px",backgroundColor:"#1F2937",borderRadius:"8px"},children:[(0,i.jsxs)("span",{children:[e.year,"년"]}),(0,i.jsxs)("div",{style:{textAlign:"right"},children:[(0,i.jsxs)("div",{style:{fontWeight:"600"},children:[e.count,"개"]}),(0,i.jsxs)("div",{style:{fontSize:"12px",color:"#9CA3AF"},children:["평균 ",C(e.avgPrice)]})]})]},e.year))})]})]})]}):(0,i.jsx)("div",{style:{padding:"20px",textAlign:"center",color:"#9CA3AF"},children:"데이터가 없습니다."})}function F(e){let{user:t,brands:n}=e,[r,a]=(0,o.useState)(null),[s,d]=(0,o.useState)(!0),{showToast:c}=(0,f.d)();(0,o.useEffect)(()=>{t&&p()},[t]);let p=async()=>{d(!0);try{let[e,n]=await Promise.all([l.supabase.from("bottles").select("\n          *,\n          brands (name, region)\n        ").eq("user_id",t.id),l.supabase.from("tastings").select("\n          *,\n          bottles (\n            name,\n            brands (name, region),\n            custom_brand\n          )\n        ").eq("user_id",t.id)]);if(e.error)throw e.error;if(n.error)throw n.error;let i=e.data||[],r=n.data||[],o=x(i,r);a(o)}catch(e){c("취향 분석 데이터를 불러오는데 실패했습니다.","error")}finally{d(!1)}},x=(e,t)=>{var n;let i=e.reduce((e,t)=>{var n;let i=(null==(n=t.brands)?void 0:n.name)||t.custom_brand||"기타";return e[i]||(e[i]={count:0,totalRating:0,ratingCount:0}),e[i].count++,e},{});t.forEach(e=>{var t,n;if(e.overall_rating&&(null==(n=e.bottles)||null==(t=n.brands)?void 0:t.name)){let t=e.bottles.brands.name;i[t]&&(i[t].totalRating+=e.overall_rating,i[t].ratingCount++)}});let r=Object.entries(i).map(e=>{let[t,n]=e;return{name:t,count:n.count,avgRating:n.ratingCount>0?n.totalRating/n.ratingCount:0}}).sort((e,t)=>t.count-e.count).slice(0,5),a=e.reduce((e,t)=>{var n;let i=(null==(n=t.brands)?void 0:n.region)||"기타";return e[i]||(e[i]={count:0,totalRating:0,ratingCount:0}),e[i].count++,e},{});t.forEach(e=>{var t,n;if(e.overall_rating&&(null==(n=e.bottles)||null==(t=n.brands)?void 0:t.region)){let t=e.bottles.brands.region;a[t]&&(a[t].totalRating+=e.overall_rating,a[t].ratingCount++)}});let o=Object.entries(a).map(e=>{let[t,n]=e;return{region:t,count:n.count,avgRating:n.ratingCount>0?n.totalRating/n.ratingCount:0}}).sort((e,t)=>t.count-e.count).slice(0,5),l=e.filter(e=>e.purchase_price).map(e=>e.purchase_price),s={min:Math.min(...l),max:Math.max(...l),average:l.reduce((e,t)=>e+t,0)/l.length,range:u(l.reduce((e,t)=>e+t,0)/l.length)},d=e.filter(e=>e.age_years).map(e=>e.age_years),c={min:Math.min(...d),max:Math.max(...d),average:d.reduce((e,t)=>e+t,0)/d.length,range:g(d.reduce((e,t)=>e+t,0)/d.length)},p=e.filter(e=>e.abv).map(e=>e.abv),x={min:Math.min(...p),max:Math.max(...p),average:p.reduce((e,t)=>e+t,0)/p.length,range:h(p.reduce((e,t)=>e+t,0)/p.length)},f=t.filter(e=>e.nose_notes||e.palate_notes||e.finish_notes).flatMap(e=>{var t,n,i;return[...(null==(t=e.nose_notes)?void 0:t.split(",").map(e=>e.trim()))||[],...(null==(n=e.palate_notes)?void 0:n.split(",").map(e=>e.trim()))||[],...(null==(i=e.finish_notes)?void 0:i.split(",").map(e=>e.trim()))||[]]}),v=Object.entries(f.reduce((e,t)=>(e[t]=(e[t]||0)+1,e),{})).map(e=>{let[t,n]=e;return{note:t,frequency:n}}).sort((e,t)=>t.frequency-e.frequency).slice(0,10),j=t.length/Math.max(1,(new Date().getTime()-new Date((null==(n=e[0])?void 0:n.created_at)||Date.now()).getTime())/2592e6),_={monthly:Math.round(10*j)/10,weekly:Math.round(j/4*10)/10,preferredTime:b(t)},w={smoky:m(f,["스모키","피트","타르","불"]),sweet:m(f,["달콤","바닐라","꿀","캐러멜"]),spicy:m(f,["스파이시","후추","계피","정향"]),fruity:m(f,["과일","사과","오렌지","베리"])},C=y(r,o,w,s);return{favoriteBrands:r,favoriteRegions:o,pricePreference:s,agePreference:c,abvPreference:x,tastingNotes:v,consumptionPattern:_,stylePreference:w,overallTaste:C}},u=e=>e<5e4?"저가형 (5만원 미만)":e<1e5?"중저가형 (5-10만원)":e<2e5?"중가형 (10-20만원)":e<5e5?"중고가형 (20-50만원)":"고가형 (50만원 이상)",g=e=>e<5?"젊은 위스키 (5년 미만)":e<12?"표준 위스키 (5-12년)":e<18?"숙성 위스키 (12-18년)":"고급 위스키 (18년 이상)",h=e=>e<40?"저도수 (40% 미만)":e<46?"표준도수 (40-46%)":e<50?"고도수 (46-50%)":"캐스크 스트렝스 (50% 이상)",b=e=>{let t=e.filter(e=>e.tasting_time).map(e=>new Date("2000-01-01T".concat(e.tasting_time)).getHours());if(0===t.length)return"정보 없음";let n=t.reduce((e,t)=>e+t,0)/t.length;return n<12?"오전":n<18?"오후":"저녁"},m=(e,t)=>e.filter(e=>t.some(t=>e.toLowerCase().includes(t.toLowerCase()))).length,y=(e,t,n,i)=>{var r,a;let o=(null==(r=e[0])?void 0:r.name)||"다양한",l=(null==(a=t[0])?void 0:a.region)||"다양한",s=i.range.split(" ")[0],d="",c=Math.max(n.smoky,n.sweet,n.spicy,n.fruity);return d=n.smoky===c?"스모키한":n.sweet===c?"달콤한":n.spicy===c?"스파이시한":n.fruity===c?"과일향이 나는":"균형잡힌","".concat(l," 지역의 ").concat(d," ").concat(s," 위스키를 선호하는 ").concat(o," 브랜드 애호가입니다.")},v=e=>new Intl.NumberFormat("ko-KR").format(e);return s?(0,i.jsxs)("div",{style:{padding:"20px",textAlign:"center",color:"#9CA3AF"},children:[(0,i.jsx)("div",{style:{fontSize:"24px",marginBottom:"12px"},children:"\uD83C\uDFAF"}),"취향을 분석하고 있습니다..."]}):r?(0,i.jsxs)("div",{style:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},children:[(0,i.jsx)("h1",{style:{fontSize:"28px",fontWeight:"700",color:"white",marginBottom:"30px",textAlign:"center"},children:"\uD83C\uDFAF 나의 위스키 취향 분석"}),(0,i.jsxs)("div",{style:{backgroundColor:"#1F2937",borderRadius:"16px",padding:"24px",marginBottom:"24px",border:"1px solid #374151"},children:[(0,i.jsx)("h2",{style:{fontSize:"20px",fontWeight:"600",color:"white",marginBottom:"16px"},children:"\uD83D\uDCDD 취향 요약"}),(0,i.jsx)("p",{style:{fontSize:"16px",color:"#D1D5DB",lineHeight:"1.6"},children:r.overallTaste})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(400px, 1fr))",gap:"24px"},children:[(0,i.jsxs)("div",{style:{backgroundColor:"#1F2937",borderRadius:"16px",padding:"24px",border:"1px solid #374151"},children:[(0,i.jsx)("h3",{style:{fontSize:"18px",fontWeight:"600",color:"white",marginBottom:"16px"},children:"\uD83C\uDFF7️ 선호 브랜드"}),(0,i.jsx)("div",{style:{display:"grid",gap:"12px"},children:r.favoriteBrands.map((e,t)=>(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px",backgroundColor:"#374151",borderRadius:"8px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{style:{color:"white",fontWeight:"500"},children:[t+1,". ",e.name]}),(0,i.jsxs)("div",{style:{color:"#9CA3AF",fontSize:"14px"},children:[e.count,"개 보유"]})]}),(0,i.jsx)("div",{style:{color:"#F59E0B",fontWeight:"600"},children:e.avgRating>0?"".concat(e.avgRating.toFixed(1),"/10"):"평점 없음"})]},e.name))})]}),(0,i.jsxs)("div",{style:{backgroundColor:"#1F2937",borderRadius:"16px",padding:"24px",border:"1px solid #374151"},children:[(0,i.jsx)("h3",{style:{fontSize:"18px",fontWeight:"600",color:"white",marginBottom:"16px"},children:"\uD83C\uDF0D 선호 지역"}),(0,i.jsx)("div",{style:{display:"grid",gap:"12px"},children:r.favoriteRegions.map((e,t)=>(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px",backgroundColor:"#374151",borderRadius:"8px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{style:{color:"white",fontWeight:"500"},children:[t+1,". ",e.region]}),(0,i.jsxs)("div",{style:{color:"#9CA3AF",fontSize:"14px"},children:[e.count,"개 보유"]})]}),(0,i.jsx)("div",{style:{color:"#F59E0B",fontWeight:"600"},children:e.avgRating>0?"".concat(e.avgRating.toFixed(1),"/10"):"평점 없음"})]},e.region))})]}),(0,i.jsxs)("div",{style:{backgroundColor:"#1F2937",borderRadius:"16px",padding:"24px",border:"1px solid #374151"},children:[(0,i.jsx)("h3",{style:{fontSize:"18px",fontWeight:"600",color:"white",marginBottom:"16px"},children:"\uD83D\uDCB0 가격 선호도"}),(0,i.jsxs)("div",{style:{display:"grid",gap:"8px"},children:[(0,i.jsxs)("div",{style:{color:"#D1D5DB"},children:[(0,i.jsx)("strong",{children:"평균 가격:"})," ",v(r.pricePreference.average),"원"]}),(0,i.jsxs)("div",{style:{color:"#D1D5DB"},children:[(0,i.jsx)("strong",{children:"가격 범위:"})," ",v(r.pricePreference.min),"원 - ",v(r.pricePreference.max),"원"]}),(0,i.jsx)("div",{style:{color:"#10B981",fontWeight:"600"},children:r.pricePreference.range})]})]}),(0,i.jsxs)("div",{style:{backgroundColor:"#1F2937",borderRadius:"16px",padding:"24px",border:"1px solid #374151"},children:[(0,i.jsx)("h3",{style:{fontSize:"18px",fontWeight:"600",color:"white",marginBottom:"16px"},children:"\uD83D\uDD70️ 숙성 연도 선호도"}),(0,i.jsxs)("div",{style:{display:"grid",gap:"8px"},children:[(0,i.jsxs)("div",{style:{color:"#D1D5DB"},children:[(0,i.jsx)("strong",{children:"평균 숙성:"})," ",r.agePreference.average.toFixed(1),"년"]}),(0,i.jsxs)("div",{style:{color:"#D1D5DB"},children:[(0,i.jsx)("strong",{children:"숙성 범위:"})," ",r.agePreference.min,"년 - ",r.agePreference.max,"년"]}),(0,i.jsx)("div",{style:{color:"#10B981",fontWeight:"600"},children:r.agePreference.range})]})]}),(0,i.jsxs)("div",{style:{backgroundColor:"#1F2937",borderRadius:"16px",padding:"24px",border:"1px solid #374151"},children:[(0,i.jsx)("h3",{style:{fontSize:"18px",fontWeight:"600",color:"white",marginBottom:"16px"},children:"\uD83C\uDFA8 스타일 선호도"}),(0,i.jsxs)("div",{style:{display:"grid",gap:"12px"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsx)("span",{style:{color:"#D1D5DB"},children:"스모키"}),(0,i.jsx)("div",{style:{display:"flex",gap:"4px"},children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,i.jsx)("div",{style:{width:"12px",height:"12px",borderRadius:"50%",backgroundColor:t<r.stylePreference.smoky?"#F59E0B":"#374151"}},t))})]}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsx)("span",{style:{color:"#D1D5DB"},children:"달콤"}),(0,i.jsx)("div",{style:{display:"flex",gap:"4px"},children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,i.jsx)("div",{style:{width:"12px",height:"12px",borderRadius:"50%",backgroundColor:t<r.stylePreference.sweet?"#F59E0B":"#374151"}},t))})]}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsx)("span",{style:{color:"#D1D5DB"},children:"스파이시"}),(0,i.jsx)("div",{style:{display:"flex",gap:"4px"},children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,i.jsx)("div",{style:{width:"12px",height:"12px",borderRadius:"50%",backgroundColor:t<r.stylePreference.spicy?"#F59E0B":"#374151"}},t))})]}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsx)("span",{style:{color:"#D1D5DB"},children:"과일향"}),(0,i.jsx)("div",{style:{display:"flex",gap:"4px"},children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,i.jsx)("div",{style:{width:"12px",height:"12px",borderRadius:"50%",backgroundColor:t<r.stylePreference.fruity?"#F59E0B":"#374151"}},t))})]})]})]}),(0,i.jsxs)("div",{style:{backgroundColor:"#1F2937",borderRadius:"16px",padding:"24px",border:"1px solid #374151"},children:[(0,i.jsx)("h3",{style:{fontSize:"18px",fontWeight:"600",color:"white",marginBottom:"16px"},children:"\uD83D\uDCCA 소비 패턴"}),(0,i.jsxs)("div",{style:{display:"grid",gap:"8px"},children:[(0,i.jsxs)("div",{style:{color:"#D1D5DB"},children:[(0,i.jsx)("strong",{children:"월 평균 시음:"})," ",r.consumptionPattern.monthly,"회"]}),(0,i.jsxs)("div",{style:{color:"#D1D5DB"},children:[(0,i.jsx)("strong",{children:"주 평균 시음:"})," ",r.consumptionPattern.weekly,"회"]}),(0,i.jsxs)("div",{style:{color:"#D1D5DB"},children:[(0,i.jsx)("strong",{children:"선호 시간대:"})," ",r.consumptionPattern.preferredTime]})]})]})]}),(0,i.jsxs)("div",{style:{backgroundColor:"#1F2937",borderRadius:"16px",padding:"24px",marginTop:"24px",border:"1px solid #374151"},children:[(0,i.jsx)("h3",{style:{fontSize:"18px",fontWeight:"600",color:"white",marginBottom:"16px"},children:"\uD83D\uDCDD 자주 사용하는 시음 노트"}),(0,i.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:r.tastingNotes.map((e,t)=>(0,i.jsxs)("span",{style:{padding:"6px 12px",backgroundColor:"#374151",borderRadius:"20px",color:"white",fontSize:"14px",border:t<3?"1px solid #F59E0B":"none"},children:[e.note," (",e.frequency,"회)"]},e.note))})]})]}):(0,i.jsx)("div",{style:{padding:"20px",textAlign:"center",color:"#9CA3AF"},children:"취향 분석 데이터가 없습니다."})}function R(e){let{user:t,brands:n}=e,[r,a]=(0,o.useState)([]),[s,d]=(0,o.useState)(!0),{showToast:c}=(0,f.d)();(0,o.useEffect)(()=>{t&&p()},[t]);let p=async()=>{try{d(!0);let{data:e}=await l.supabase.from("bottles").select("*").eq("user_id",t.id),{data:i}=await l.supabase.from("tastings").select("*").eq("user_id",t.id),r=n||[],{data:o}=await l.supabase.from("brands").select("*"),s=r.length>0?r:o||[];if(e&&i){let t=x(e,i,s);a(t)}}catch(e){c("추천을 생성하는 중 오류가 발생했습니다.","error")}finally{d(!1)}},x=(e,t,n)=>{let i=[];return Object.entries(t.reduce((e,t)=>(t.rating&&t.bottle_brand&&(e[t.bottle_brand]||(e[t.bottle_brand]={total:0,count:0}),e[t.bottle_brand].total+=t.rating,e[t.bottle_brand].count+=1),e),{})).map(e=>{let[t,n]=e;return{brand:t,avgRating:n.total/n.count}}).sort((e,t)=>t.avgRating-e.avgRating).slice(0,3).forEach(t=>{let{brand:n}=t;u(n).forEach(t=>{e.some(e=>e.name===t.name)||i.push({id:"brand-".concat(t.name),name:t.name,brand:t.brand,reason:"좋아하는 브랜드 ".concat(n,"의 인기 위스키"),confidence:85,price:t.price})})}),h(g(e)).forEach(e=>{i.some(t=>t.name===e.name)||i.push({id:"price-".concat(e.name),name:e.name,brand:e.brand,reason:"선호하는 가격대의 인기 위스키",confidence:75,price:e.price})}),m(b(e)).forEach(e=>{i.some(t=>t.name===e.name)||i.push({id:"age-".concat(e.name),name:e.name,brand:e.brand,reason:"선호하는 숙성연수의 위스키",confidence:70,price:e.price})}),v(y(e,n)).forEach(e=>{i.some(t=>t.name===e.name)||i.push({id:"region-".concat(e.name),name:e.name,brand:e.brand,reason:"선호하는 지역의 위스키",confidence:65,price:e.price})}),i.filter((e,t,n)=>t===n.findIndex(t=>t.name===e.name)).sort((e,t)=>t.confidence-e.confidence).slice(0,10)},u=e=>({Macallan:[{name:"The Macallan 12 Double Cask",brand:"Macallan",price:18e4},{name:"The Macallan 18 Sherry Oak",brand:"Macallan",price:85e4},{name:"The Macallan Fine Oak 15",brand:"Macallan",price:32e4}],Glenfiddich:[{name:"Glenfiddich 12",brand:"Glenfiddich",price:65e3},{name:"Glenfiddich 15 Solera",brand:"Glenfiddich",price:12e4},{name:"Glenfiddich 18",brand:"Glenfiddich",price:28e4}],Glenlivet:[{name:"The Glenlivet 12",brand:"Glenlivet",price:55e3},{name:"The Glenlivet 15",brand:"Glenlivet",price:95e3},{name:"The Glenlivet 18",brand:"Glenlivet",price:22e4}]})[e]||[],g=e=>{let t=e.map(e=>e.purchase_price||e.retail_price).filter(e=>e>0);if(0===t.length)return"medium";let n=t.reduce((e,t)=>e+t,0)/t.length;return n<8e4?"low":n<2e5?"medium":"high"},h=e=>({low:[{name:"Glenfiddich 12",brand:"Glenfiddich",price:65e3},{name:"The Glenlivet 12",brand:"Glenlivet",price:55e3},{name:"Jameson Irish Whiskey",brand:"Jameson",price:45e3}],medium:[{name:"Glenfiddich 15 Solera",brand:"Glenfiddich",price:12e4},{name:"The Glenlivet 15",brand:"Glenlivet",price:95e3},{name:"The Macallan 12 Double Cask",brand:"Macallan",price:18e4}],high:[{name:"The Macallan 18 Sherry Oak",brand:"Macallan",price:85e4},{name:"Glenfiddich 21",brand:"Glenfiddich",price:65e4},{name:"The Glenlivet 25",brand:"Glenlivet",price:12e5}]})[e]||[],b=e=>{let t=e.map(e=>e.age_years).filter(e=>e>0);if(0===t.length)return"medium";let n=t.reduce((e,t)=>e+t,0)/t.length;return n<12?"young":n<18?"medium":"old"},m=e=>({young:[{name:"Glenfiddich 12",brand:"Glenfiddich",price:65e3},{name:"The Glenlivet 12",brand:"Glenlivet",price:55e3},{name:"Jameson Irish Whiskey",brand:"Jameson",price:45e3}],medium:[{name:"Glenfiddich 15 Solera",brand:"Glenfiddich",price:12e4},{name:"The Glenlivet 15",brand:"Glenlivet",price:95e3},{name:"The Macallan 12 Double Cask",brand:"Macallan",price:18e4}],old:[{name:"The Macallan 18 Sherry Oak",brand:"Macallan",price:85e4},{name:"Glenfiddich 21",brand:"Glenfiddich",price:65e4},{name:"The Glenlivet 25",brand:"Glenlivet",price:12e5}]})[e]||[],y=(e,t)=>"scotch",v=e=>({scotch:[{name:"Glenfiddich 12",brand:"Glenfiddich",price:65e3},{name:"The Glenlivet 12",brand:"Glenlivet",price:55e3},{name:"The Macallan 12 Double Cask",brand:"Macallan",price:18e4}]})[e]||[];return s?(0,i.jsx)("div",{style:{padding:"20px"},children:(0,i.jsx)("div",{style:{textAlign:"center",color:"#9CA3AF"},children:"추천을 분석하는 중..."})}):(0,i.jsxs)("div",{style:{padding:"20px"},children:[(0,i.jsx)("h2",{style:{marginBottom:"24px",fontSize:"24px",fontWeight:"700"},children:"\uD83C\uDFAF 맞춤 추천"}),0===r.length?(0,i.jsxs)("div",{style:{textAlign:"center",padding:"40px",color:"#9CA3AF",backgroundColor:"#1F2937",borderRadius:"12px",border:"1px solid #374151"},children:[(0,i.jsx)("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"\uD83E\uDD14"}),(0,i.jsx)("div",{style:{fontSize:"16px",marginBottom:"8px"},children:"아직 충분한 데이터가 없습니다"}),(0,i.jsx)("div",{style:{fontSize:"14px",color:"#6B7280"},children:"더 많은 위스키를 추가하고 시음 기록을 남겨보세요!"})]}):(0,i.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"20px"},children:r.map(e=>{let t;return(0,i.jsxs)("div",{style:{backgroundColor:"#1F2937",borderRadius:"12px",padding:"20px",border:"1px solid #374151",transition:"all 0.3s ease"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"12px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{style:{fontSize:"18px",fontWeight:"600",color:"white",marginBottom:"4px"},children:e.name}),(0,i.jsx)("p",{style:{fontSize:"14px",color:"#9CA3AF",marginBottom:"8px"},children:e.brand})]}),(0,i.jsxs)("div",{style:{backgroundColor:"rgba(".concat(e.confidence>80?"16, 185, 129":e.confidence>60?"245, 158, 11":"239, 68, 68",", 0.2)"),color:e.confidence>80?"#10B981":e.confidence>60?"#F59E0B":"#EF4444",padding:"4px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:[e.confidence,"% 일치"]})]}),(0,i.jsx)("p",{style:{fontSize:"14px",color:"#D1D5DB",marginBottom:"12px",lineHeight:"1.5"},children:e.reason}),e.price&&(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsxs)("span",{style:{fontSize:"16px",fontWeight:"600",color:"#F59E0B"},children:[(t=e.price,new Intl.NumberFormat("ko-KR").format(t)),"원"]}),(0,i.jsx)("button",{style:{padding:"8px 16px",backgroundColor:"#3B82F6",border:"none",borderRadius:"6px",color:"white",fontSize:"14px",cursor:"pointer",transition:"background-color 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#2563EB"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="#3B82F6"},children:"위시리스트 추가"})]})]},e.id)})})]})}let A={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"var(--color-bg-overlay)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"var(--spacing-md)"},container:{backgroundColor:"var(--color-bg-primary)",border:"1px solid var(--color-border-primary)",borderRadius:"var(--radius-md)",width:"95%",maxWidth:"600px",maxHeight:"90vh",overflow:"hidden",display:"flex",flexDirection:"column",boxShadow:"0 20px 25px -5px var(--color-shadow-heavy)"},header:{padding:"var(--spacing-lg) var(--spacing-xl) var(--spacing-md) var(--spacing-xl)",borderBottom:"1px solid var(--color-border-primary)",backgroundColor:"var(--color-bg-primary)",display:"flex",justifyContent:"space-between",alignItems:"center"},title:{fontSize:"18px",fontWeight:"600",color:"var(--color-text-primary)",margin:0},closeButton:{width:"32px",height:"32px",backgroundColor:"var(--color-danger)",border:"none",borderRadius:"var(--radius-sm)",color:"var(--color-text-primary)",cursor:"pointer",fontSize:"16px",fontWeight:"600",display:"flex",alignItems:"center",justifyContent:"center",transition:"var(--transition-normal)",opacity:.8},content:{flex:1,overflowY:"auto",padding:"var(--spacing-xl)",backgroundColor:"var(--color-bg-primary)"},footer:{padding:"var(--spacing-md) var(--spacing-xl) var(--spacing-lg) var(--spacing-xl)",borderTop:"1px solid var(--color-border-primary)",backgroundColor:"var(--color-bg-primary)",display:"flex",gap:"var(--spacing-md)",justifyContent:"flex-end"},button:{padding:"10px 20px",border:"none",borderRadius:"var(--radius-sm)",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"var(--transition-normal)"},primaryButton:{padding:"10px 20px",backgroundColor:"var(--color-primary)",border:"none",borderRadius:"var(--radius-sm)",color:"var(--color-text-primary)",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"var(--transition-normal)"},secondaryButton:{padding:"10px 20px",backgroundColor:"var(--color-bg-tertiary)",border:"none",borderRadius:"var(--radius-sm)",color:"var(--color-text-primary)",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"var(--transition-normal)"},dangerButton:{padding:"10px 20px",backgroundColor:"var(--color-danger)",border:"none",borderRadius:"var(--radius-sm)",color:"var(--color-text-primary)",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"var(--transition-normal)"},input:{width:"100%",padding:"10px 12px",border:"1px solid var(--color-border-primary)",borderRadius:"var(--radius-sm)",backgroundColor:"var(--color-bg-secondary)",color:"var(--color-text-primary)",fontSize:"14px",transition:"var(--transition-normal)"},label:{display:"block",marginBottom:"var(--spacing-sm)",fontSize:"14px",fontWeight:"500",color:"var(--color-text-secondary)"},formGroup:{marginBottom:"var(--spacing-md)"},grid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"var(--spacing-md)"}},W={mobile:{container:{...A.container,width:"100%",maxWidth:"100%",maxHeight:"100vh",borderRadius:"0"},header:{...A.header,padding:"var(--spacing-md) var(--spacing-lg) var(--spacing-sm) var(--spacing-lg)"},content:{...A.content,padding:"var(--spacing-lg)"},footer:{...A.footer,padding:"var(--spacing-sm) var(--spacing-lg) var(--spacing-md) var(--spacing-lg)"}},tablet:{container:{...A.container,maxWidth:"80%",maxHeight:"85vh"}},desktop:{container:{...A.container,maxWidth:"600px",maxHeight:"80vh"}}},I={sm:{maxWidth:"400px"},md:{maxWidth:"600px"},lg:{maxWidth:"800px"},xl:{maxWidth:"1000px"}},T={default:{...A},form:{...A,content:{...A.content,padding:"var(--spacing-xl)"}},detail:{...A,container:{...A.container,maxWidth:"900px",maxHeight:"85vh"},content:{...A.content,padding:"var(--spacing-xl)"}}},E={closeButton:{opacity:1,transform:"scale(1.05)"},primaryButton:{backgroundColor:"var(--color-primary-dark)",transform:"translateY(-1px)"},secondaryButton:{backgroundColor:"var(--color-text-muted)",transform:"translateY(-1px)"},dangerButton:{backgroundColor:"#DC2626",transform:"translateY(-1px)"}};function M(e){let{isOpen:t,onClose:n,title:r,children:a,size:l="md",variant:s="default",showCloseButton:d=!0,footer:c,className:p="",style:x={}}=e,{isMobile:u,isTablet:g}=y(),[h,b]=(0,o.useState)(0);if((0,o.useEffect)(()=>{t&&u&&b(window.scrollY)},[t,u]),(0,o.useEffect)(()=>{let e=e=>{"Escape"===e.key&&t&&n()};return t&&"undefined"!=typeof document&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{"undefined"!=typeof document&&(document.removeEventListener("keydown",e),document.body.style.overflow="unset")}},[t,n]),!t)return null;let m=u?W.mobile:g?W.tablet:W.desktop,f=T[s],v=I[l],j={...f,container:{...f.container,...m.container,...v,...x}},_=u&&1?{position:"fixed",top:h+"px",left:0,right:0,bottom:"calc(100vh - ".concat(h,"px)"),zIndex:999999}:{};return(0,i.jsx)("div",{style:{...j.overlay,..._},className:p,onClick:e=>{e.target===e.currentTarget&&n()},children:(0,i.jsxs)("div",{style:j.container,children:[(0,i.jsxs)("div",{style:j.header,children:[(0,i.jsx)("h2",{style:j.title,children:r}),d&&(0,i.jsx)("button",{onClick:n,style:j.closeButton,onMouseEnter:e=>{Object.assign(e.currentTarget.style,E.closeButton)},onMouseLeave:e=>{e.currentTarget.style.opacity="0.8",e.currentTarget.style.transform="scale(1)"},"aria-label":"모달 닫기",children:"\xd7"})]}),(0,i.jsx)("div",{style:j.content,children:a}),c&&(0,i.jsx)("div",{style:j.footer,children:c})]})})}function N(e){let{variant:t="primary",onClick:n,disabled:r=!1,children:a,className:o="",style:l={},type:s="button"}=e,d=A["".concat(t,"Button")],c=E["".concat(t,"Button")];return(0,i.jsx)("button",{type:s,onClick:n,disabled:r,style:{...d,opacity:r?.5:1,cursor:r?"not-allowed":"pointer",...l},className:o,onMouseEnter:e=>{!r&&c&&Object.assign(e.currentTarget.style,c)},onMouseLeave:e=>{r||(e.currentTarget.style.backgroundColor=d.backgroundColor,e.currentTarget.style.transform="translateY(0)")},children:a})}function L(e){let{label:t,placeholder:n,value:r,onChange:a,type:o="text",required:l=!1,disabled:s=!1,className:d="",style:c={}}=e;return(0,i.jsxs)("div",{style:A.formGroup,className:d,children:[t&&(0,i.jsxs)("label",{style:A.label,children:[t,l&&(0,i.jsx)("span",{style:{color:"var(--color-danger)"},children:" *"})]}),(0,i.jsx)("input",{type:o,placeholder:n,value:r,onChange:e=>null==a?void 0:a(e.target.value),required:l,disabled:s,style:{...A.input,opacity:s?.5:1,cursor:s?"not-allowed":"text",...c}})]})}function O(e){let{user:t,brands:n,editingItem:r,onClose:a}=e,[s,d]=(0,o.useState)(0);(0,o.useEffect)(()=>{d(window.scrollY)},[]);let[c,p]=(0,o.useState)({name:"",brand_id:"",custom_brand:"",vintage:"",age_years:"",retail_price:"",total_volume_ml:"750",purchase_location:"",priority:"2",notes:"",abv:""});(0,o.useEffect)(()=>{if(r){var e,t,n,i,a,o;p({name:r.name||"",brand_id:r.brand_id||"",custom_brand:r.custom_brand||"",vintage:(null==(e=r.vintage)?void 0:e.toString())||"",age_years:(null==(t=r.age_years)?void 0:t.toString())||"",retail_price:(null==(n=r.retail_price)?void 0:n.toString())||"",total_volume_ml:(null==(i=r.total_volume_ml)?void 0:i.toString())||"750",purchase_location:r.purchase_location||"",priority:(null==(a=r.priority)?void 0:a.toString())||"2",notes:r.notes||"",abv:(null==(o=r.abv)?void 0:o.toString())||""})}},[r]);let x=async e=>{if(e.preventDefault(),!c.name)return void alert("위스키 이름을 입력해주세요.");if(!c.brand_id)return void alert("브랜드를 선택해주세요.");try{let e={user_id:t.id,name:c.name,brand_id:c.brand_id||null,custom_brand:null,vintage:c.vintage?parseInt(c.vintage):null,age_years:c.age_years?parseInt(c.age_years):null,retail_price:c.retail_price?parseFloat(c.retail_price):null,total_volume_ml:c.total_volume_ml?parseFloat(c.total_volume_ml):null,purchase_location:c.purchase_location||null,priority:parseInt(c.priority),notes:c.notes||null,abv:c.abv||""};if(r){let{error:t}=await l.supabase.from("wishlist").update(e).eq("id",r.id);if(t)throw t;alert("위시리스트가 성공적으로 수정되었습니다!")}else{let{error:t}=await l.supabase.from("wishlist").insert(e);if(t)throw t;alert("위시리스트에 성공적으로 추가되었습니다!")}a&&a()}catch(e){alert("위시리스트 저장 중 오류가 발생했습니다.")}};return(0,i.jsx)(M,{isOpen:!0,onClose:a,title:r?"위시리스트 수정":"위시리스트 추가",size:"md",variant:"form",children:(0,i.jsxs)("form",{onSubmit:x,children:[(0,i.jsxs)("div",{style:{display:"grid",gap:"16px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px"},children:"위스키명 *"}),(0,i.jsx)("input",{type:"text",value:c.name,onChange:e=>p(t=>({...t,name:e.target.value})),style:{width:"100%",padding:"10px",border:"1px solid #374151",borderRadius:"6px",backgroundColor:"#111827",color:"white"},required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px"},children:"브랜드 *"}),(0,i.jsxs)("select",{value:c.brand_id,onChange:e=>p(t=>({...t,brand_id:e.target.value,custom_brand:"custom"===e.target.value?t.custom_brand:""})),style:{width:"100%",padding:"10px",border:"1px solid #374151",borderRadius:"6px",backgroundColor:"#111827",color:"white",marginBottom:"custom"===c.brand_id?"8px":"0"},required:!0,children:[(0,i.jsx)("option",{value:"",children:"브랜드 선택"}),n.map(e=>(0,i.jsx)("option",{value:e.id,children:e.name},e.id)),(0,i.jsx)("option",{value:"custom",children:"직접 입력"})]}),"custom"===c.brand_id&&(0,i.jsx)("input",{type:"text",placeholder:"브랜드명 입력",value:c.custom_brand,onChange:e=>p(t=>({...t,custom_brand:e.target.value})),style:{width:"100%",padding:"10px",border:"1px solid #374151",borderRadius:"6px",backgroundColor:"#111827",color:"white"},required:!0})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px"},children:"빈티지"}),(0,i.jsx)("input",{type:"number",value:c.vintage,onChange:e=>p(t=>({...t,vintage:e.target.value})),style:{width:"100%",padding:"10px",border:"1px solid #374151",borderRadius:"6px",backgroundColor:"#111827",color:"white"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px"},children:"숙성연수"}),(0,i.jsx)("input",{type:"number",value:c.age_years,onChange:e=>p(t=>({...t,age_years:e.target.value})),style:{width:"100%",padding:"10px",border:"1px solid #374151",borderRadius:"6px",backgroundColor:"#111827",color:"white"}})]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px"},children:"시중가 (원)"}),(0,i.jsx)("input",{type:"number",value:c.retail_price,onChange:e=>p(t=>({...t,retail_price:e.target.value})),style:{width:"100%",padding:"10px",border:"1px solid #374151",borderRadius:"6px",backgroundColor:"#111827",color:"white"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px"},children:"용량 (ml)"}),(0,i.jsx)("input",{type:"number",value:c.total_volume_ml,onChange:e=>p(t=>({...t,total_volume_ml:e.target.value})),style:{width:"100%",padding:"10px",border:"1px solid #374151",borderRadius:"6px",backgroundColor:"#111827",color:"white"}})]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px"},children:"구매 예정 장소"}),(0,i.jsx)("input",{type:"text",value:c.purchase_location,onChange:e=>p(t=>({...t,purchase_location:e.target.value})),style:{width:"100%",padding:"10px",border:"1px solid #374151",borderRadius:"6px",backgroundColor:"#111827",color:"white"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px"},children:"우선순위"}),(0,i.jsxs)("select",{value:c.priority,onChange:e=>p(t=>({...t,priority:e.target.value})),style:{width:"100%",padding:"10px",border:"1px solid #374151",borderRadius:"6px",backgroundColor:"#111827",color:"white"},children:[(0,i.jsx)("option",{value:"1",children:"낮음"}),(0,i.jsx)("option",{value:"2",children:"보통"}),(0,i.jsx)("option",{value:"3",children:"높음"})]})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px"},children:"도수 (%)"}),(0,i.jsx)("input",{type:"number",step:"0.1",value:c.abv,onChange:e=>p(t=>({...t,abv:e.target.value})),style:{width:"100%",padding:"10px",border:"1px solid #374151",borderRadius:"6px",backgroundColor:"#111827",color:"white"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px"},children:"메모"}),(0,i.jsx)("textarea",{value:c.notes,onChange:e=>p(t=>({...t,notes:e.target.value})),rows:4,style:{width:"100%",padding:"10px",border:"1px solid #374151",borderRadius:"6px",backgroundColor:"#111827",color:"white",resize:"vertical"}})]})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"12px",marginTop:"24px"},children:[(0,i.jsx)("button",{type:"submit",style:{flex:1,padding:"12px",backgroundColor:"#3B82F6",border:"none",borderRadius:"8px",color:"white",cursor:"pointer"},children:r?"수정":"추가"}),(0,i.jsx)("button",{type:"button",onClick:a,style:{flex:1,padding:"12px",backgroundColor:"#6B7280",border:"none",borderRadius:"8px",color:"white",cursor:"pointer"},children:"취소"})]})]})})}function P(e){let{user:t,brands:n}=e,[r,a]=(0,o.useState)([]),[s,d]=(0,o.useState)([]),[c,p]=(0,o.useState)(!0),[x,u]=(0,o.useState)(!1),[g,h]=(0,o.useState)(null);(0,o.useEffect)(()=>{t&&(b(),n?d(n):m())},[t,n]);let b=async()=>{try{p(!0);let{data:e,error:n}=await l.supabase.from("wishlist").select("\n          *,\n          brands(name)\n        ").eq("user_id",t.id).eq("status","wishlist").order("priority",{ascending:!1}).order("created_at",{ascending:!1});if(n)throw n;a(e||[])}catch(e){}finally{p(!1)}},m=async()=>{try{let{data:e,error:t}=await l.supabase.from("brands").select("*").order("name");if(t)throw t;d(e||[])}catch(e){}},f=async e=>{if(confirm("정말로 이 항목을 삭제하시겠습니까?"))try{let{error:t}=await l.supabase.from("wishlist").delete().eq("id",e);if(t)throw t;b(),alert("위시리스트에서 삭제되었습니다!")}catch(e){alert("위시리스트 삭제 중 오류가 발생했습니다.")}},y=async e=>{if(confirm("이 위스키를 구매 완료로 처리하시겠습니까?"))try{let n={user_id:t.id,name:e.name,brand_id:e.brand_id,custom_brand:e.custom_brand,vintage:e.vintage,age_years:e.age_years,retail_price:e.retail_price,purchase_price:null,purchase_location:e.purchase_location,purchase_date:null,total_volume_ml:e.total_volume_ml,remaining_volume_ml:e.total_volume_ml,bottle_status:"unopened",notes:e.notes,abv:e.abv},{error:i}=await l.supabase.from("bottles").insert(n);if(i)throw i;let{error:r}=await l.supabase.from("wishlist").delete().eq("id",e.id);if(r)throw r;b(),alert("구매 완료! 위스키 컬렉션에 추가되었습니다.")}catch(e){alert("구매 완료 처리 중 오류가 발생했습니다.")}},v=()=>{h(null),u(!0)};return c?(0,i.jsx)("div",{style:{padding:"20px",textAlign:"center"},children:(0,i.jsx)("p",{children:"위시리스트 로딩중..."})}):(0,i.jsxs)("div",{style:{padding:"20px"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[(0,i.jsxs)("h2",{children:["위시리스트 (",r.length,"개)"]}),(0,i.jsx)("button",{onClick:v,style:{padding:"10px 20px",backgroundColor:"#3B82F6",border:"none",borderRadius:"8px",color:"white",cursor:"pointer"},children:"위시리스트 추가"})]}),(0,i.jsx)("div",{style:{display:"grid",gap:"16px"},children:r.map(e=>{var t;return(0,i.jsxs)("div",{style:{backgroundColor:"#1F2937",borderRadius:"12px",padding:"20px",border:"1px solid #374151"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"16px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{style:{margin:"0 0 8px 0",fontSize:"18px"},children:e.name}),(0,i.jsx)("p",{style:{margin:"0 0 8px 0",color:"#9CA3AF"},children:(null==(t=e.brands)?void 0:t.name)||e.custom_brand}),(0,i.jsxs)("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[e.vintage&&(0,i.jsx)("span",{style:{backgroundColor:"#374151",padding:"4px 8px",borderRadius:"4px",fontSize:"12px"},children:e.vintage}),e.age_years&&(0,i.jsxs)("span",{style:{backgroundColor:"#374151",padding:"4px 8px",borderRadius:"4px",fontSize:"12px"},children:[e.age_years,"년"]}),(0,i.jsx)("span",{style:{backgroundColor:(e=>{switch(e){case 1:return"#6B7280";case 2:default:return"#F59E0B";case 3:return"#EF4444"}})(e.priority),padding:"4px 8px",borderRadius:"4px",fontSize:"12px"},children:(e=>{switch(e){case 1:return"낮음";case 2:default:return"보통";case 3:return"높음"}})(e.priority)})]})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,i.jsx)("button",{onClick:()=>y(e),style:{padding:"6px 12px",backgroundColor:"#10B981",border:"none",borderRadius:"6px",color:"white",cursor:"pointer",fontSize:"12px"},children:"구매완료"}),(0,i.jsx)("button",{onClick:()=>{h(e),u(!0)},style:{padding:"6px 12px",backgroundColor:"#3B82F6",border:"none",borderRadius:"6px",color:"white",cursor:"pointer",fontSize:"12px"},children:"수정"}),(0,i.jsx)("button",{onClick:()=>f(e.id),style:{padding:"6px 12px",backgroundColor:"#EF4444",border:"none",borderRadius:"6px",color:"white",cursor:"pointer",fontSize:"12px"},children:"삭제"})]})]}),(0,i.jsxs)("div",{style:{marginBottom:"16px"},children:[e.retail_price&&(0,i.jsxs)("p",{style:{margin:"0 0 4px 0",fontSize:"14px"},children:["시중가: ",e.retail_price.toLocaleString(),"원"]}),e.total_volume_ml&&(0,i.jsxs)("p",{style:{margin:"0 0 4px 0",fontSize:"14px"},children:["용량: ",e.total_volume_ml,"ml"]}),e.purchase_location&&(0,i.jsxs)("p",{style:{margin:"0 0 4px 0",fontSize:"14px"},children:["구매 예정 장소: ",e.purchase_location]}),e.abv&&(0,i.jsxs)("p",{style:{margin:"0 0 4px 0",fontSize:"14px"},children:["도수: ",e.abv,"%"]})]}),e.notes&&(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{style:{fontSize:"12px",color:"#9CA3AF"},children:"메모:"}),(0,i.jsx)("p",{style:{margin:"4px 0 0 0",fontSize:"14px"},children:e.notes})]})]},e.id)})}),0===r.length&&!c&&(0,i.jsxs)("div",{style:{textAlign:"center",padding:"40px",color:"#9CA3AF"},children:[(0,i.jsx)("p",{children:"위시리스트가 비어있습니다."}),(0,i.jsx)("button",{onClick:v,style:{padding:"10px 20px",backgroundColor:"#3B82F6",border:"none",borderRadius:"8px",color:"white",cursor:"pointer"},children:"첫 번째 위시리스트 추가하기"})]}),x&&(0,i.jsx)(O,{user:t,brands:s,editingItem:g,onClose:()=>{u(!1),h(null),b()}})]})}function U(e){let{user:t,loading:n,setLoading:r,setMessage:a,supabase:o}=e,l=async e=>{r(!0),a("");try{let n=await c(t,e,o);a(n)}catch(e){a("데이터 내보내기 중 오류가 발생했습니다.")}finally{r(!1)}};return(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{style:{margin:"0 0 8px 0",fontSize:"14px",color:"#9CA3AF"},children:"데이터 내보내기"}),(0,i.jsx)("p",{style:{margin:"0 0 12px 0",fontSize:"12px",color:"#9CA3AF"},children:"모든 위스키, 시음 기록, 위시리스트를 JSON, CSV 또는 Excel 파일로 백업합니다."}),(0,i.jsxs)("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:[(0,i.jsx)("button",{onClick:()=>l("json"),disabled:n,style:{padding:"10px 20px",backgroundColor:"#3B82F6",border:"none",borderRadius:"8px",color:"white",cursor:n?"not-allowed":"pointer",opacity:n?.6:1},children:n?"처리중...":"JSON 내보내기"}),(0,i.jsx)("button",{onClick:()=>l("csv"),disabled:n,style:{padding:"10px 20px",backgroundColor:"#10B981",border:"none",borderRadius:"8px",color:"white",cursor:n?"not-allowed":"pointer",opacity:n?.6:1},children:n?"처리중...":"CSV 내보내기"}),(0,i.jsx)("button",{onClick:()=>l("excel"),disabled:n,style:{padding:"10px 20px",backgroundColor:"#F59E0B",border:"none",borderRadius:"8px",color:"white",cursor:n?"not-allowed":"pointer",opacity:n?.6:1},children:n?"처리중...":"Excel 내보내기"})]})]})}let q=async e=>{let t=e.split("\n").filter(e=>e.trim());if(t.length<2)throw Error("데이터가 없습니다.");let n=[],i=[],r=[],a=[],o="",l=[],s=[];for(let e=0;e<t.length;e++){let d=t[e];if(d.startsWith("=== ")){o&&l.length>0&&s.length>0&&G(o,l,s,n,i,r,a),o=d.replace(/=== | ===/g,""),l=[],s=[];continue}if(0===l.length&&!d.startsWith("내보내기 날짜")&&!d.startsWith("버전")&&d.includes(",")){l=H(d);continue}l.length>0&&d.includes(",")&&s.push(d)}return o&&l.length>0&&s.length>0&&G(o,l,s,n,i,r,a),{bottles:n,tastings:i,brands:r,wishlist:a}},H=e=>{let t=[],n="",i=!1;for(let r=0;r<e.length;r++){let a=e[r];'"'===a?i=!i:","!==a||i?n+=a:(t.push(n.trim()),n="")}return t.push(n.trim()),t},G=(e,t,n,i,r,a,o)=>{n.forEach((n,l)=>{let s=H(n);if(s.length<t.length)return;let d={};switch(t.forEach((e,t)=>{let n=s[t];n&&""!==n&&(d[e]=n)}),e){case"브랜드":d["브랜드명"]&&a.push({name:d["브랜드명"],country:null,description:null});break;case"위스키":if(d["위스키명"]||d.name){let e=Y(d),t={name:e.name||e["위스키명"],custom_brand:e.custom_brand||e.brand||null,vintage:e.vintage?parseInt(e.vintage):null,age_years:e.age_years?parseInt(e.age_years):null,abv:e.abv?parseFloat(e.abv):null,retail_price:e.retail_price?parseFloat(e.retail_price):null,purchase_price:e.purchase_price?parseFloat(e.purchase_price):null,discount_rate:e.discount_rate?parseFloat(e.discount_rate):null,purchase_location:e.purchase_location||null,purchase_date:e.purchase_date||null,bottle_status:e.bottle_status||"unopened",total_volume_ml:e.total_volume_ml?parseInt(e.total_volume_ml):null,remaining_volume_ml:e.remaining_volume_ml?parseInt(e.remaining_volume_ml):null,notes:e.notes||null};i.push(t),t.custom_brand&&(a.find(e=>e.name===t.custom_brand)||a.push({name:t.custom_brand,country:null,description:null}))}break;case"시음 기록":if(d["위스키ID"]||d["위스키명"]){let e={bottle_id:d["위스키ID"]||null,bottle_name:d["위스키명"]||null,tasting_type:d["시음타입"]||"bottle",tasting_date:d["시음날짜"]||new Date().toISOString(),location:d["장소"]||null,consumed_volume_ml:d["소비량"]?parseFloat(d["소비량"]):null,nose_rating:d["Nose점수"]?parseInt(d["Nose점수"]):null,palate_rating:d["Palate점수"]?parseInt(d["Palate점수"]):null,finish_rating:d["Finish점수"]?parseInt(d["Finish점수"]):null,overall_rating:d["Overall점수"]?parseInt(d["Overall점수"]):null,nose_notes:d["Nose노트"]||null,palate_notes:d["Palate노트"]||null,finish_notes:d["Finish노트"]||null,companions:d["함께한사람"]||null,additional_notes:d["추가노트"]||null};r.push(e)}break;case"위시리스트":if(d["위스키명"]){let e={name:d["위스키명"],brand:d["브랜드"]||null,vintage:d["빈티지"]?parseInt(d["빈티지"]):null,age_years:d["숙성연수"]?parseInt(d["숙성연수"]):null,estimated_price:d["예상가격"]?parseFloat(d["예상가격"]):null,priority:d["우선순위"]?parseInt(d["우선순위"]):null,notes:d["메모"]||null};o.push(e)}}})},Y=e=>{let t={};return Object.keys(e).forEach(n=>{t[(e=>({위스키명:"name","위스키 이름":"name",Name:"name","Whisky Name":"name",브랜드:"brand",브랜드명:"brand",커스텀브랜드:"custom_brand",Brand:"brand","Brand Name":"brand",지역:"region",Region:"region",빈티지:"vintage",Vintage:"vintage",Year:"vintage",숙성연수:"age_years",Age:"age_years","Age in Years":"age_years",도수:"abv",ABV:"abv","Alcohol by Volume":"abv",알코올:"abv",캐스크:"cask_type",캐스크타입:"cask_type",Cask:"cask_type","Cask Type":"cask_type",색상:"color",Color:"color",시중가:"retail_price","시중가(원)":"retail_price","Market Price":"retail_price",Price:"retail_price",구매가:"purchase_price","구매가(원)":"purchase_price","Purchase Price":"purchase_price",Cost:"purchase_price",할인율:"discount_rate","Discount Rate":"discount_rate",Discount:"discount_rate",구매장소:"purchase_location","Purchase Location":"purchase_location",구매일:"purchase_date","Purchase Date":"purchase_date",Date:"purchase_date",총용량:"total_volume_ml",용량:"total_volume_ml",Volume:"total_volume_ml","Total Volume":"total_volume_ml",남은용량:"remaining_volume_ml","Remaining Volume":"remaining_volume_ml",Remaining:"remaining_volume_ml",상태:"bottle_status",Status:"bottle_status","Bottle Status":"bottle_status",메모:"notes",Notes:"notes",Memo:"notes",시음타입:"tasting_type","Tasting Type":"tasting_type",시음날짜:"tasting_date",시음일:"tasting_date","Tasting Date":"tasting_date",장소:"location",Location:"location",소비량:"consumed_volume_ml","Consumed Volume":"consumed_volume_ml",Nose점수:"nose_rating",노즈점수:"nose_rating","Nose Rating":"nose_rating",Palate점수:"palate_rating",팔레트점수:"palate_rating","Palate Rating":"palate_rating",Finish점수:"finish_rating",피니쉬점수:"finish_rating","Finish Rating":"finish_rating",Overall점수:"overall_rating",종합점수:"overall_rating","Overall Rating":"overall_rating",Nose노트:"nose_notes",노즈메모:"nose_notes","Nose Notes":"nose_notes",Palate노트:"palate_notes",팔레트메모:"palate_notes","Palate Notes":"palate_notes",Finish노트:"finish_notes",피니쉬메모:"finish_notes","Finish Notes":"finish_notes",함께한사람:"companions",Companions:"companions",추가노트:"additional_notes",추가메모:"additional_notes","Additional Notes":"additional_notes",예상가격:"estimated_price","Estimated Price":"estimated_price",우선순위:"priority",Priority:"priority"})[e]||e)(n)]=e[n]}),t},J=async e=>{let t=await e.arrayBuffer(),n=s.LF(t,{type:"buffer",cellDates:!0,cellNF:!1,cellText:!1}),i=[],r=[],a=[],o=[];for(let e of n.SheetNames){let t=n.Sheets[e];s.Wp.decode_range(t["!ref"]||"A1");let l=s.Wp.sheet_to_json(t,{header:1,defval:"",blankrows:!1});if(l.length<2){let e=s.Wp.sheet_to_json(t,{header:"A",defval:"",blankrows:!1});if(e.length<2)continue;let n=Object.keys(e[0]);for(let t=1;t<e.length;t++){let r=e[t];if(!r)continue;let o={};if(n.forEach((e,t)=>{void 0!==r[e]&&(o[e]=r[e])}),o.A&&"위스키명"!==o.A){let e={name:o.A||"",custom_brand:o.C||null,vintage:o.E?parseInt(o.E):null,age_years:o.F?parseInt(o.F):null,retail_price:o.J?parseFloat(o.J):null,purchase_price:o.K?parseFloat(o.K):null,discount_rate:o.L?parseFloat(o.L):null,purchase_location:o.M||null,purchase_date:o.N||null,bottle_status:"오픈"===o.Q?"opened":"unopened",total_volume_ml:o.O?parseInt(o.O):null,remaining_volume_ml:o.P?parseInt(o.P):null,notes:o.R||null};e.name&&"위스키명"!==e.name&&(i.push(e),e.custom_brand&&(a.find(t=>t.name===e.custom_brand)||a.push({name:e.custom_brand,country:null,description:null})))}}continue}let d=l[0];for(let t=1;t<l.length;t++){let n=l[t];if(!n||0===n.length)continue;let s={};switch(d.forEach((e,t)=>{e&&void 0!==n[t]&&(s[e]=n[t])}),e){case"브랜드":s["브랜드명"]&&a.push({name:s["브랜드명"],country:s["국가"]||null,description:s["설명"]||null});break;case"위스키 컬렉션":if(s["위스키명"]||s.name){let e=Y(s),t={name:e.name||e["위스키명"],custom_brand:e.custom_brand||e.brand||null,vintage:e.vintage?parseInt(e.vintage):null,age_years:e.age_years?parseInt(e.age_years):null,abv:e.abv?parseFloat(e.abv):null,retail_price:e.retail_price?parseFloat(e.retail_price):null,purchase_price:e.purchase_price?parseFloat(e.purchase_price):null,discount_rate:e.discount_rate?parseFloat(e.discount_rate):null,purchase_location:e.purchase_location||null,purchase_date:e.purchase_date?new Date(e.purchase_date).toISOString().split("T")[0]:null,bottle_status:"오픈"===e.bottle_status?"opened":"unopened",total_volume_ml:e.total_volume_ml?parseInt(e.total_volume_ml):null,remaining_volume_ml:e.remaining_volume_ml?parseInt(e.remaining_volume_ml):null,notes:e.notes||null};i.push(t),t.custom_brand&&(a.find(e=>e.name===t.custom_brand)||a.push({name:t.custom_brand,country:null,description:null}))}break;case"시음 기록":if(s["위스키명"]){let e=e=>({"친구 보틀":"meeting","바 시음":"bar",모임:"meeting","개인 시음":"bottle",시음회:"meeting",바:"bar",보틀:"bottle",혼자:"bottle"})[e]||"bottle",t={bottle_name:s["위스키명"],tasting_type:e(s["시음타입"]||"bottle"),tasting_date:s["시음일"]?new Date(s["시음일"]).toISOString():new Date().toISOString(),location:s["장소"]||null,consumed_volume_ml:s["소비량"]?parseFloat(s["소비량"]):null,nose_rating:s["노즈점수"]?Math.round(parseFloat(s["노즈점수"])):null,palate_rating:s["팔레트점수"]?Math.round(parseFloat(s["팔레트점수"])):null,finish_rating:s["피니쉬점수"]?Math.round(parseFloat(s["피니쉬점수"])):null,overall_rating:s["종합점수"]?parseFloat(parseFloat(s["종합점수"]).toFixed(1)):null,nose_notes:s["노즈메모"]||null,palate_notes:s["팔레트메모"]||null,finish_notes:s["피니쉬메모"]||null,companions:s["함께한사람"]||null,additional_notes:s["추가메모"]||null};r.push(t)}break;case"위시리스트":if(s["위스키명"]){let e={name:s["위스키명"],custom_brand:s["브랜드"]||null,vintage:s["빈티지"]?parseInt(s["빈티지"]):null,age_years:s["숙성연수"]?parseInt(s["숙성연수"]):null,retail_price:s["시중가(원)"]?parseFloat(s["시중가(원)"]):null,priority:"높음"===s["우선순위"]?3:"중간"===s["우선순위"]?2:1,notes:s["메모"]||null};o.push(e),e.custom_brand&&(a.find(t=>t.name===e.custom_brand)||a.push({name:e.custom_brand,country:null,description:null}))}}}}return{bottles:i,tastings:r,brands:a,wishlist:o,exportDate:new Date().toISOString(),version:"1.0"}},V=async(e,t,n,i)=>{let r,a=i||{importBottles:!0,importTastings:!0,importWishlist:!0,importBrands:!0,bottlesMode:"add",tastingsMode:"add",wishlistMode:"add",brandsMode:"add"};if(e.name.endsWith(".json")){let t=await e.arrayBuffer(),n=new TextDecoder("utf-8").decode(t);try{if(!(r=JSON.parse(n)).bottles&&!r.tastings&&!r.wishlist&&!r.brands)throw Error("백업 파일에 유효한 데이터가 없습니다. bottles, tastings, wishlist, brands 중 하나 이상이 필요합니다.");r.bottles=r.bottles||[],r.tastings=r.tastings||[],r.wishlist=r.wishlist||[],r.brands=r.brands||[]}catch(e){throw Error("JSON 파일 파싱 오류: ".concat(e instanceof Error?e.message:"알 수 없는 오류"))}}else if(e.name.endsWith(".xlsx")||e.name.endsWith(".xls")){let t=await J(e);r={bottles:t.bottles||[],tastings:t.tastings||[],wishlist:t.wishlist||[],brands:t.brands||[],exportDate:new Date().toISOString(),version:"1.0"}}else{let t=await e.arrayBuffer(),n=new TextDecoder("utf-8").decode(t),i=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x9F]/.test(n),a=n.includes(",")&&n.includes("\n");if(i||!a)throw Error("파일이 바이너리 형식이거나 유효한 CSV가 아닙니다. 텍스트 형식의 CSV 파일을 사용해주세요.");let o=n;n.startsWith("\uFEFF")&&(o=n.slice(1));try{let e=new TextDecoder("euc-kr"),t=new TextEncoder().encode(o),n=e.decode(t);(n.includes("보틀ID")||n.includes("위스키명"))&&(o=n)}catch(e){}let l=await q(o);r={bottles:l.bottles||[],tastings:l.tastings||[],wishlist:l.wishlist||[],brands:l.brands||[],exportDate:new Date().toISOString(),version:"1.0"}}let o=await n.from("brands").select("name"),l=r.brands.filter(e=>{var t;return!(null==(t=o.data)?void 0:t.some(t=>t.name===e.name))});if(l.length>0){let e=await n.from("brands").insert(l);if(e.error)throw e.error}let s=r.bottles.map(e=>{let{id:n,...i}=e,r={user_id:t.id,name:i.name,custom_brand:i.custom_brand,vintage:i.vintage,age_years:i.age_years,abv:i.abv,retail_price:i.retail_price,purchase_price:i.purchase_price,discount_rate:i.discount_rate,purchase_location:i.purchase_location,purchase_date:i.purchase_date,bottle_status:i.status||i.bottle_status||"unopened",total_volume_ml:i.total_volume_ml,remaining_volume_ml:i.remaining_volume_ml,notes:i.notes};return Object.keys(r).forEach(e=>{void 0===r[e]&&delete r[e]}),r}),d=r.tastings.map(e=>{let{id:n,bottle_name:i,...r}=e,a={user_id:t.id,tasting_type:r.tasting_type,tasting_date:r.tasting_date,location:r.location,consumed_volume_ml:r.consumed_volume_ml,nose_rating:r.nose_rating,palate_rating:r.palate_rating,finish_rating:r.finish_rating,overall_rating:r.overall_rating,nose_notes:r.nose_notes,palate_notes:r.palate_notes,finish_notes:r.finish_notes,companions:r.companions,additional_notes:r.additional_notes};return Object.keys(a).forEach(e=>{void 0===a[e]&&delete a[e]}),a}),c=r.wishlist.map(e=>{let{id:n,...i}=e,r={user_id:t.id,name:i.name,custom_brand:i.custom_brand,vintage:i.vintage,age_years:i.age_years,retail_price:i.retail_price,priority:i.priority||1,notes:i.notes};return Object.keys(r).forEach(e=>{void 0===r[e]&&delete r[e]}),r});if(s.length>0&&a.importBottles){if("replace"===a.bottlesMode){let e=await n.from("bottles").delete().eq("user_id",t.id);if(e.error)throw e.error}let e=await n.from("bottles").insert(s);if(e.error)throw e.error;let i=new Map;if(e.data&&e.data.forEach((e,t)=>{let n=s[t];n.temp_id&&i.set(n.temp_id,e.id)}),d.length>0&&a.importTastings){if("replace"===a.tastingsMode){let e=await n.from("tastings").delete().eq("user_id",t.id);if(e.error)throw e.error}let e=[...new Set(r.tastings.map(e=>e.bottle_name).filter(Boolean))];if(e.length>0){let{data:i}=await n.from("bottles").select("id, name, vintage, age_years, custom_brand").eq("user_id",t.id).in("name",e),a=r.tastings.map(e=>{let{bottle_name:n,...r}=e,a=null;return(n&&(a=null==i?void 0:i.find(e=>e.name===n)),a)?{...r,user_id:t.id,bottle_id:a.id}:null}).filter(Boolean);if(a.length>0){a.filter(e=>!["bar","bottle","meeting"].includes(e.tasting_type)).length;let e=await n.from("tastings").insert(a);if(e.error)throw e.error}r.tastings.length,a.length}}}if(c.length>0&&a.importWishlist){if("replace"===a.wishlistMode){let e=await n.from("wishlist").delete().eq("user_id",t.id);if(e.error)throw e.error}let e=await n.from("wishlist").insert(c);if(e.error)throw e.error}let p={bottles:a.importBottles?r.bottles.length:0,tastings:a.importTastings?r.tastings.length:0,wishlist:a.importWishlist?r.wishlist.length:0,brands:a.importBrands?r.brands.length:0};return"데이터 가져오기가 완료되었습니다! \n    ".concat(p.bottles>0?"위스키: ".concat(p.bottles,"개 "):"","\n    ").concat(p.tastings>0?"시음: ".concat(p.tastings,"개 "):"","\n    ").concat(p.wishlist>0?"위시리스트: ".concat(p.wishlist,"개 "):"","\n    ").concat(p.brands>0?"브랜드: ".concat(p.brands,"개 "):"").trim()+" 페이지를 새로고침해주세요."},K=async()=>{try{let{data:{user:e},error:t}=await l.supabase.auth.getUser();if(t)return{isAuthenticated:!1,user:null,error:t};if(!e)return{isAuthenticated:!1,user:null,error:null};return{isAuthenticated:!0,user:e,error:null}}catch(e){return{isAuthenticated:!1,user:null,error:e}}},X=async()=>{try{let{data:{session:e},error:t}=await l.supabase.auth.getSession();if(t)return{hasSession:!1,session:null,error:t};if(!e)return{hasSession:!1,session:null,error:null};return{hasSession:!0,session:e,error:null}}catch(e){return{hasSession:!1,session:null,error:e}}},Z=async()=>{try{let{data:e,error:t}=await l.supabase.from("brands").select("count(*)").limit(1);if(t)return{isConnected:!1,error:t};return{isConnected:!0,error:null}}catch(e){return{isConnected:!1,error:e}}},Q=async e=>{let t=[];try{let n=await l.supabase.from("wishlist").select("id").eq("user_id",e).limit(1);t.push({table:"wishlist",operation:"SELECT",success:!n.error,error:n.error});let i=await l.supabase.from("bottles").select("id").eq("user_id",e).limit(1);t.push({table:"bottles",operation:"SELECT",success:!i.error,error:i.error});let r=await l.supabase.from("tastings").select("id").eq("user_id",e).limit(1);t.push({table:"tastings",operation:"SELECT",success:!r.error,error:r.error});let a=await l.supabase.from("brands").select("id").limit(1);return t.push({table:"brands",operation:"SELECT",success:!a.error,error:a.error}),t}catch(e){return t}},$=async()=>{let e=await K(),t=await X(),n=await Z(),i=[];return e.isAuthenticated&&e.user&&(i=await Q(e.user.id)),{authStatus:e,sessionStatus:t,dbConnection:n,rlsTests:i}},ee={importBottles:!0,importTastings:!0,importWishlist:!0,importBrands:!0,bottlesMode:"add",tastingsMode:"add",wishlistMode:"add",brandsMode:"add"};function et(e){let{user:t,loading:n,setLoading:r,setMessage:a,supabase:l}=e,[s,d]=(0,o.useState)(ee),[c,p]=(0,o.useState)(null),x=async()=>{if(c){r(!0),a("");try{let e=await $();if(!e.authStatus.isAuthenticated)throw Error("사용자가 인증되지 않았습니다. 다시 로그인해주세요.");if(!e.dbConnection.isConnected)throw Error("데이터베이스 연결에 문제가 있습니다.");if(e.rlsTests.filter(e=>!e.success).length>0)return void a("권한 문제가 발생했습니다. 페이지를 새로고침하고 다시 시도해주세요.");let n=await V(c,t,l,s);a(n),p(null)}catch(e){a("데이터 불러오기 중 오류가 발생했습니다: ".concat(e instanceof Error?e.message:"알 수 없는 오류"))}finally{r(!1)}}};return(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{style:{margin:"0 0 8px 0",fontSize:"14px",color:"#9CA3AF"},children:"데이터 불러오기"}),(0,i.jsxs)("p",{style:{margin:"0 0 12px 0",fontSize:"12px",color:"#9CA3AF"},children:["백업 파일을 선택하여 데이터를 복원합니다.",(0,i.jsx)("br",{}),(0,i.jsx)("strong",{children:"지원 형식:"})," JSON 백업 파일, CSV 파일, Excel 파일(.xlsx, .xls)"]}),(0,i.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,i.jsx)("input",{type:"file",accept:".json,.csv,.xlsx,.xls",onChange:e=>{var t;p((null==(t=e.target.files)?void 0:t[0])||null)},disabled:n,style:{padding:"8px",border:"1px solid #374151",borderRadius:"6px",backgroundColor:"#111827",color:"white",cursor:n?"not-allowed":"pointer",opacity:n?.6:1}}),c&&(0,i.jsxs)("p",{style:{margin:"8px 0 0 0",fontSize:"12px",color:"#10B981"},children:["선택된 파일: ",c.name]})]}),c&&(0,i.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,i.jsx)("h5",{style:{margin:"0 0 8px 0",fontSize:"12px",color:"#9CA3AF"},children:"가져오기 옵션"}),(0,i.jsxs)("div",{style:{display:"grid",gap:"8px",marginBottom:"12px"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,i.jsx)("input",{type:"checkbox",id:"importBottles",checked:s.importBottles,onChange:e=>d(t=>({...t,importBottles:e.target.checked})),disabled:n}),(0,i.jsx)("label",{htmlFor:"importBottles",style:{fontSize:"12px",color:"white"},children:"위스키 컬렉션"}),s.importBottles&&(0,i.jsxs)("select",{value:s.bottlesMode,onChange:e=>d(t=>({...t,bottlesMode:e.target.value})),disabled:n,style:{padding:"4px 8px",border:"1px solid #374151",borderRadius:"4px",backgroundColor:"#111827",color:"white",fontSize:"11px"},children:[(0,i.jsx)("option",{value:"add",children:"추가"}),(0,i.jsx)("option",{value:"replace",children:"전체 대체"}),(0,i.jsx)("option",{value:"merge",children:"스마트 병합"})]})]}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,i.jsx)("input",{type:"checkbox",id:"importTastings",checked:s.importTastings,onChange:e=>d(t=>({...t,importTastings:e.target.checked})),disabled:n}),(0,i.jsx)("label",{htmlFor:"importTastings",style:{fontSize:"12px",color:"white"},children:"시음 기록"}),s.importTastings&&(0,i.jsxs)("select",{value:s.tastingsMode,onChange:e=>d(t=>({...t,tastingsMode:e.target.value})),disabled:n,style:{padding:"4px 8px",border:"1px solid #374151",borderRadius:"4px",backgroundColor:"#111827",color:"white",fontSize:"11px"},children:[(0,i.jsx)("option",{value:"add",children:"추가"}),(0,i.jsx)("option",{value:"replace",children:"전체 대체"}),(0,i.jsx)("option",{value:"merge",children:"스마트 병합"})]})]}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,i.jsx)("input",{type:"checkbox",id:"importWishlist",checked:s.importWishlist,onChange:e=>d(t=>({...t,importWishlist:e.target.checked})),disabled:n}),(0,i.jsx)("label",{htmlFor:"importWishlist",style:{fontSize:"12px",color:"white"},children:"위시리스트"}),s.importWishlist&&(0,i.jsxs)("select",{value:s.wishlistMode,onChange:e=>d(t=>({...t,wishlistMode:e.target.value})),disabled:n,style:{padding:"4px 8px",border:"1px solid #374151",borderRadius:"4px",backgroundColor:"#111827",color:"white",fontSize:"11px"},children:[(0,i.jsx)("option",{value:"add",children:"추가"}),(0,i.jsx)("option",{value:"replace",children:"전체 대체"}),(0,i.jsx)("option",{value:"merge",children:"스마트 병합"})]})]}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,i.jsx)("input",{type:"checkbox",id:"importBrands",checked:s.importBrands,onChange:e=>d(t=>({...t,importBrands:e.target.checked})),disabled:n}),(0,i.jsx)("label",{htmlFor:"importBrands",style:{fontSize:"12px",color:"white"},children:"브랜드 정보"}),s.importBrands&&(0,i.jsxs)("select",{value:s.brandsMode,onChange:e=>d(t=>({...t,brandsMode:e.target.value})),disabled:n,style:{padding:"4px 8px",border:"1px solid #374151",borderRadius:"4px",backgroundColor:"#111827",color:"white",fontSize:"11px"},children:[(0,i.jsx)("option",{value:"add",children:"추가"}),(0,i.jsx)("option",{value:"replace",children:"전체 대체"}),(0,i.jsx)("option",{value:"merge",children:"스마트 병합"})]})]})]}),(0,i.jsx)("button",{onClick:x,disabled:n||!c,style:{padding:"10px 20px",backgroundColor:"#3B82F6",border:"none",borderRadius:"8px",color:"white",cursor:n||!c?"not-allowed":"pointer",opacity:n||!c?.6:1,fontSize:"14px"},children:n?"가져오는 중...":"데이터 가져오기"})]})]})}function en(){let[e,t]=(0,o.useState)({enabled:!1,auto_backup_enabled:!1,interval_hours:24,max_backups:10,incremental_backup:!0,compression_enabled:!0,notification_enabled:!0,auto_cleanup:!0,backup_verification:!0}),[r,a]=(0,o.useState)([]),[s,d]=(0,o.useState)(!1),[c,p]=(0,o.useState)(""),{showToast:x}=(0,f.d)(),u=m();(0,o.useEffect)(()=>{g(),h()},[]);let g=async()=>{t(u.getConfig())},h=async()=>{try{let e=await u.getBackupList();a(e)}catch(e){x("백업 목록을 불러오는데 실패했습니다.","error")}},b=async n=>{try{await u.saveConfig(n),t({...e,...n}),x("설정이 저장되었습니다.","success")}catch(e){x("설정 저장에 실패했습니다.","error")}},y=async()=>{d(!0),p("백업을 생성하고 있습니다...");try{let{data:{user:e}}=await l.supabase.auth.getUser();if(!e)return void x("로그인이 필요합니다.","error");let[t,n,i]=await Promise.all([l.supabase.from("bottles").select("*").eq("user_id",e.id),l.supabase.from("tastings").select("*").eq("user_id",e.id),l.supabase.from("wishlist").select("*").eq("user_id",e.id)]);if(t.error)throw t.error;if(n.error)throw n.error;if(i.error)throw i.error;let r=t.data||[],o=n.data||[],s=i.data||[],d={bottles:r,tastings:o,wishlist:s,backup_info:{created_at:new Date().toISOString(),user_id:e.id,version:"1.0.0"}},c=JSON.stringify(d,null,2),p=new Blob([c]).size,u={id:"backup-".concat(Date.now()),user_id:e.id,backup_id:"backup-".concat(Date.now()),metadata:{timestamp:new Date().toISOString(),version:"1.0.0",data_types:["bottles","tastings","wishlist"],record_counts:{bottles:r.length,tastings:o.length,wishlist:s.length},total_size:p,checksum:"real-backup-checksum",is_incremental:!1,changes_since_last:{bottles_added:0,bottles_updated:0,bottles_deleted:0,tastings_added:0,tastings_updated:0,tastings_deleted:0}},created_at:new Date().toISOString(),updated_at:new Date().toISOString()};a(e=>[u,...e]),x("실제 백업이 생성되었습니다! (위스키: ".concat(r.length,"개, 시음: ").concat(o.length,"개, 위시리스트: ").concat(s.length,"개)"),"success")}catch(e){x("백업 생성에 실패했습니다.","error")}finally{d(!1),p("")}},v=async e=>{if(confirm("정말로 이 백업으로 복구하시겠습니까? 현재 데이터는 모두 삭제됩니다.")){d(!0),p("백업을 복구하고 있습니다...");try{await u.restoreFromBackup(e),x("백업 복구가 완료되었습니다!","success"),window.location.reload()}catch(e){x("백업 복구에 실패했습니다.","error")}finally{d(!1),p("")}}},j=async e=>{if(confirm("정말로 이 백업을 삭제하시겠습니까?"))try{let t=(await Promise.resolve().then(n.bind(n,2099))).supabase.auth.getUser();if(!t)throw Error("사용자 인증이 필요합니다.");await u.deleteBackup((await t).data.user.id,e),x("백업이 삭제되었습니다.","success"),await h()}catch(e){x("백업 삭제에 실패했습니다.","error")}};return(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"14px",color:"#9CA3AF",marginBottom:"16px"},children:"자동 백업 및 복구 관리"}),s&&(0,i.jsx)("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"rgba(0, 0, 0, 0.8)",color:"white",padding:"20px",borderRadius:"8px",zIndex:1e3},children:(0,i.jsxs)("div",{style:{textAlign:"center"},children:[(0,i.jsx)("div",{style:{marginBottom:"10px"},children:"⏳"}),c]})}),(0,i.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,i.jsx)("h3",{style:{margin:"0 0 12px 0",fontSize:"16px",fontWeight:"600",color:"white"},children:"⚙️ 백업 설정"}),(0,i.jsxs)("div",{style:{display:"grid",gap:"12px"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,i.jsx)("label",{style:{fontSize:"14px",color:"white"},children:"자동 백업"}),(0,i.jsx)("input",{type:"checkbox",checked:e.enabled,onChange:e=>b({enabled:e.target.checked}),style:{width:"20px",height:"20px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{fontSize:"14px",marginBottom:"6px",display:"block",color:"white"},children:"백업 간격 (시간)"}),(0,i.jsx)("input",{type:"number",min:"1",max:"168",value:e.interval_hours,onChange:e=>b({interval_hours:parseInt(e.target.value)}),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #4B5563",backgroundColor:"#374151",color:"white",fontSize:"16px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{fontSize:"16px",marginBottom:"8px",display:"block"},children:"최대 백업 수"}),(0,i.jsx)("input",{type:"number",min:"1",max:"50",value:e.max_backups,onChange:e=>b({max_backups:parseInt(e.target.value)}),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #4B5563",backgroundColor:"#374151",color:"white",fontSize:"16px"}})]}),(0,i.jsxs)("div",{style:{display:"grid",gap:"12px"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,i.jsx)("label",{style:{fontSize:"16px"},children:"증분 백업"}),(0,i.jsx)("input",{type:"checkbox",checked:e.incremental_backup,onChange:e=>b({incremental_backup:e.target.checked}),style:{width:"20px",height:"20px"}})]}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,i.jsx)("label",{style:{fontSize:"16px"},children:"압축 사용"}),(0,i.jsx)("input",{type:"checkbox",checked:e.compression_enabled,onChange:e=>b({compression_enabled:e.target.checked}),style:{width:"20px",height:"20px"}})]}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,i.jsx)("label",{style:{fontSize:"16px"},children:"알림 표시"}),(0,i.jsx)("input",{type:"checkbox",checked:e.notification_enabled,onChange:e=>b({notification_enabled:e.target.checked}),style:{width:"20px",height:"20px"}})]}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,i.jsx)("label",{style:{fontSize:"16px"},children:"자동 정리"}),(0,i.jsx)("input",{type:"checkbox",checked:e.auto_cleanup,onChange:e=>b({auto_cleanup:e.target.checked}),style:{width:"20px",height:"20px"}})]}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,i.jsx)("label",{style:{fontSize:"16px"},children:"백업 검증"}),(0,i.jsx)("input",{type:"checkbox",checked:e.backup_verification,onChange:e=>b({backup_verification:e.target.checked}),style:{width:"20px",height:"20px"}})]})]})]})]}),(0,i.jsxs)("div",{style:{marginBottom:"32px"},children:[(0,i.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:"600"},children:"\uD83D\uDCBE 수동 백업"}),(0,i.jsx)("button",{onClick:y,disabled:s,style:{width:"100%",padding:"16px",backgroundColor:"#10B981",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"600",cursor:s?"not-allowed":"pointer",opacity:s?.6:1},children:s?"백업 중...":"지금 백업하기"})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("h3",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:"600"},children:["\uD83D\uDCCB 백업 목록 (",r.length,"개)"]}),0===r.length?(0,i.jsx)("div",{style:{textAlign:"center",padding:"40px",color:"#9CA3AF",fontSize:"16px"},children:"아직 백업이 없습니다."}):(0,i.jsx)("div",{style:{display:"grid",gap:"16px"},children:r.map(e=>(0,i.jsxs)("div",{style:{backgroundColor:"#374151",borderRadius:"12px",padding:"20px",border:"1px solid #4B5563"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"12px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"4px"},children:e.backup_id}),(0,i.jsx)("div",{style:{fontSize:"14px",color:"#9CA3AF"},children:new Date(e.created_at).toLocaleString("ko-KR")})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,i.jsx)("button",{onClick:()=>v(e.backup_id),disabled:s,style:{padding:"8px 12px",backgroundColor:"#3B82F6",color:"white",border:"none",borderRadius:"6px",fontSize:"14px",cursor:s?"not-allowed":"pointer",opacity:s?.6:1},children:"복구"}),(0,i.jsx)("button",{onClick:()=>j(e.backup_id),disabled:s,style:{padding:"8px 12px",backgroundColor:"#EF4444",color:"white",border:"none",borderRadius:"6px",fontSize:"14px",cursor:s?"not-allowed":"pointer",opacity:s?.6:1},children:"삭제"})]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"12px",fontSize:"14px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{style:{color:"#9CA3AF"},children:"파일 크기:"}),(0,i.jsx)("span",{style:{marginLeft:"8px"},children:(e=>{if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]})(e.metadata.total_size)})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{style:{color:"#9CA3AF"},children:"보틀:"}),(0,i.jsxs)("span",{style:{marginLeft:"8px"},children:[e.metadata.record_counts.bottles,"개"]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{style:{color:"#9CA3AF"},children:"시음:"}),(0,i.jsxs)("span",{style:{marginLeft:"8px"},children:[e.metadata.record_counts.tastings,"개"]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{style:{color:"#9CA3AF"},children:"위시리스트:"}),(0,i.jsxs)("span",{style:{marginLeft:"8px"},children:[e.metadata.record_counts.wishlist,"개"]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{style:{color:"#9CA3AF"},children:"증분 백업:"}),(0,i.jsx)("span",{style:{marginLeft:"8px",color:e.metadata.is_incremental?"#10B981":"#EF4444"},children:e.metadata.is_incremental?"예":"아니오"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{style:{color:"#9CA3AF"},children:"버전:"}),(0,i.jsx)("span",{style:{marginLeft:"8px"},children:e.metadata.version})]})]}),e.metadata.is_incremental&&(0,i.jsxs)("div",{style:{marginTop:"12px",padding:"12px",backgroundColor:"#1F2937",borderRadius:"8px"},children:[(0,i.jsx)("div",{style:{fontSize:"14px",fontWeight:"600",marginBottom:"8px",color:"#60A5FA"},children:"\uD83D\uDCCA 변경사항"}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"8px",fontSize:"12px"},children:[(0,i.jsxs)("div",{children:["보틀 추가: ",e.metadata.changes_since_last.bottles_added]}),(0,i.jsxs)("div",{children:["보틀 수정: ",e.metadata.changes_since_last.bottles_updated]}),(0,i.jsxs)("div",{children:["보틀 삭제: ",e.metadata.changes_since_last.bottles_deleted]}),(0,i.jsxs)("div",{children:["시음 추가: ",e.metadata.changes_since_last.tastings_added]}),(0,i.jsxs)("div",{children:["시음 수정: ",e.metadata.changes_since_last.tastings_updated]}),(0,i.jsxs)("div",{children:["시음 삭제: ",e.metadata.changes_since_last.tastings_deleted]})]})]})]},e.id))})]})]})}function ei(e){var t;let{user:n,onBrandsUpdate:r,brands:a}=e,[s,d]=(0,o.useState)([]),[c,p]=(0,o.useState)(!0),{isMobile:x}=y(),[u,g]=(0,o.useState)(!1),[h,b]=(0,o.useState)(null),[m,v]=(0,o.useState)(""),{showToast:j}=(0,f.d)(),[_,w]=(0,o.useState)({name:"",country:"",region:"",description:""}),[C,k]=(0,o.useState)(!1),[S,D]=(0,o.useState)(!1),B=["스코틀랜드","아일랜드","미국","캐나다","일본","인도","대만","호주","프랑스","독일","스웨덴","네덜란드","기타"],z={스코틀랜드:["스페이사이드 (Speyside)","하이랜드 (Highland)","아일라 (Islay)","캠벨타운 (Campbeltown)","로우랜드 (Lowland)","아일랜드 (Islands)","기타"],일본:["홋카이도 (Hokkaido)","혼슈 (Honshu)","시코쿠 (Shikoku)","큐슈 (Kyushu)","기타"],미국:["켄터키 (Kentucky)","테네시 (Tennessee)","인디애나 (Indiana)","기타"],아일랜드:["코크 (Cork)","더블린 (Dublin)","기타"],캐나다:["앨버타 (Alberta)","온타리오 (Ontario)","기타"],인도:["고아 (Goa)","기타"],대만:["난터우 (Nantou)","기타"],호주:["태즈메이니아 (Tasmania)","기타"],프랑스:["코냑 (Cognac)","아르마냑 (Armagnac)","기타"],독일:["바이에른 (Bavaria)","기타"],스웨덴:["스톡홀름 (Stockholm)","기타"],네덜란드:["기타"],기타:["기타"]};(0,o.useEffect)(()=>{n&&!a?F():a&&(d(a),p(!1))},[n,a]);let F=async()=>{try{p(!0);let{data:e,error:t}=await l.supabase.from("brands").select("*").order("name");if(t)throw t;d(e||[])}catch(e){j("브랜드 목록을 불러오는 중 오류가 발생했습니다.","error")}finally{p(!1)}},R=async e=>{if(e.preventDefault(),!_.name.trim())return void j("브랜드명을 입력해주세요.","error");try{if(h){let{error:e}=await l.supabase.from("brands").update({name:_.name.trim(),country:_.country.trim()||null,region:_.region.trim()||null,description:_.description.trim()||null}).eq("id",h.id);if(e)throw e;j("브랜드가 성공적으로 수정되었습니다!","success");let t={...h,name:_.name.trim(),country:_.country.trim()||null,region:_.region.trim()||null,description:_.description.trim()||null,updated_at:new Date().toISOString()};d(e=>e.map(e=>e.id===h.id?t:e)),r&&r(t)}else{let e=_.name.trim(),{data:t,error:n}=await l.supabase.from("brands").select("id, name").ilike("name",e);if(n)throw n;if(t&&t.length>0){let e=t[0].name;j('"'.concat(e,'" 브랜드가 이미 존재합니다. 다른 이름을 사용해주세요.'),"error");return}let{data:i,error:a}=await l.supabase.from("brands").insert({name:e,country:_.country.trim()||null,region:_.region.trim()||null,description:_.description.trim()||null}).select().single();if(a)throw a;if(j("브랜드가 성공적으로 추가되었습니다!","success"),i){let e={...i,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};d(t=>[...t,e]),r&&r(e)}}W()}catch(e){e&&"object"==typeof e&&"code"in e&&"23505"===e.code?j("같은 이름의 브랜드가 이미 존재합니다. 다른 이름을 사용해주세요.","error"):j("브랜드 저장 중 오류가 발생했습니다.","error")}},A=async(e,t)=>{let i=s.find(t=>t.id===e);if(i&&i.user_id&&i.user_id!==n.id)return void j("다른 사용자가 생성한 브랜드는 삭제할 수 없습니다.","error");if(confirm('정말로 "'.concat(t,'" 브랜드를 삭제하시겠습니까?\n\n⚠️ 주의: 이 브랜드를 사용하는 위스키들이 있다면 영향을 받을 수 있습니다.')))try{let{error:t}=await l.supabase.from("brands").delete().eq("id",e);if(t)throw t;d(t=>t.filter(t=>t.id!==e)),r&&r(void 0,e),j("브랜드가 성공적으로 삭제되었습니다!","success")}catch(e){j("브랜드 삭제 중 오류가 발생했습니다.","error")}},W=()=>{g(!1),b(null),w({name:"",country:"",region:"",description:""}),k(!1),D(!1)},I=s.filter(e=>e.name.toLowerCase().includes(m.toLowerCase())||e.country&&e.country.toLowerCase().includes(m.toLowerCase())||e.region&&e.region.toLowerCase().includes(m.toLowerCase()));return c?(0,i.jsx)("div",{style:{padding:"20px"},children:(0,i.jsx)("div",{style:{textAlign:"center",color:"#9CA3AF"},children:"브랜드 목록을 불러오는 중..."})}):(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[(0,i.jsxs)("div",{style:{fontSize:"14px",color:"#9CA3AF"},children:["총 ",s.length,"개 브랜드"]}),(0,i.jsx)("button",{onClick:()=>g(!0),style:{padding:"8px 16px",backgroundColor:"#3B82F6",border:"none",borderRadius:"6px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:"브랜드 추가"})]}),(0,i.jsx)("div",{style:{marginBottom:"16px"},children:(0,i.jsx)("input",{type:"text",placeholder:"브랜드명, 국가, 지역으로 검색...",value:m,onChange:e=>v(e.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #374151",borderRadius:"6px",backgroundColor:"#1F2937",color:"white",fontSize:"14px"}})}),(0,i.jsx)("div",{style:{display:"grid",gridTemplateColumns:x?"1fr":"repeat(auto-fill, minmax(250px, 1fr))",gap:x?"8px":"12px",maxHeight:"400px",overflowY:"auto",maxWidth:"100%",overflowX:"hidden"},children:I.map(e=>(0,i.jsxs)("div",{style:{backgroundColor:"#1F2937",border:"1px solid #374151",borderRadius:"8px",padding:x?"12px":"16px",transition:"all 0.2s ease",maxWidth:"100%",overflowX:"hidden"},onMouseEnter:e=>{e.currentTarget.style.borderColor="#4B5563",e.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:e=>{e.currentTarget.style.borderColor="#374151",e.currentTarget.style.transform="translateY(0)"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[(0,i.jsx)("h3",{style:{margin:0,fontSize:"16px",fontWeight:"600",color:"white"},children:e.name}),null===e.user_id?(0,i.jsx)("span",{style:{padding:"2px 6px",backgroundColor:"#059669",borderRadius:"4px",fontSize:"10px",color:"white",fontWeight:"500"},children:"기본"}):(0,i.jsx)("span",{style:{padding:"2px 6px",backgroundColor:"#3B82F6",borderRadius:"4px",fontSize:"10px",color:"white",fontWeight:"500"},children:"사용자"})]}),(e.country||e.region)&&(0,i.jsxs)("div",{style:{marginBottom:"12px",display:"flex",flexWrap:"wrap",gap:"4px"},children:[e.country&&(0,i.jsxs)("span",{style:{display:"inline-block",padding:"4px 8px",backgroundColor:"#374151",borderRadius:"4px",fontSize:x?"11px":"12px",color:"#9CA3AF",whiteSpace:"nowrap"},children:["\uD83C\uDF0D ",e.country]}),e.region&&(0,i.jsxs)("span",{style:{display:"inline-block",padding:"4px 8px",backgroundColor:"#374151",borderRadius:"4px",fontSize:x?"11px":"12px",color:"#9CA3AF",whiteSpace:"nowrap"},children:["\uD83C\uDFD4️ ",e.region]})]}),e.description&&(0,i.jsx)("p",{style:{margin:"0 0 16px 0",color:"#9CA3AF",fontSize:"14px",lineHeight:"1.5"},children:e.description}),(0,i.jsxs)("div",{style:{marginBottom:"16px",fontSize:"12px",color:"#6B7280"},children:["생성일: ",new Date(e.created_at).toLocaleDateString("ko-KR")]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,i.jsx)("button",{onClick:()=>(e=>{var t;if(e.user_id&&e.user_id!==n.id)return void j("다른 사용자가 생성한 브랜드는 수정할 수 없습니다.","error");b(e),w({name:e.name,country:e.country||"",region:e.region||"",description:e.description||""}),k(!!e.country&&!B.includes(e.country)),D(!!e.region&&!(null==(t=z[e.country])?void 0:t.includes(e.region))),g(!0)})(e),style:{flex:1,padding:"8px 12px",backgroundColor:"#3B82F6",border:"none",borderRadius:"6px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"500"},title:"브랜드 수정",children:"수정"}),(0,i.jsx)("button",{onClick:()=>A(e.id,e.name),disabled:null===e.user_id,style:{flex:1,padding:"8px 12px",backgroundColor:null===e.user_id?"#6B7280":"#EF4444",border:"none",borderRadius:"6px",color:"white",cursor:null===e.user_id?"not-allowed":"pointer",fontSize:"14px",fontWeight:"500",opacity:null===e.user_id?.5:1},title:null===e.user_id?"기본 브랜드는 삭제할 수 없습니다":"브랜드 삭제",children:"삭제"})]})]},e.id))}),u&&(0,i.jsx)(M,{isOpen:u,onClose:()=>g(!1),title:h?"브랜드 수정":"브랜드 추가",size:"sm",variant:"form",children:(0,i.jsxs)("form",{onSubmit:R,children:[(0,i.jsx)(L,{label:"브랜드명",value:_.name,onChange:e=>w(t=>({...t,name:e})),placeholder:"예: Macallan",required:!0}),(0,i.jsxs)("div",{style:{marginBottom:"var(--spacing-md)"},children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"var(--spacing-sm)",fontSize:"14px",color:"var(--color-text-muted)",fontWeight:"500"},children:"국가"}),(0,i.jsxs)("select",{value:_.country,onChange:e=>{let t=e.target.value;w(e=>({...e,country:t,region:""}))},style:{width:"100%",padding:"10px 12px",border:"1px solid var(--color-border-primary)",borderRadius:"var(--radius-sm)",backgroundColor:"var(--color-bg-secondary)",color:"var(--color-text-primary)",fontSize:"14px"},children:[(0,i.jsx)("option",{value:"",children:"국가 선택"}),B.map(e=>(0,i.jsx)("option",{value:e,children:e},e))]})]}),(0,i.jsxs)("div",{style:{marginBottom:"var(--spacing-md)"},children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"var(--spacing-sm)",fontSize:"14px",color:"var(--color-text-muted)",fontWeight:"500"},children:"지역"}),(0,i.jsxs)("select",{value:_.region,onChange:e=>w(t=>({...t,region:e.target.value})),disabled:!_.country,style:{width:"100%",padding:"10px 12px",border:"1px solid var(--color-border-primary)",borderRadius:"var(--radius-sm)",backgroundColor:"var(--color-bg-secondary)",color:"var(--color-text-primary)",fontSize:"14px",opacity:_.country?1:.5},children:[(0,i.jsx)("option",{value:"",children:"지역 선택"}),_.country&&(null==(t=z[_.country])?void 0:t.map(e=>(0,i.jsx)("option",{value:e,children:e},e)))]})]}),(0,i.jsxs)("div",{style:{marginBottom:"var(--spacing-lg)"},children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"var(--spacing-sm)",fontSize:"14px",color:"var(--color-text-muted)",fontWeight:"500"},children:"설명"}),(0,i.jsx)("textarea",{value:_.description,onChange:e=>w(t=>({...t,description:e.target.value})),style:{width:"100%",padding:"10px 12px",border:"1px solid var(--color-border-primary)",borderRadius:"var(--radius-sm)",backgroundColor:"var(--color-bg-secondary)",color:"var(--color-text-primary)",fontSize:"14px",minHeight:"100px",resize:"vertical"},placeholder:"브랜드에 대한 간단한 설명을 입력하세요..."})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"var(--spacing-md)"},children:[(0,i.jsx)(N,{variant:"secondary",onClick:W,children:"취소"}),(0,i.jsx)(N,{variant:"primary",type:"submit",children:h?"수정":"추가"})]})]})})]})}function er(e){let{user:t,onBrandsUpdate:n,brands:r}=e,[a,s]=(0,o.useState)(!1),[d,c]=(0,o.useState)(""),{isMobile:p}=y();return(0,i.jsxs)("div",{style:{padding:p?"16px":"20px",maxWidth:"100%",overflowX:"hidden"},children:[(0,i.jsx)("h2",{style:{margin:"0 0 20px 0",fontSize:p?"20px":"24px",fontWeight:"700",color:"white",wordBreak:"keep-all"},children:"데이터 관리"}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:p?"1fr":"repeat(auto-fit, minmax(400px, 1fr))",gap:p?"16px":"20px",maxWidth:"100%",overflowX:"hidden"},children:[(0,i.jsxs)("div",{style:{backgroundColor:"#1F2937",borderRadius:"12px",padding:p?"16px":"20px",border:"1px solid #374151",height:"fit-content",maxWidth:"100%",overflowX:"hidden"},children:[(0,i.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:p?"16px":"18px",color:"white",wordBreak:"keep-all"},children:"\uD83C\uDFF7️ 브랜드 관리"}),(0,i.jsx)(ei,{user:t,onBrandsUpdate:n,brands:r})]}),(0,i.jsxs)("div",{style:{backgroundColor:"#1F2937",borderRadius:"12px",padding:p?"16px":"20px",border:"1px solid #374151",height:"fit-content",maxWidth:"100%",overflowX:"hidden"},children:[(0,i.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:p?"16px":"18px",color:"white",wordBreak:"keep-all"},children:"\uD83D\uDCBE 백업 관리"}),(0,i.jsx)(en,{})]}),(0,i.jsxs)("div",{style:{backgroundColor:"#1F2937",borderRadius:"12px",padding:p?"16px":"20px",border:"1px solid #374151",height:"fit-content",maxWidth:"100%",overflowX:"hidden"},children:[(0,i.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:p?"16px":"18px",color:"white",wordBreak:"keep-all"},children:"\uD83D\uDCE4 데이터 내보내기"}),(0,i.jsx)(U,{user:t,loading:a,setLoading:s,setMessage:c,supabase:l.supabase})]}),(0,i.jsxs)("div",{style:{backgroundColor:"#1F2937",borderRadius:"12px",padding:p?"16px":"20px",border:"1px solid #374151",height:"fit-content",maxWidth:"100%",overflowX:"hidden"},children:[(0,i.jsx)("h3",{style:{margin:"0 0 16px 0",fontSize:p?"16px":"18px",color:"white",wordBreak:"keep-all"},children:"\uD83D\uDCE5 데이터 불러오기"}),(0,i.jsx)(et,{user:t,loading:a,setLoading:s,setMessage:c,supabase:l.supabase})]})]}),d&&(0,i.jsx)("div",{style:{marginTop:"20px",padding:"12px 16px",backgroundColor:"#10B981",color:"white",borderRadius:"8px",fontSize:"14px",wordBreak:"keep-all"},children:d})]})}function ea(e){let{tabs:t,activeTab:n,onTabChange:r,zIndex:a=1e3}=e;return(0,i.jsx)("div",{className:"mobile-nav-fixed",style:{position:"fixed",bottom:0,left:0,right:0,backgroundColor:"#1F2937",borderTop:"1px solid #374151",padding:"8px 0 6px 0",zIndex:a,display:"flex",justifyContent:"space-around",alignItems:"center",paddingBottom:"calc(6px + env(safe-area-inset-bottom))",boxShadow:"0 -4px 6px -1px rgba(0, 0, 0, 0.1)",transform:"translateZ(0)",willChange:"transform",height:"calc(52px + env(safe-area-inset-bottom))",minHeight:"calc(52px + env(safe-area-inset-bottom))",maxHeight:"calc(52px + env(safe-area-inset-bottom))",maxWidth:"100vw",width:"100%",transformOrigin:"bottom center",WebkitTransformOrigin:"bottom center"},children:t.map(e=>(0,i.jsxs)("button",{onClick:()=>r(e.id),style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"6px 8px",backgroundColor:n===e.id?"rgba(59, 130, 246, 0.1)":"transparent",border:"none",borderRadius:"8px",color:n===e.id?"#3B82F6":"#9CA3AF",fontSize:"10px",fontWeight:n===e.id?"600":"400",cursor:"pointer",minWidth:"50px",transition:"all 0.2s ease",transform:n===e.id?"scale(1.02)":"scale(1)",position:"relative"},children:[(0,i.jsx)("span",{style:{fontSize:"18px",marginBottom:"2px",filter:n===e.id?"drop-shadow(0 1px 2px rgba(59, 130, 246, 0.3))":"none"},children:e.icon}),(0,i.jsx)("span",{style:{fontSize:"10px",lineHeight:"1.1",textAlign:"center",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.label}),n===e.id&&(0,i.jsx)("div",{style:{position:"absolute",bottom:"-6px",left:"50%",transform:"translateX(-50%)",width:"3px",height:"3px",backgroundColor:"#3B82F6",borderRadius:"50%"}})]},e.id))})}function eo(e){let{tabs:t,activeTab:n,onTabChange:r}=e;return(0,i.jsx)("div",{style:{display:"flex",borderBottom:"1px solid rgba(255, 255, 255, 0.1)",backgroundColor:"#1F2937",padding:"0 20px"},children:(0,i.jsx)("div",{style:{display:"flex",gap:"8px",marginBottom:"0",overflowX:"auto",padding:"10px 0"},children:t.map(e=>(0,i.jsxs)("button",{onClick:()=>r(e.id),style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 20px",backgroundColor:n===e.id?"#3B82F6":"#374151",border:"none",borderRadius:"8px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:n===e.id?"600":"400",whiteSpace:"nowrap",transition:"all 0.2s ease",minWidth:"fit-content"},children:[(0,i.jsx)("span",{style:{fontSize:"16px"},children:e.icon}),(0,i.jsx)("span",{children:e.label})]},e.id))})})}function el(e){var t;let{user:n,onTabChange:r}=e,[s,d]=(0,o.useState)(!1),[c,p]=(0,o.useState)(!1),{isMobile:x}=y(),u=async()=>{if(confirm("정말로 로그아웃하시겠습니까?"))try{let{error:e}=await l.supabase.auth.signOut({scope:"global"});e?alert("로그아웃 중 오류가 발생했습니다."):(localStorage.clear(),sessionStorage.clear(),window.location.reload())}catch(e){alert("로그아웃 중 오류가 발생했습니다.")}},g=async()=>{if(confirm("⚠️ 경고: 데이터 초기화\n\n이 작업은 되돌릴 수 없습니다!\n\n다음 데이터가 모두 삭제됩니다:\n• 위스키 컬렉션\n• 시음 기록\n• 위시리스트\n• 브랜드 정보\n• 통계 데이터\n• 백업 데이터\n\n정말로 모든 데이터를 초기화하시겠습니까?")&&confirm("마지막 확인: 모든 데이터가 영구적으로 삭제됩니다.\n\n계속하시겠습니까?"))try{for(let e of(p(!0),["bottles","tastings","wishlist","brands","backup_metadata"])){let{error:t}=await l.supabase.from(e).delete().eq("user_id",n.id)}let{data:e,error:t}=await l.supabase.from("brands").select("*").is("user_id",null);if(!t&&e)for(let t of e){let{error:e}=await l.supabase.from("brands").insert({name:t.name,country:t.country,region:t.region,description:t.description,user_id:n.id})}alert("✅ 모든 데이터가 성공적으로 초기화되었습니다!\n\n기본 브랜드만 다시 추가되었습니다."),window.location.reload()}catch(e){alert("❌ 데이터 초기화 중 오류가 발생했습니다.\n\n잠시 후 다시 시도해주세요.")}finally{p(!1),d(!1)}},h=e=>new Date(e).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),b=e=>{var t,n;return(null==(t=e.user_metadata)?void 0:t.full_name)?e.user_metadata.full_name:(null==(n=e.user_metadata)?void 0:n.name)?e.user_metadata.name:e.email.split("@")[0]};return(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",position:"relative",flexWrap:"nowrap"},className:"jsx-37a81b79a982207d",children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:x?"6px":"8px",padding:x?"6px 10px":"8px 12px",backgroundColor:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"20px",cursor:"pointer",transition:"all 0.2s ease",flexShrink:0},onClick:()=>d(!s),className:"jsx-37a81b79a982207d",children:[(0,i.jsx)("div",{style:{width:x?"20px":"24px",height:x?"20px":"24px",borderRadius:"50%",backgroundColor:"#3B82F6",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:x?"10px":"12px",fontWeight:"600",flexShrink:0},className:"jsx-37a81b79a982207d",children:n.email.substring(0,2).toUpperCase()}),(0,i.jsxs)("div",{style:{textAlign:"left",flexShrink:1,minWidth:0},className:"jsx-37a81b79a982207d",children:[(0,i.jsx)("div",{style:{fontSize:x?"12px":"14px",fontWeight:"600",color:"white",lineHeight:"1.2",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},className:"jsx-37a81b79a982207d",children:x?b(n).substring(0,8):b(n)}),!x&&(0,i.jsx)("div",{style:{fontSize:"11px",color:"#9CA3AF",lineHeight:"1.2",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},className:"jsx-37a81b79a982207d",children:n.email.length>20?n.email.substring(0,20)+"...":n.email})]}),(0,i.jsx)("span",{style:{fontSize:"10px",color:"#9CA3AF",flexShrink:0},className:"jsx-37a81b79a982207d",children:s?"▲":"▼"})]}),(0,i.jsx)("button",{onClick:u,style:{padding:"8px 12px",backgroundColor:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.2)",borderRadius:"20px",color:"#EF4444",cursor:"pointer",fontSize:"13px",fontWeight:"500",transition:"all 0.2s ease",whiteSpace:"nowrap",minWidth:"fit-content",flexShrink:0},className:"jsx-37a81b79a982207d",children:x?"\uD83D\uDD13":"로그아웃"}),s&&(0,i.jsxs)("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"8px",backgroundColor:"#1F2937",border:"1px solid #374151",borderRadius:"12px",padding:"16px",minWidth:"320px",boxShadow:"0 10px 25px -5px rgba(0, 0, 0, 0.3)",zIndex:1e3},className:"jsx-37a81b79a982207d",children:[(0,i.jsxs)("div",{style:{marginBottom:"16px"},className:"jsx-37a81b79a982207d",children:[(0,i.jsx)("h4",{style:{fontSize:"14px",fontWeight:"600",color:"#D1D5DB",marginBottom:"8px"},className:"jsx-37a81b79a982207d",children:"계정 정보"}),(0,i.jsxs)("div",{style:{fontSize:"12px",color:"#9CA3AF"},className:"jsx-37a81b79a982207d",children:[(0,i.jsxs)("div",{style:{marginBottom:"4px"},className:"jsx-37a81b79a982207d",children:[(0,i.jsx)("strong",{className:"jsx-37a81b79a982207d",children:"가입일:"})," ",h(n.created_at)]}),(0,i.jsxs)("div",{style:{marginBottom:"4px"},className:"jsx-37a81b79a982207d",children:[(0,i.jsx)("strong",{className:"jsx-37a81b79a982207d",children:"마지막 로그인:"})," ",h(n.last_sign_in_at||n.created_at)]}),(0,i.jsxs)("div",{style:{marginBottom:"4px"},className:"jsx-37a81b79a982207d",children:[(0,i.jsx)("strong",{className:"jsx-37a81b79a982207d",children:"인증 방법:"})," ",(null==(t=n.app_metadata)?void 0:t.provider)||"이메일"]}),n.email_confirmed_at&&(0,i.jsxs)("div",{style:{marginBottom:"4px"},className:"jsx-37a81b79a982207d",children:[(0,i.jsx)("strong",{className:"jsx-37a81b79a982207d",children:"이메일 인증:"})," ",h(n.email_confirmed_at)]})]})]}),(0,i.jsxs)("div",{style:{marginBottom:"16px"},className:"jsx-37a81b79a982207d",children:[(0,i.jsx)("h4",{style:{fontSize:"14px",fontWeight:"600",color:"#D1D5DB",marginBottom:"8px"},className:"jsx-37a81b79a982207d",children:"앱 사용 정보"}),(0,i.jsxs)("div",{style:{fontSize:"12px",color:"#9CA3AF"},className:"jsx-37a81b79a982207d",children:[(0,i.jsxs)("div",{style:{marginBottom:"4px"},className:"jsx-37a81b79a982207d",children:[(0,i.jsx)("strong",{className:"jsx-37a81b79a982207d",children:"계정 상태:"}),(0,i.jsx)("span",{style:{color:"#10B981",marginLeft:"4px",fontWeight:"500"},className:"jsx-37a81b79a982207d",children:"활성"})]}),(0,i.jsxs)("div",{style:{marginBottom:"4px"},className:"jsx-37a81b79a982207d",children:[(0,i.jsx)("strong",{className:"jsx-37a81b79a982207d",children:"데이터 동기화:"}),(0,i.jsx)("span",{style:{color:"#10B981",marginLeft:"4px",fontWeight:"500"},className:"jsx-37a81b79a982207d",children:"활성화됨"})]})]})]}),(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},className:"jsx-37a81b79a982207d",children:[(0,i.jsx)("button",{onClick:()=>{d(!1),r&&r("export")},style:{width:"100%",padding:"10px 12px",backgroundColor:"rgba(59, 130, 246, 0.1)",border:"1px solid rgba(59, 130, 246, 0.2)",borderRadius:"8px",color:"#3B82F6",fontSize:"13px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="rgba(59, 130, 246, 0.2)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="rgba(59, 130, 246, 0.1)"},className:"jsx-37a81b79a982207d",children:"\uD83D\uDCCA 데이터 관리로 이동"}),(0,i.jsx)("button",{onClick:g,disabled:c,style:{width:"100%",padding:"10px 12px",backgroundColor:c?"rgba(239, 68, 68, 0.05)":"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.2)",borderRadius:"8px",color:c?"#9CA3AF":"#EF4444",fontSize:"13px",fontWeight:"500",cursor:c?"not-allowed":"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",opacity:c?.6:1},onMouseEnter:e=>{c||(e.currentTarget.style.backgroundColor="rgba(239, 68, 68, 0.2)")},onMouseLeave:e=>{c||(e.currentTarget.style.backgroundColor="rgba(239, 68, 68, 0.1)")},className:"jsx-37a81b79a982207d",children:c?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{style:{animation:"spin 1s linear infinite"},className:"jsx-37a81b79a982207d",children:"\uD83D\uDD04"}),"초기화 중..."]}):(0,i.jsx)(i.Fragment,{children:"\uD83D\uDDD1️ 데이터 초기화"})})]}),(0,i.jsx)("div",{style:{marginTop:"12px",padding:"8px 12px",backgroundColor:"rgba(239, 68, 68, 0.05)",border:"1px solid rgba(239, 68, 68, 0.1)",borderRadius:"6px",fontSize:"11px",color:"#EF4444",lineHeight:"1.4"},className:"jsx-37a81b79a982207d",children:"⚠️ 데이터 초기화는 되돌릴 수 없습니다."})]}),s&&(0,i.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:999},onClick:()=>d(!1),className:"jsx-37a81b79a982207d"}),(0,i.jsx)(a(),{id:"37a81b79a982207d",children:"@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}"})]})}function es(e){if(null==e)return null;if("number"==typeof e)return isNaN(e)?null:e;if("string"==typeof e){if(""===e.trim())return null;let t=parseInt(e.trim());return isNaN(t)?null:t}return null}function ed(e){if(null==e)return null;if("number"==typeof e)return isNaN(e)?null:e;if("string"==typeof e){if(""===e.trim())return null;let t=parseFloat(e.trim());return isNaN(t)?null:t}return null}function ec(e){return null==e?null:"number"==typeof e?e.toString():"string"==typeof e?""===e.trim()?null:e.trim():null}var ep=n(8125),ex=n(3833);function eu(e){let{imageUrl:t,onSave:n,onCancel:r,onDelete:a,aspectRatio:l=0}=e,[s,d]=(0,o.useState)({unit:"%",width:80,height:80,x:10,y:10}),[c,p]=(0,o.useState)(),x=(0,o.useRef)(null),u=async()=>{try{let e=await new Promise((e,n)=>{if(!x.current||!c)return void n(Error("이미지나 자르기 영역이 없습니다."));let i=document.createElement("canvas"),r=i.getContext("2d");if(!r)return void n(Error("Canvas 컨텍스트를 가져올 수 없습니다."));let a=x.current.naturalWidth/x.current.width,o=x.current.naturalHeight/x.current.height;i.width=c.width,i.height=c.height;try{r.drawImage(x.current,c.x*a,c.y*o,c.width*a,c.height*o,0,0,c.width,c.height),i.toBlob(t=>{t?e(t):n(Error("이미지 변환에 실패했습니다."))},"image/jpeg",.9)}catch(i){i instanceof Error&&"SecurityError"===i.name?fetch(t).then(e=>e.blob()).then(t=>{let i=new Image;i.onload=()=>{let t=document.createElement("canvas"),r=t.getContext("2d");if(!r)return void n(Error("Canvas 컨텍스트를 가져올 수 없습니다."));t.width=c.width,t.height=c.height,r.drawImage(i,c.x*a,c.y*o,c.width*a,c.height*o,0,0,c.width,c.height),t.toBlob(t=>{t?e(t):n(Error("이미지 변환에 실패했습니다."))},"image/jpeg",.9)},i.onerror=()=>n(Error("이미지 로드에 실패했습니다.")),i.src=URL.createObjectURL(t)}).catch(e=>{n(Error("이미지를 다운로드할 수 없습니다."))}):n(i)}});n(e)}catch(e){alert("이미지 자르기에 실패했습니다.")}};return(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:(0,i.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 max-w-4xl w-full max-h-[90vh] overflow-auto",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold text-white",children:"이미지 편집"}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)("button",{onClick:r,className:"px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"취소"}),(0,i.jsx)("button",{type:"button",onClick:u,className:"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:"✅ 확인"})]})]}),(0,i.jsx)("div",{className:"flex justify-center mb-4",children:(0,i.jsx)(ex.Ay,{crop:s,onChange:e=>d(e),onComplete:e=>p(e),aspect:void 0,className:"max-w-full max-h-[50vh]",children:(0,i.jsx)("img",{ref:x,src:t,alt:"편집할 이미지",crossOrigin:"anonymous",className:"max-w-full max-h-[50vh] object-contain"})})}),(0,i.jsxs)("div",{className:"text-sm text-gray-300 space-y-1",children:[(0,i.jsx)("p",{children:"• 드래그하여 자르기 영역을 조정하세요"}),(0,i.jsx)("p",{children:"• 모서리를 드래그하여 크기를 조정하세요"}),(0,i.jsx)("p",{children:"• 비율을 선택하여 위스키 보틀에 맞게 편집하세요"}),(0,i.jsxs)("p",{children:["• ",(0,i.jsx)("strong",{children:"확인"})," 버튼을 클릭하면 편집이 완료됩니다"]})]})]})})}function eg(e){let{onImageSelect:t,onImageEdit:n,onImageDelete:r,currentImage:a,disabled:l=!1}=e,[s,d]=(0,o.useState)(!1),[c,p]=(0,o.useState)(null),[x,u]=(0,o.useState)(!1),[g,h]=(0,o.useState)(null),b=(0,o.useRef)(null),m=(0,o.useRef)(null),f=(0,o.useRef)(null),y=(0,o.useRef)(null),v=e=>{var t;let n=null==(t=e.target.files)?void 0:t[0];n&&(h(URL.createObjectURL(n)),u(!0))},j=async()=>{try{if(p(null),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw Error("이 브라우저는 카메라를 지원하지 않습니다.");let e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1280,max:1920},height:{ideal:720,max:1080}}});f.current&&(f.current.srcObject=e,await f.current.play(),d(!0))}catch(t){let e="카메라에 접근할 수 없습니다.";t instanceof Error&&(e="NotAllowedError"===t.name?"카메라 접근 권한이 거부되었습니다. 브라우저 설정에서 카메라 권한을 허용해주세요.":"NotFoundError"===t.name?"카메라를 찾을 수 없습니다.":"NotSupportedError"===t.name?"이 브라우저는 카메라를 지원하지 않습니다.":"카메라 오류: ".concat(t.message)),p(e),setTimeout(()=>p(null),5e3)}},_=()=>{var e;(null==(e=f.current)?void 0:e.srcObject)&&(f.current.srcObject.getTracks().forEach(e=>e.stop()),f.current.srcObject=null),d(!1),p(null)},w=()=>{var e;null==(e=b.current)||e.click()};return(0,i.jsxs)("div",{style:{width:"100%"},children:[a&&!s&&(0,i.jsxs)("div",{style:{position:"relative",marginBottom:"16px",borderRadius:"12px",overflow:"hidden",backgroundColor:"#374151"},children:[(0,i.jsx)("img",{src:a,alt:"위스키 이미지",style:{width:"100%",height:"200px",objectFit:"cover"}}),(0,i.jsxs)("div",{style:{position:"absolute",top:"8px",right:"8px",display:"flex",gap:"8px",zIndex:10},children:[(0,i.jsx)("button",{onClick:()=>{a&&(h(a),u(!0))},disabled:l,style:{backgroundColor:"rgba(59, 130, 246, 0.95)",color:"white",border:"2px solid rgba(255, 255, 255, 0.3)",borderRadius:"8px",padding:"10px 14px",cursor:l?"not-allowed":"pointer",fontSize:"14px",display:"flex",alignItems:"center",gap:"6px",fontWeight:"600",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",backdropFilter:"blur(10px)",transition:"all 0.2s ease"},onMouseEnter:e=>{l||(e.currentTarget.style.backgroundColor="rgba(59, 130, 246, 1)",e.currentTarget.style.transform="scale(1.05)")},onMouseLeave:e=>{l||(e.currentTarget.style.backgroundColor="rgba(59, 130, 246, 0.95)",e.currentTarget.style.transform="scale(1)")},children:"✂️ 편집"}),(0,i.jsx)("button",{onClick:w,disabled:l,style:{backgroundColor:"rgba(16, 185, 129, 0.9)",color:"white",border:"none",borderRadius:"8px",padding:"8px 12px",cursor:l?"not-allowed":"pointer",fontSize:"14px",display:"flex",alignItems:"center",gap:"6px",fontWeight:"600"},children:"\uD83D\uDCF7 새로"}),r&&(0,i.jsx)("button",{onClick:r,disabled:l,style:{backgroundColor:"rgba(239, 68, 68, 0.9)",color:"white",border:"none",borderRadius:"8px",padding:"8px 12px",cursor:l?"not-allowed":"pointer",fontSize:"14px",display:"flex",alignItems:"center",gap:"6px",fontWeight:"600"},children:"\uD83D\uDDD1️ 삭제"})]})]}),c&&(0,i.jsx)("div",{style:{padding:"12px",marginBottom:"16px",backgroundColor:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"8px",color:"#ef4444",fontSize:"14px",textAlign:"center"},children:c}),s&&(0,i.jsxs)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"black",zIndex:9999,display:"flex",flexDirection:"column"},children:[(0,i.jsx)("video",{ref:f,autoPlay:!0,playsInline:!0,muted:!0,style:{flex:1,width:"100%",objectFit:"cover"}}),(0,i.jsx)("canvas",{ref:y,style:{display:"none"}}),(0,i.jsxs)("div",{style:{position:"absolute",bottom:"40px",left:"50%",transform:"translateX(-50%)",display:"flex",gap:"20px",alignItems:"center"},children:[(0,i.jsx)("button",{type:"button",onClick:_,style:{backgroundColor:"#EF4444",color:"white",border:"none",borderRadius:"50%",width:"60px",height:"60px",fontSize:"24px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:"❌"}),(0,i.jsx)("button",{type:"button",onClick:()=>{if(f.current&&y.current){let e=f.current,t=y.current,n=t.getContext("2d");if(n){t.width=e.videoWidth,t.height=e.videoHeight;try{n.drawImage(e,0,0),t.toBlob(e=>{if(e){let t=URL.createObjectURL(e);h(t),u(!0),_()}else alert("이미지 캡처에 실패했습니다.")},"image/jpeg",.8)}catch(e){alert("이미지 캡처 중 오류가 발생했습니다.")}}}},style:{backgroundColor:"#10B981",color:"white",border:"4px solid white",borderRadius:"50%",width:"80px",height:"80px",fontSize:"32px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:"\uD83D\uDCF8"})]})]}),!s&&(0,i.jsxs)("div",{style:{display:"flex",gap:"12px",marginBottom:"16px"},children:[(0,i.jsx)("button",{type:"button",onClick:()=>{m.current?m.current.click():j()},disabled:l,style:{flex:1,padding:"16px",backgroundColor:"#3B82F6",color:"white",border:"none",borderRadius:"12px",fontSize:"16px",cursor:l?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",opacity:l?.6:1},children:"\uD83D\uDCF7 카메라"}),(0,i.jsx)("button",{type:"button",onClick:w,disabled:l,style:{flex:1,padding:"16px",backgroundColor:"#10B981",color:"white",border:"none",borderRadius:"12px",fontSize:"16px",cursor:l?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",opacity:l?.6:1},children:"\uD83D\uDCC1 갤러리"})]}),(0,i.jsx)("input",{ref:b,type:"file",accept:"image/*",onChange:v,style:{display:"none"}}),(0,i.jsx)("input",{ref:m,type:"file",accept:"image/*",capture:"environment",onChange:v,style:{display:"none"}}),x&&g&&(0,i.jsx)(eu,{imageUrl:g,onSave:e=>{let i=new File([e],"edited-image.jpg",{type:"image/jpeg",lastModified:Date.now()});n?n(i):t(i),u(!1),g&&(URL.revokeObjectURL(g),h(null))},onCancel:()=>{u(!1),g&&(URL.revokeObjectURL(g),h(null)),b.current&&(b.current.value="")},onDelete:r})]})}function eh(e){let{onImageSelect:t,onImageEdit:n,onImageDelete:r,currentImage:a,disabled:l=!1}=e,s=(0,o.useRef)(null),[d,c]=(0,o.useState)(!1),[p,x]=(0,o.useState)(null);return(0,i.jsxs)("div",{style:{width:"100%"},children:[a&&(0,i.jsxs)("div",{style:{position:"relative",marginBottom:"16px",borderRadius:"12px",overflow:"hidden",backgroundColor:"#374151",border:"2px dashed #6B7280"},children:[(0,i.jsx)("img",{src:a,alt:"위스키 이미지",style:{width:"100%",height:"300px",objectFit:"cover"}}),(0,i.jsxs)("div",{style:{position:"absolute",top:"12px",right:"12px",display:"flex",gap:"8px"},children:[(0,i.jsx)("button",{type:"button",onClick:()=>{a&&(x(a),c(!0))},disabled:l||!a,style:{backgroundColor:a?"rgba(59, 130, 246, 0.9)":"rgba(107, 114, 128, 0.5)",color:"white",border:"none",borderRadius:"8px",padding:"8px 12px",cursor:l||!a?"not-allowed":"pointer",fontSize:"14px",display:"flex",alignItems:"center",gap:"6px",fontWeight:"600"},children:"✂️ 자르기"}),(0,i.jsx)("button",{type:"button",onClick:()=>{var e;return null==(e=s.current)?void 0:e.click()},disabled:l,style:{backgroundColor:"rgba(16, 185, 129, 0.9)",color:"white",border:"none",borderRadius:"8px",padding:"8px 12px",cursor:l?"not-allowed":"pointer",fontSize:"14px",display:"flex",alignItems:"center",gap:"6px",fontWeight:"600"},children:"\uD83D\uDCF7 새로"}),r&&(0,i.jsx)("button",{type:"button",onClick:r,disabled:l,style:{backgroundColor:"rgba(239, 68, 68, 0.9)",color:"white",border:"none",borderRadius:"8px",padding:"8px 12px",cursor:l?"not-allowed":"pointer",fontSize:"14px",display:"flex",alignItems:"center",gap:"6px",fontWeight:"600"},children:"\uD83D\uDDD1️ 삭제"})]})]}),!a&&(0,i.jsxs)("div",{onDragOver:e=>{e.preventDefault()},onDrop:e=>{e.preventDefault();let t=e.dataTransfer.files;if(t.length>0){let e=t[0];x(URL.createObjectURL(e)),c(!0)}},onClick:()=>{var e;return null==(e=s.current)?void 0:e.click()},style:{border:"2px dashed #6B7280",borderRadius:"12px",padding:"40px 20px",textAlign:"center",backgroundColor:"#374151",cursor:l?"not-allowed":"pointer",transition:"all 0.2s ease",marginBottom:"16px"},children:[(0,i.jsx)("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"\uD83D\uDCF7"}),(0,i.jsx)("div",{style:{fontSize:"18px",color:"white",marginBottom:"8px",fontWeight:"600"},children:"이미지를 여기에 드래그하거나 클릭하세요"}),(0,i.jsx)("div",{style:{fontSize:"14px",color:"#9CA3AF"},children:"JPG, PNG, GIF 파일 지원 (최대 5MB)"}),(0,i.jsx)("div",{style:{fontSize:"12px",color:"#6B7280",marginTop:"8px"},children:"✨ 선택 후 편집 가능"})]}),(0,i.jsx)("button",{type:"button",onClick:()=>{var e;return null==(e=s.current)?void 0:e.click()},disabled:l,style:{width:"100%",padding:"12px 20px",backgroundColor:"#3B82F6",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",cursor:l?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",opacity:l?.6:1},children:"\uD83D\uDCC1 파일 선택"}),(0,i.jsx)("input",{ref:s,type:"file",accept:"image/*",onChange:e=>{var t;let n=null==(t=e.target.files)?void 0:t[0];n&&(x(URL.createObjectURL(n)),c(!0))},style:{display:"none"}}),d&&p&&(0,i.jsx)(eu,{imageUrl:p,onSave:e=>{let i=new File([e],"edited-image.jpg",{type:"image/jpeg",lastModified:Date.now()});n?n(i):t(i),c(!1),p&&(URL.revokeObjectURL(p),x(null))},onCancel:()=>{c(!1),p&&(URL.revokeObjectURL(p),x(null)),s.current&&(s.current.value="")},onDelete:r,aspectRatio:1})]})}function eb(e){let{isMobile:t}=y(),n={...e,currentImage:e.preview||e.currentImage||null};return t?(0,i.jsx)(eg,{...n}):(0,i.jsx)(eh,{...n})}function em(e){let{size:t="md",color:n="primary",text:r,className:a=""}=e;return(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center ".concat(a),children:[(0,i.jsx)("div",{className:"\n          ".concat({sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8"}[t],"\n          ").concat({primary:"border-blue-500 border-t-transparent",secondary:"border-gray-500 border-t-transparent",white:"border-white border-t-transparent"}[n],"\n          border-2 rounded-full animate-spin\n        ")}),r&&(0,i.jsx)("p",{className:"mt-2 text-sm text-gray-500 animate-pulse",children:r})]})}function ef(e){let{text:t="처리 중..."}=e;return(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(em,{size:"sm",color:"white"}),(0,i.jsx)("span",{children:t})]})}function ey(e){let{count:t=5}=e;return(0,i.jsx)("div",{className:"space-y-3",children:Array.from({length:t}).map((e,t)=>(0,i.jsxs)("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg animate-pulse",children:[(0,i.jsx)("div",{className:"w-12 h-12 bg-gray-300 rounded"}),(0,i.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,i.jsx)("div",{className:"h-4 bg-gray-300 rounded w-3/4"}),(0,i.jsx)("div",{className:"h-3 bg-gray-300 rounded w-1/2"}),(0,i.jsx)("div",{className:"h-3 bg-gray-300 rounded w-1/3"})]}),(0,i.jsx)("div",{className:"w-16 h-8 bg-gray-300 rounded"})]},t))})}function ev(e){let{onSelectWhisky:t,disabled:n=!1,initialSearchTerm:r=""}=e,[a,l]=(0,o.useState)(r),[s,d]=(0,o.useState)(!1),[c,p]=(0,o.useState)([]),[x,u]=(0,o.useState)(!1),[g,h]=(0,o.useState)([]),[b,m]=(0,o.useState)(!1),{showToast:y}=(0,f.d)();(0,o.useEffect)(()=>{r&&l(r)},[r]);let v=async()=>{if(!a.trim())return void y("검색어를 입력해주세요.","error");d(!0),p([]),u(!0);try{let n,i=await fetch("/api/whiskybase-db?q=".concat(encodeURIComponent(a),"&debug=true")),r="database";if(i.ok||(i=await fetch("/api/whiskybase?q=".concat(encodeURIComponent(a),"&debug=true")),r="whiskybase"),!i.ok)throw Error("검색 요청에 실패했습니다.");let o=(n=await i.json()).results||[];if(p(o),n.debug,h(o),m(!1),o.length>0&&o[0].brand&&l(o[0].brand),0===o.length)y("검색 결과가 없습니다.","info");else if("database"===r)y("✅ 데이터베이스에서 ".concat(o.length,"개의 결과를 찾았습니다."),"success");else{var e,t;(null==(t=o[0])||null==(e=t.id)?void 0:e.startsWith("wb_"))?y("✅ Whiskybase에서 ".concat(o.length,"개의 결과를 찾았습니다."),"success"):(y("⚠️ Whiskybase 접근이 제한되어 더미 데이터를 제공합니다.","warning"),y("".concat(o.length,"개의 샘플 결과를 찾았습니다."),"info"))}}catch(e){y("검색 중 오류가 발생했습니다.","error")}finally{d(!1)}},j=e=>{t(e),u(!1),l(e.brand||e.name),p([])};return(0,i.jsxs)("div",{style:{position:"relative",width:"100%"},children:[(0,i.jsxs)("div",{style:{display:"flex",gap:"8px",marginBottom:"8px"},children:[(0,i.jsx)("input",{type:"text",placeholder:"Whiskybase에서 위스키 검색 (접근 제한 시 샘플 데이터 제공)...",value:a,onChange:e=>l(e.target.value),onKeyPress:e=>{"Enter"===e.key&&v()},disabled:n||s,className:"\n            flex-1 px-3 py-2 border rounded-lg text-sm transition-all duration-200\n            ".concat(n||s?"bg-gray-700 border-gray-600 text-gray-400 cursor-not-allowed":"bg-gray-800 border-gray-600 text-white focus:border-blue-500 focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50","\n          ")}),(0,i.jsx)("button",{onClick:v,disabled:n||s||!a.trim(),className:"\n            px-4 py-2 rounded-lg font-medium text-sm transition-all duration-200\n            ".concat(s||n||!a.trim()?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 active:bg-blue-800 cursor-pointer shadow-md hover:shadow-lg","\n            flex items-center gap-2\n          "),children:s?(0,i.jsx)(ef,{text:"검색중..."}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"text-lg",children:"\uD83D\uDD0D"}),"검색"]})})]}),x&&(0,i.jsx)("div",{className:"absolute top-full left-0 right-0 bg-gray-800 border border-gray-600 rounded-lg z-[1000] shadow-2xl",style:{maxHeight:"400px",overflowY:"auto",overflowX:"hidden"},children:s?(0,i.jsx)("div",{className:"p-4",children:(0,i.jsx)(ey,{count:3})}):g.length>0?(0,i.jsx)(i.Fragment,{children:g.map(e=>(0,i.jsx)("div",{onClick:()=>j(e),className:"p-4 border-b border-gray-600 cursor-pointer transition-all duration-200 hover:bg-gray-700 active:bg-gray-600",children:(0,i.jsxs)("div",{className:"flex gap-3 items-start",children:[(0,i.jsx)("div",{className:"w-10 h-10 bg-gray-600 rounded-lg flex items-center justify-center text-lg flex-shrink-0",children:"\uD83E\uDD43"}),(0,i.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,i.jsx)("h4",{className:"text-sm font-semibold text-white truncate",children:e.name}),!e.id.startsWith("wb_")&&(0,i.jsx)("span",{className:"text-xs bg-yellow-500 text-white px-2 py-1 rounded font-medium",children:"샘플"})]}),(0,i.jsxs)("p",{className:"text-xs text-gray-400 mb-1",children:[e.brand," • ",e.type]}),(0,i.jsxs)("div",{className:"flex flex-wrap gap-2 text-xs text-gray-400",children:[e.vintage&&(0,i.jsxs)("span",{className:"bg-gray-700 px-2 py-1 rounded",children:["\uD83C\uDF47 ",e.vintage,"년 빈티지"]}),e.bottled_year&&(0,i.jsxs)("span",{className:"bg-gray-700 px-2 py-1 rounded",children:["\uD83D\uDCC5 ",e.bottled_year,"년 병입"]}),e.age&&(0,i.jsxs)("span",{className:"bg-gray-700 px-2 py-1 rounded",children:["⏰ ",e.age,"년"]}),e.volume_ml&&(0,i.jsxs)("span",{className:"bg-gray-700 px-2 py-1 rounded",children:["\uD83C\uDF7E ",e.volume_ml,"ml"]}),e.cask_number&&(0,i.jsxs)("span",{className:"bg-gray-700 px-2 py-1 rounded",children:["\uD83D\uDD22 ",e.cask_number]}),e.abv&&(0,i.jsxs)("span",{className:"bg-gray-700 px-2 py-1 rounded",children:["\uD83C\uDF7E ",e.abv]}),e.region&&(0,i.jsxs)("span",{className:"bg-gray-700 px-2 py-1 rounded",children:["\uD83C\uDFD4️ ",e.region]}),e.rating&&(0,i.jsxs)("span",{className:"bg-yellow-600 px-2 py-1 rounded text-yellow-100",children:["⭐ ",e.rating]})]})]}),(0,i.jsx)("button",{onClick:t=>{t.stopPropagation(),j(e)},className:"px-3 py-1 bg-green-600 hover:bg-green-700 active:bg-green-800 text-white text-xs font-medium rounded transition-colors duration-200",children:"선택"})]})},e.id))}):(0,i.jsx)("div",{className:"p-8 text-center text-gray-400 text-sm",children:s?(0,i.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,i.jsx)(em,{size:"sm",color:"secondary"}),(0,i.jsx)("span",{children:"검색 중..."})]}):(0,i.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,i.jsx)("span",{className:"text-2xl",children:"\uD83D\uDD0D"}),(0,i.jsx)("span",{children:"검색 결과가 없습니다."})]})})}),x&&(0,i.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:998},onClick:()=>u(!1)})]})}function ej(e,t,n,i){let r=Error(e);return r.code=t,r.status=n,r.context=i,r}function e_(e){return e instanceof Error?e:"string"==typeof e?ej(e):e&&"object"==typeof e&&"message"in e?ej(String(e.message),"code"in e?String(e.code):void 0,"status"in e?Number(e.status):void 0,"context"in e?e.context:void 0):ej("알 수 없는 오류가 발생했습니다")}function ew(e){var t;let{user:n,brands:r,editingBottle:a,onClose:s,onBottleSaved:d}=e,[c,p]=(0,o.useState)({name:"",brand_id:"",custom_brand:"",vintage:"",age_years:"",retail_price:"",purchase_price:"",discount_rate:"",purchase_location:"",purchase_date:"",total_volume_ml:"750",remaining_volume_ml:"750",notes:"",abv:"",type:"Single Malt",whiskybase_rating:"",cask_type:"",bottled_year:"",description:"",whiskybase_url:""}),[x,u]=(0,o.useState)(null),[g,h]=(0,o.useState)(null),[b,m]=(0,o.useState)(!1),[f,y]=(0,o.useState)(null),[v,j]=(0,o.useState)(!1);(0,o.useEffect)(()=>{if(a){var e,t,n,i,r,o,l,s,d,c;let x=a.brand_id||"";p({name:a.name||"",brand_id:x,custom_brand:a.custom_brand||"",vintage:(null==(e=a.vintage)?void 0:e.toString())||"",age_years:(null==(t=a.age_years)?void 0:t.toString())||"",retail_price:(null==(n=a.retail_price)?void 0:n.toString())||"",purchase_price:(null==(i=a.purchase_price)?void 0:i.toString())||"",discount_rate:(null==(r=a.discount_rate)?void 0:r.toString())||"",purchase_location:a.purchase_location||"",purchase_date:a.purchase_date||"",total_volume_ml:(null==(o=a.total_volume_ml)?void 0:o.toString())||"750",remaining_volume_ml:(null==(l=a.remaining_volume_ml)?void 0:l.toString())||"750",notes:a.notes||"",abv:(null==(s=a.abv)?void 0:s.toString())||"",type:a.type||"Single Malt",whiskybase_rating:(null==(d=a.whiskybase_rating)?void 0:d.toString())||"",cask_type:a.cask_type||"",bottled_year:(null==(c=a.bottled_year)?void 0:c.toString())||"",description:a.description||"",whiskybase_url:a.whiskybase_url||""}),y(a.image_url||null)}},[a,r]),(0,o.useEffect)(()=>{if(c.retail_price&&c.purchase_price){let e=parseFloat(c.retail_price),t=parseFloat(c.purchase_price);if(e>0&&t>0){let n=(e-t)/e*100;p(e=>({...e,discount_rate:n.toFixed(2)}))}}},[c.retail_price,c.purchase_price]);let _=async e=>{if(e){if(!(0,ep.Wl)(e))return void alert("이미지 파일만 업로드 가능하며, 크기는 5MB 이하여야 합니다.");try{let t=await (0,ep.w4)(e,800,600,.8);u(t);let n=new FileReader;n.onload=e=>{var t;h((null==(t=e.target)?void 0:t.result)||"")},n.readAsDataURL(t)}catch(e){alert("이미지 처리 중 오류가 발생했습니다.")}}},w=async e=>{try{let t=await (0,ep.w4)(e,400,300,.85);u(t);let n=new FileReader;n.onload=e=>{var t;let n=null==(t=e.target)?void 0:t.result;h(n||"")},n.readAsDataURL(t),y(null);return}catch(e){alert("편집된 이미지 처리 중 오류가 발생했습니다.")}},C=async()=>{if(confirm("이미지를 삭제하시겠습니까?"))try{if(f&&f.includes("supabase.co")){let e=f.split("/").pop();if(e){let{error:t}=await l.supabase.storage.from("whisky-bottles").remove([e])}}u(null),h(""),y(null)}catch(e){alert("이미지 삭제 중 오류가 발생했습니다.")}},k=async()=>{if(!x)return f;try{return await (0,ep.A6)(x,"whisky-bottles")}catch(e){return alert("이미지 업로드 실패: ".concat(e instanceof Error?e.message:"알 수 없는 오류","\n위스키는 저장됩니다.")),f}},S=async e=>{var t;if(e.preventDefault(),!c.name)return void alert("위스키 이름을 입력해주세요.");if(!c.brand_id)return void alert("브랜드를 선택해주세요.");m(!0);try{let e=f;x&&(e=await k());let i={...t={user_id:n.id,name:c.name,brand_id:c.brand_id||null,custom_brand:null,vintage:c.vintage,age_years:c.age_years,retail_price:c.retail_price,purchase_price:c.purchase_price,discount_rate:c.discount_rate,purchase_location:c.purchase_location,purchase_date:c.purchase_date,total_volume_ml:c.total_volume_ml,remaining_volume_ml:c.remaining_volume_ml,notes:c.notes,image_url:e,abv:c.abv},brand_id:t.brand_id,vintage:es(t.vintage),age_years:es(t.age_years),retail_price:ed(t.retail_price),purchase_price:ed(t.purchase_price),discount_rate:ed(t.discount_rate),total_volume_ml:ed(t.total_volume_ml),remaining_volume_ml:ed(t.remaining_volume_ml),abv:ed(t.abv),purchase_location:ec(t.purchase_location),purchase_date:ec(t.purchase_date),notes:ec(t.notes),custom_brand:ec(t.custom_brand)};if(a){let{error:e}=await l.supabase.from("bottles").update(i).eq("id",a.id);if(e)throw e;alert("위스키가 성공적으로 수정되었습니다!")}else{let{error:e}=await l.supabase.from("bottles").insert(i);if(e)throw e;alert("위스키가 성공적으로 추가되었습니다!")}d&&d(),s&&s()}catch(e){e_(e),alert(function(e){let t=e_(e);switch(t.code){case"NETWORK_ERROR":return"네트워크 연결을 확인해주세요.";case"AUTH_ERROR":return"로그인이 필요합니다.";case"PERMISSION_ERROR":return"권한이 없습니다.";case"VALIDATION_ERROR":return"입력 정보를 확인해주세요.";case"NOT_FOUND":return"요청한 정보를 찾을 수 없습니다.";case"RATE_LIMIT":return"요청이 너무 많습니다. 잠시 후 다시 시도해주세요.";default:return t.message||"오류가 발생했습니다. 잠시 후 다시 시도해주세요."}}(e))}finally{m(!1)}};return(0,i.jsx)("div",{className:"bg-black bg-opacity-80 flex items-start justify-center p-4 pb-20 overflow-y-auto",style:{paddingTop:"calc(1rem + env(safe-area-inset-top))",paddingBottom:"calc(1rem + 72px + env(safe-area-inset-bottom))",width:"100%",height:"100%"},children:(0,i.jsxs)("div",{className:"bg-gray-800 rounded-2xl p-6 w-full max-w-2xl overflow-y-auto relative my-auto shadow-2xl",style:{maxHeight:"calc(100vh - 2rem - 72px - env(safe-area-inset-top) - env(safe-area-inset-bottom))"},children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-6 sticky top-0 bg-gray-800 z-10 pb-3 border-b border-gray-700",style:{paddingTop:"4px",marginTop:"-4px"},children:[(0,i.jsx)("h2",{className:"text-xl font-semibold text-white m-0",children:a?"위스키 수정":"위스키 추가"}),(0,i.jsx)("button",{onClick:()=>{s&&s()},className:"w-8 h-8 flex items-center justify-center rounded-full bg-gray-700 hover:bg-gray-600 text-white text-xl font-bold transition-colors duration-200",style:{width:"36px",height:"36px",fontSize:"18px",backgroundColor:"rgba(75, 85, 99, 0.8)",position:"relative",zIndex:20},children:"\xd7"})]}),(0,i.jsxs)("form",{onSubmit:S,className:"mobile-form",children:[(0,i.jsxs)("div",{style:{display:"grid",gap:"16px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[(0,i.jsx)("label",{style:{fontSize:"14px",fontWeight:"500"},children:"위스키명 *"}),(0,i.jsx)("button",{type:"button",onClick:()=>j(!v),style:{padding:"6px 12px",backgroundColor:"#10B981",border:"none",borderRadius:"6px",color:"white",cursor:"pointer",fontSize:"12px",fontWeight:"500"},children:"\uD83D\uDD0D Whiskybase 검색"})]}),v&&(0,i.jsx)("div",{style:{marginBottom:"12px"},children:(0,i.jsx)(ev,{onSelectWhisky:e=>{let t=e.abv?e.abv.replace("%","").trim():"",n=null==r?void 0:r.find(t=>t.name.toLowerCase()===e.brand.toLowerCase()),i={name:e.name,brand_id:(null==n?void 0:n.id)||"",custom_brand:n?"":e.brand,age_years:e.age||"",abv:t,type:e.type||"Single Malt",whiskybase_rating:e.rating||"",cask_type:e.cask_type||"",bottled_year:e.bottled_year||"",description:e.description||"",whiskybase_url:e.url||"",notes:"".concat(e.type||""," ").concat(e.region||""," ").concat(e.rating?"평점: ".concat(e.rating):"").trim()};p(e=>({...e,...i})),j(!1)},disabled:b,initialSearchTerm:c.custom_brand||(c.brand_id?null==(t=r.find(e=>e.id===c.brand_id))?void 0:t.name:"")})}),(0,i.jsx)("input",{type:"text",value:c.name,onChange:e=>p(t=>({...t,name:e.target.value})),style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",fontSize:"16px"},required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"브랜드 *"}),(0,i.jsxs)("select",{value:c.brand_id,onChange:e=>p(t=>({...t,brand_id:e.target.value,custom_brand:""})),style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",fontSize:"16px"},required:!0,children:[(0,i.jsx)("option",{value:"",children:"브랜드 선택"}),null==r?void 0:r.map(e=>(0,i.jsx)("option",{value:e.id,children:e.name},e.id))]}),(null==r?void 0:r.length)===0&&(0,i.jsxs)("div",{style:{marginTop:"8px",padding:"12px",backgroundColor:"#1F2937",border:"1px solid #374151",borderRadius:"8px",fontSize:"14px",color:"#9CA3AF"},children:["브랜드가 없습니다. ",(0,i.jsx)("strong",{children:"데이터 관리 → 브랜드 관리"}),"에서 브랜드를 추가해주세요."]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"빈티지"}),(0,i.jsx)("input",{type:"number",value:c.vintage,onChange:e=>p(t=>({...t,vintage:e.target.value})),style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",fontSize:"16px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"숙성연수"}),(0,i.jsx)("input",{type:"number",value:c.age_years,onChange:e=>p(t=>({...t,age_years:e.target.value})),style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",fontSize:"16px"}})]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"위스키 타입"}),(0,i.jsxs)("select",{value:c.type,onChange:e=>p(t=>({...t,type:e.target.value})),style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",fontSize:"16px"},children:[(0,i.jsx)("option",{value:"Single Malt",children:"Single Malt"}),(0,i.jsx)("option",{value:"Blended",children:"Blended"}),(0,i.jsx)("option",{value:"Pure Malt",children:"Pure Malt"}),(0,i.jsx)("option",{value:"Single Grain",children:"Single Grain"}),(0,i.jsx)("option",{value:"Blended Malt",children:"Blended Malt"}),(0,i.jsx)("option",{value:"Blended Grain",children:"Blended Grain"}),(0,i.jsx)("option",{value:"Bourbon",children:"Bourbon"}),(0,i.jsx)("option",{value:"Rye",children:"Rye"}),(0,i.jsx)("option",{value:"Other",children:"Other"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"Whiskybase 평점"}),(0,i.jsx)("input",{type:"text",value:c.whiskybase_rating?"".concat(c.whiskybase_rating,"/10"):"",readOnly:!0,placeholder:"Whiskybase 검색으로 자동 입력",style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#1F2937",color:"#9CA3AF",fontSize:"16px",cursor:"not-allowed"}}),c.whiskybase_rating&&(0,i.jsx)("div",{style:{marginTop:"4px",fontSize:"12px",color:"#6B7280"},children:"Whiskybase 검색으로 자동 입력됨"})]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"캐스크 타입"}),(0,i.jsx)("input",{type:"text",placeholder:"예: Sherry Oak, Bourbon, Port",value:c.cask_type,onChange:e=>p(t=>({...t,cask_type:e.target.value})),style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",fontSize:"16px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"병입년도"}),(0,i.jsx)("input",{type:"number",placeholder:"예: 2020",value:c.bottled_year,onChange:e=>p(t=>({...t,bottled_year:e.target.value})),style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",fontSize:"16px"}})]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"시중가 (원)"}),(0,i.jsx)("input",{type:"number",value:c.retail_price,onChange:e=>p(t=>({...t,retail_price:e.target.value})),style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",fontSize:"16px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"구매가 (원)"}),(0,i.jsx)("input",{type:"number",value:c.purchase_price,onChange:e=>p(t=>({...t,purchase_price:e.target.value})),style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",fontSize:"16px"}})]})]}),c.discount_rate&&(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"할인율 (%)"}),(0,i.jsx)("input",{type:"number",value:c.discount_rate,onChange:e=>p(t=>({...t,discount_rate:e.target.value})),style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",fontSize:"16px"}})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"구매장소"}),(0,i.jsx)("input",{type:"text",value:c.purchase_location,onChange:e=>p(t=>({...t,purchase_location:e.target.value})),style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",fontSize:"16px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"구매일"}),(0,i.jsx)("input",{type:"date",value:c.purchase_date,onChange:e=>p(t=>({...t,purchase_date:e.target.value})),style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",fontSize:"16px"}})]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"총 용량 (ml)"}),(0,i.jsx)("input",{type:"number",value:c.total_volume_ml,onChange:e=>p(t=>({...t,total_volume_ml:e.target.value})),style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",fontSize:"16px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"남은 용량 (ml)"}),(0,i.jsx)("input",{type:"number",value:c.remaining_volume_ml,onChange:e=>p(t=>({...t,remaining_volume_ml:e.target.value})),style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",fontSize:"16px"}})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"도수 (%)"}),(0,i.jsx)("input",{type:"text",placeholder:"예: 40 또는 43.5",value:c.abv,onChange:e=>{let t=e.target.value.replace(/[^0-9.]/g,"");p(e=>({...e,abv:t}))},style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",fontSize:"16px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"이미지"}),(0,i.jsx)(eb,{onImageSelect:_,onImageEdit:w,onImageDelete:C,currentImage:g||f,disabled:b})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"메모"}),(0,i.jsx)("textarea",{value:c.notes,onChange:e=>p(t=>({...t,notes:e.target.value})),rows:4,style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",resize:"vertical",fontSize:"16px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"상세 설명"}),(0,i.jsx)("textarea",{value:c.description,onChange:e=>p(t=>({...t,description:e.target.value})),rows:3,placeholder:"위스키에 대한 상세한 설명을 입력하세요...",style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",resize:"vertical",fontSize:"16px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"Whiskybase URL"}),(0,i.jsx)("input",{type:"url",value:c.whiskybase_url,onChange:e=>p(t=>({...t,whiskybase_url:e.target.value})),placeholder:"https://www.whiskybase.com/...",style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",fontSize:"16px"}}),c.whiskybase_url&&(0,i.jsx)("div",{style:{marginTop:"8px"},children:(0,i.jsx)("a",{href:c.whiskybase_url,target:"_blank",rel:"noopener noreferrer",style:{color:"#60A5FA",textDecoration:"none",fontSize:"14px",display:"inline-flex",alignItems:"center",gap:"4px"},children:"\uD83D\uDD17 Whiskybase에서 보기"})})]})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"12px",marginTop:"24px",paddingTop:"16px",borderTop:"1px solid #374151",position:"sticky",bottom:0,backgroundColor:"#1F2937",zIndex:10,paddingBottom:"16px"},children:[(0,i.jsx)("button",{type:"submit",disabled:b,className:"mobile-button",style:{flex:1,padding:"16px",backgroundColor:"#3B82F6",border:"none",borderRadius:"12px",color:"white",cursor:b?"not-allowed":"pointer",opacity:b?.6:1,fontSize:"16px",fontWeight:"600"},children:b?"저장중...":a?"수정":"추가"}),(0,i.jsx)("button",{type:"button",onClick:s,className:"mobile-button",style:{flex:1,padding:"16px",backgroundColor:"#6B7280",border:"none",borderRadius:"12px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600"},children:"취소"})]})]})]})})}function eC(e){var t;let{user:r,bottle:a,editingTasting:s,onClose:d,onTastingAdded:c}=e,[p,x]=(0,o.useState)(!1),[u,g]=(0,o.useState)({bottle_name:(null==a?void 0:a.name)||"",tasting_type:a?"bottle":"bar",tasting_date:new Date().toISOString().split("T")[0],tasting_time:new Date().toTimeString().slice(0,5),location:"",consumed_volume_ml:"",nose_rating:"",palate_rating:"",finish_rating:"",overall_rating:"",nose_notes:"",palate_notes:"",finish_notes:"",additional_notes:"",companions:"",image_url:""}),[h,b]=(0,o.useState)(null),[m,f]=(0,o.useState)("");(0,o.useEffect)(()=>{if(s){var e,t,n,i,r,a;g({bottle_name:(null==(e=s.bottles)?void 0:e.name)||s.bottle_name||"",tasting_type:s.tasting_type||"bottle",tasting_date:s.tasting_date||new Date().toISOString().split("T")[0],tasting_time:s.tasting_time||new Date().toTimeString().slice(0,5),location:s.location||"",consumed_volume_ml:(null==(t=s.consumed_volume_ml)?void 0:t.toString())||"",nose_rating:(null==(n=s.nose_rating)?void 0:n.toString())||"",palate_rating:(null==(i=s.palate_rating)?void 0:i.toString())||"",finish_rating:(null==(r=s.finish_rating)?void 0:r.toString())||"",overall_rating:(null==(a=s.overall_rating)?void 0:a.toString())||"",nose_notes:s.nose_notes||"",palate_notes:s.palate_notes||"",finish_notes:s.finish_notes||"",additional_notes:s.additional_notes||"",companions:s.companions||"",image_url:s.image_url||""}),s.image_url&&f(s.image_url||"")}},[s]);let y=async(e,t,n)=>{try{let{data:i,error:r}=await l.supabase.from("bottles").select("remaining_volume_ml, total_volume_ml").eq("id",e).single();if(r)throw r;let a=i.remaining_volume_ml;s&&n?a=a+n-t:a-=t,a=Math.max(0,a);let{error:o}=await l.supabase.from("bottles").update({remaining_volume_ml:a,bottle_status:0===a?"empty":"opened"}).eq("id",e);if(o)throw o}catch(e){}},v=async e=>{try{if(!(0,ep.Wl)(e))return void alert("유효한 이미지 파일을 선택해주세요. (JPG, PNG, GIF, 최대 5MB)");let t=e;try{t=await (0,ep.w4)(e,800,600,.8)}catch(n){t=e}b(t);try{let e=await (0,ep.bB)(t);f(e||"")}catch(e){alert("이미지 미리보기를 생성할 수 없습니다.")}}catch(e){alert("이미지 처리 중 오류가 발생했습니다.")}},j=async()=>{if(confirm("정말로 이 이미지를 삭제하시겠습니까?"))try{if(u.image_url&&u.image_url.startsWith("http")){let{deleteImageFromSupabase:e}=await Promise.resolve().then(n.bind(n,8125));await e(u.image_url)}b(null),f(""),g(e=>({...e,image_url:""}))}catch(e){}},_=(e,t)=>{g(n=>({...n,[e]:t}))},w=async e=>{e.preventDefault(),x(!0);try{let e=u.image_url;if(h){let t=await (0,ep.A6)(h,"tastings");t&&(e=t)}let t={user_id:r.id,bottle_id:(null==a?void 0:a.id)||null,bottle_name:u.bottle_name,tasting_type:u.tasting_type,tasting_date:u.tasting_date,tasting_time:u.tasting_time,location:u.location,consumed_volume_ml:u.consumed_volume_ml?parseFloat(u.consumed_volume_ml):null,nose_rating:u.nose_rating?parseInt(u.nose_rating):null,palate_rating:u.palate_rating?parseInt(u.palate_rating):null,finish_rating:u.finish_rating?parseInt(u.finish_rating):null,overall_rating:u.overall_rating?parseFloat(parseFloat(u.overall_rating).toFixed(1)):null,nose_notes:u.nose_notes,palate_notes:u.palate_notes,finish_notes:u.finish_notes,companions:u.companions,additional_notes:u.additional_notes,image_url:e};if(s){let{error:e}=await l.supabase.from("tastings").update(t).eq("id",s.id);if(e)throw e;(null==a?void 0:a.id)&&u.consumed_volume_ml&&await y(a.id,parseFloat(u.consumed_volume_ml),s.consumed_volume_ml),alert("시음 기록이 수정되었습니다!")}else{let{error:e}=await l.supabase.from("tastings").insert(t);if(e)throw e;(null==a?void 0:a.id)&&u.consumed_volume_ml&&await y(a.id,parseFloat(u.consumed_volume_ml)),alert("시음 기록이 추가되었습니다!")}c&&c(),d&&d()}catch(e){alert(s?"시음 기록 수정 중 오류가 발생했습니다.":"시음 기록 추가 중 오류가 발생했습니다.")}finally{x(!1)}};return(0,i.jsx)("div",{className:"bg-black bg-opacity-80 flex items-center justify-center p-4 overflow-y-auto",style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:1e3,paddingTop:"env(safe-area-inset-top)",paddingBottom:"env(safe-area-inset-bottom)"},children:(0,i.jsxs)("div",{className:"bg-gray-800 rounded-2xl p-6 w-full max-w-2xl overflow-y-auto shadow-2xl",style:{maxHeight:"calc(100vh - 2rem - env(safe-area-inset-top) - env(safe-area-inset-bottom))",margin:"auto"},children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-6 sticky top-0 bg-gray-800 z-10 pb-3 border-b border-gray-700",style:{paddingTop:"4px",marginTop:"-4px"},children:[(0,i.jsx)("h2",{className:"text-xl font-semibold text-white m-0",children:s?"시음 기록 수정":"시음 기록 추가"}),(0,i.jsx)("button",{onClick:()=>{d&&d()},className:"w-8 h-8 flex items-center justify-center rounded-full bg-gray-700 hover:bg-gray-600 text-white text-xl font-bold transition-colors duration-200",style:{width:"36px",height:"36px",fontSize:"18px",backgroundColor:"rgba(75, 85, 99, 0.8)",position:"relative",zIndex:20},children:"\xd7"})]}),(0,i.jsx)("form",{onSubmit:w,className:"mobile-form",children:(0,i.jsxs)("div",{style:{display:"grid",gap:"16px"},children:[a&&a.name&&(0,i.jsxs)("div",{style:{padding:"16px",backgroundColor:"#374151",borderRadius:"8px"},children:[(0,i.jsx)("h3",{style:{margin:"0 0 8px 0",fontSize:"16px",color:"white"},children:a.name}),(0,i.jsx)("p",{style:{margin:"0",color:"#9CA3AF",fontSize:"14px"},children:(null==(t=a.brands)?void 0:t.name)||a.custom_brand||"알 수 없는 브랜드"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"시음 타입"}),(0,i.jsxs)("select",{value:u.tasting_type,onChange:e=>_("tasting_type",e.target.value),style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",fontSize:"16px"},children:[(0,i.jsx)("option",{value:"bottle",children:"구매한 보틀"}),(0,i.jsx)("option",{value:"bar",children:"바"}),(0,i.jsx)("option",{value:"event",children:"행사/모임"}),(0,i.jsx)("option",{value:"other",children:"기타"})]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"시음 날짜"}),(0,i.jsx)("input",{type:"date",value:u.tasting_date,onChange:e=>_("tasting_date",e.target.value),style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",fontSize:"16px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"시음 시간"}),(0,i.jsx)("input",{type:"time",value:u.tasting_time,onChange:e=>_("tasting_time",e.target.value),style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",fontSize:"16px"}})]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"장소"}),(0,i.jsx)("input",{type:"text",placeholder:"바 이름, 집, 행사장 등",value:u.location,onChange:e=>_("location",e.target.value),style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",fontSize:"16px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"소비량 (ml)"}),(0,i.jsx)("input",{type:"number",placeholder:"예: 30",value:u.consumed_volume_ml,onChange:e=>_("consumed_volume_ml",e.target.value),style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",fontSize:"16px"}})]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"16px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"코 (1-10)"}),(0,i.jsx)("input",{type:"number",min:"1",max:"10",placeholder:"1-10",value:u.nose_rating,onChange:e=>_("nose_rating",e.target.value),style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",fontSize:"16px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"입 (1-10)"}),(0,i.jsx)("input",{type:"number",min:"1",max:"10",placeholder:"1-10",value:u.palate_rating,onChange:e=>_("palate_rating",e.target.value),style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",fontSize:"16px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"피니시 (1-10)"}),(0,i.jsx)("input",{type:"number",min:"1",max:"10",placeholder:"1-10",value:u.finish_rating,onChange:e=>_("finish_rating",e.target.value),style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",fontSize:"16px"}})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"종합 평점 (1-10)"}),(0,i.jsx)("input",{type:"number",min:"1",max:"10",step:"0.1",placeholder:"1.0-10.0",value:u.overall_rating,onChange:e=>_("overall_rating",e.target.value),style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",fontSize:"16px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"코 노트"}),(0,i.jsx)("textarea",{placeholder:"향, 아로마, 코에서 느껴지는 향기...",value:u.nose_notes,onChange:e=>_("nose_notes",e.target.value),rows:3,style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",resize:"vertical",fontSize:"16px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"입 노트"}),(0,i.jsx)("textarea",{placeholder:"맛, 질감, 입에서 느껴지는 풍미...",value:u.palate_notes,onChange:e=>_("palate_notes",e.target.value),rows:3,style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",resize:"vertical",fontSize:"16px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"피니시 노트"}),(0,i.jsx)("textarea",{placeholder:"여운, 지속성, 마시고 난 후의 느낌...",value:u.finish_notes,onChange:e=>_("finish_notes",e.target.value),rows:3,style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",resize:"vertical",fontSize:"16px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"동반자"}),(0,i.jsx)("input",{type:"text",placeholder:"친구, 가족, 동료 등",value:u.companions,onChange:e=>_("companions",e.target.value),style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",fontSize:"16px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"추가 노트"}),(0,i.jsx)("textarea",{placeholder:"기타 특별한 느낌이나 기억을 적어주세요...",value:u.additional_notes,onChange:e=>_("additional_notes",e.target.value),rows:3,style:{width:"100%",padding:"12px",border:"1px solid #374151",borderRadius:"8px",backgroundColor:"#111827",color:"white",resize:"vertical",fontSize:"16px"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"이미지"}),(0,i.jsx)(eb,{onImageSelect:v,onImageEdit:v,onImageDelete:j,currentImage:m||u.image_url,disabled:p})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"12px",marginTop:"24px",paddingTop:"16px",borderTop:"1px solid #374151",position:"sticky",bottom:0,backgroundColor:"#1F2937",zIndex:10,paddingBottom:"16px"},children:[(0,i.jsx)("button",{type:"button",onClick:()=>{d&&d()},className:"mobile-button",style:{flex:1,padding:"16px",backgroundColor:"#6B7280",border:"none",borderRadius:"12px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600"},children:"취소"}),(0,i.jsx)("button",{type:"submit",disabled:p,className:"mobile-button",style:{flex:1,padding:"16px",backgroundColor:"#3B82F6",border:"none",borderRadius:"12px",color:"white",cursor:p?"not-allowed":"pointer",opacity:p?.6:1,fontSize:"16px",fontWeight:"600"},children:p?"저장중...":s?"수정":"저장"})]})]})})]})})}function ek(e){var t;let{user:n,bottle:r,onClose:a}=e,[s,d]=(0,o.useState)([]),[c,p]=(0,o.useState)(!0);(0,o.useEffect)(()=>{x()},[null==r?void 0:r.id,null==n?void 0:n.id]);let x=async()=>{try{if(p(!0),!(null==r?void 0:r.id)||!(null==n?void 0:n.id))return void d([]);let{data:e,error:t}=await l.supabase.from("tastings").select("*").eq("user_id",n.id).eq("bottle_id",r.id).order("tasting_date",{ascending:!1});if(t)throw t;d(e||[])}catch(e){}finally{p(!1)}},u=e=>e>=9?"#10B981":e>=7?"#3B82F6":e>=5?"#F59E0B":"#EF4444";return c?(0,i.jsx)("div",{style:{backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%"},children:(0,i.jsx)("div",{style:{backgroundColor:"#1F2937",borderRadius:"12px",padding:"24px",width:"90%",maxWidth:"600px"},children:(0,i.jsx)("p",{children:"시음 기록 로딩중..."})})}):(0,i.jsx)("div",{style:{backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%"},children:(0,i.jsxs)("div",{style:{backgroundColor:"#1F2937",borderRadius:"12px",padding:"24px",width:"90%",maxWidth:"800px",maxHeight:"90vh",overflowY:"auto"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[(0,i.jsx)("h2",{children:"시음 기록"}),(0,i.jsx)("button",{onClick:a,style:{background:"none",border:"none",color:"#9CA3AF",fontSize:"24px",cursor:"pointer"},children:"\xd7"})]}),(0,i.jsxs)("div",{style:{marginBottom:"16px",padding:"12px",backgroundColor:"#374151",borderRadius:"8px"},children:[(0,i.jsx)("h3",{style:{margin:"0 0 8px 0",fontSize:"16px"},children:r.name}),(0,i.jsx)("p",{style:{margin:"0",color:"#9CA3AF",fontSize:"14px"},children:(null==(t=r.brands)?void 0:t.name)||r.custom_brand})]}),0===s.length?(0,i.jsxs)("div",{style:{textAlign:"center",padding:"40px",color:"#9CA3AF"},children:[(0,i.jsx)("p",{children:"아직 시음 기록이 없습니다."}),(0,i.jsx)("p",{children:"첫 번째 시음을 기록해보세요!"})]}):(0,i.jsx)("div",{style:{display:"grid",gap:"16px"},children:s.map((e,t)=>(0,i.jsxs)("div",{style:{backgroundColor:"#111827",borderRadius:"8px",padding:"16px",border:"1px solid #374151"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{style:{margin:"0 0 4px 0",fontSize:"14px"},children:new Date(e.tasting_date).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}),e.location&&(0,i.jsxs)("p",{style:{margin:"0",fontSize:"12px",color:"#9CA3AF"},children:["\uD83D\uDCCD ",e.location]})]}),e.overall_rating&&(0,i.jsxs)("div",{style:{backgroundColor:u(e.overall_rating),color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold"},children:[e.overall_rating,"/10"]})]}),(e.nose_rating||e.palate_rating||e.finish_rating)&&(0,i.jsx)("div",{style:{marginBottom:"12px"},children:(0,i.jsxs)("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:[e.nose_rating&&(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,i.jsx)("span",{style:{fontSize:"12px",color:"#9CA3AF"},children:"Nose:"}),(0,i.jsx)("span",{style:{backgroundColor:u(e.nose_rating),color:"white",padding:"2px 6px",borderRadius:"3px",fontSize:"11px"},children:e.nose_rating})]}),e.palate_rating&&(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,i.jsx)("span",{style:{fontSize:"12px",color:"#9CA3AF"},children:"Palate:"}),(0,i.jsx)("span",{style:{backgroundColor:u(e.palate_rating),color:"white",padding:"2px 6px",borderRadius:"3px",fontSize:"11px"},children:e.palate_rating})]}),e.finish_rating&&(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,i.jsx)("span",{style:{fontSize:"12px",color:"#9CA3AF"},children:"Finish:"}),(0,i.jsx)("span",{style:{backgroundColor:u(e.finish_rating),color:"white",padding:"2px 6px",borderRadius:"3px",fontSize:"11px"},children:e.finish_rating})]})]})}),(e.nose_notes||e.palate_notes||e.finish_notes)&&(0,i.jsxs)("div",{style:{marginBottom:"12px"},children:[e.nose_notes&&(0,i.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,i.jsx)("span",{style:{fontSize:"12px",color:"#9CA3AF",fontWeight:"bold"},children:"Nose:"}),(0,i.jsx)("p",{style:{margin:"4px 0 0 0",fontSize:"13px",lineHeight:"1.4"},children:e.nose_notes})]}),e.palate_notes&&(0,i.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,i.jsx)("span",{style:{fontSize:"12px",color:"#9CA3AF",fontWeight:"bold"},children:"Palate:"}),(0,i.jsx)("p",{style:{margin:"4px 0 0 0",fontSize:"13px",lineHeight:"1.4"},children:e.palate_notes})]}),e.finish_notes&&(0,i.jsxs)("div",{style:{marginBottom:"8px"},children:[(0,i.jsx)("span",{style:{fontSize:"12px",color:"#9CA3AF",fontWeight:"bold"},children:"Finish:"}),(0,i.jsx)("p",{style:{margin:"4px 0 0 0",fontSize:"13px",lineHeight:"1.4"},children:e.finish_notes})]})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"16px",flexWrap:"wrap",fontSize:"12px",color:"#9CA3AF"},children:[e.consumed_volume_ml&&(0,i.jsxs)("span",{children:["\uD83C\uDF77 ",e.consumed_volume_ml,"ml"]}),e.companions&&(0,i.jsxs)("span",{children:["\uD83D\uDC65 ",e.companions]})]}),e.additional_notes&&(0,i.jsx)("div",{style:{marginTop:"8px",padding:"8px",backgroundColor:"#374151",borderRadius:"4px"},children:(0,i.jsx)("p",{style:{margin:"0",fontSize:"12px",lineHeight:"1.4"},children:e.additional_notes})})]},e.id))})]})})}function eS(e){let{children:t,onClick:n,style:r={},disabled:a=!1}=e,[l,s]=(0,o.useState)(!1);return(0,i.jsx)("button",{style:{...r,transform:l?"scale(0.95)":"scale(1)",transition:"all 0.15s cubic-bezier(0.4, 0, 0.2, 1)",opacity:l?.8:1,userSelect:"none",WebkitUserSelect:"none",WebkitTapHighlightColor:"transparent",cursor:a?"not-allowed":"pointer"},onTouchStart:()=>{a||s(!0)},onTouchEnd:()=>{a||(s(!1),null==n||n())},onMouseDown:()=>{a||s(!0)},onMouseUp:()=>{a||(s(!1),null==n||n())},onMouseLeave:()=>{s(!1)},disabled:a,children:t})}function eD(e){var t,n,r,a,s,d,c,p,x,u,g,h,b,m,f,y,v;let{bottle:j,isOpen:_,onClose:w,onEdit:C,onAddTasting:k}=e,[S,D]=(0,o.useState)([]),[B,z]=(0,o.useState)(!1),[F,R]=(0,o.useState)("details");(0,o.useEffect)(()=>{_&&(null==j?void 0:j.id)&&A()},[_,null==j?void 0:j.id]);let A=async()=>{if(null==j?void 0:j.id)try{z(!0);let{data:e,error:t}=await l.supabase.from("tastings").select("*").eq("bottle_id",j.id).order("tasting_date",{ascending:!1});if(t)throw t;D(e||[])}catch(e){}finally{z(!1)}},W=e=>{if(!e)return"날짜 없음";try{return new Date(e).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})}catch(e){return"날짜 오류"}},I=e=>e>=9?"#10B981":e>=7?"#3B82F6":e>=5?"#F59E0B":"#EF4444",T=(()=>{if(0===S.length)return null;let e=S.map(e=>e.overall_rating||e.rating).filter(e=>null!=e&&!isNaN(Number(e)));return 0===e.length?null:Math.round(e.reduce((e,t)=>e+Number(t),0)/e.length*10)/10})();return _&&j?(0,i.jsx)("div",{style:{backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",padding:"16px",width:"100%",height:"100%"},children:(0,i.jsxs)("div",{style:{backgroundColor:"#1F2937",border:"1px solid #374151",borderRadius:"16px",width:"100%",maxWidth:"900px",maxHeight:"85vh",minHeight:"60vh",overflow:"hidden",display:"flex",flexDirection:"column",position:"relative",marginTop:"env(safe-area-inset-top)",marginBottom:"env(safe-area-inset-bottom)"},children:[(0,i.jsxs)("div",{style:{padding:"20px 20px 0 20px",borderBottom:"1px solid #374151",position:"sticky",top:0,backgroundColor:"#1F2937",zIndex:100,paddingTop:"calc(20px + env(safe-area-inset-top))"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"16px"},children:[(0,i.jsxs)("div",{style:{flex:1,marginRight:"12px"},children:[(0,i.jsx)("h2",{style:{margin:"0 0 8px 0",fontSize:"20px",fontWeight:"700",color:"white",lineHeight:"1.2",wordBreak:"break-word"},children:j.name}),((null==(t=j.brands)?void 0:t.name)||j.custom_brand)&&(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px",flexWrap:"wrap"},children:[(0,i.jsx)("span",{style:{padding:"4px 8px",backgroundColor:(e=>{for(let[t,n]of Object.entries({스페이사이드:"#10B981",하이랜드:"#3B82F6",이슬레이:"#8B5CF6",캠벨타운:"#F59E0B",로우랜드:"#EF4444",켄터키:"#DC2626",테네시:"#7C3AED",일본:"#059669"}))if(null==e?void 0:e.includes(t))return n;return"#6B7280"})((null==(n=j.brands)?void 0:n.region)||(null==(r=j.brands)?void 0:r.country)||j.region),borderRadius:"6px",fontSize:"12px",color:"white",fontWeight:"500"},children:(null==(a=j.brands)?void 0:a.name)||j.custom_brand}),((null==(s=j.brands)?void 0:s.region)||j.region)&&(0,i.jsx)("span",{style:{padding:"4px 8px",backgroundColor:"#374151",borderRadius:"6px",fontSize:"12px",color:"#9CA3AF"},children:(null==(d=j.brands)?void 0:d.region)||j.region})]})]}),(0,i.jsx)(eS,{onClick:w,style:{background:"none",border:"none",color:"#9CA3AF",fontSize:"28px",padding:"8px",borderRadius:"6px",width:"44px",height:"44px",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,cursor:"pointer"},children:"\xd7"})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"2px",marginBottom:"0"},children:[(0,i.jsx)(eS,{onClick:()=>R("details"),style:{padding:"12px 20px",backgroundColor:"details"===F?"#3B82F6":"transparent",border:"none",borderRadius:"8px 8px 0 0",color:"details"===F?"white":"#9CA3AF",fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease"},children:"\uD83D\uDCCB 상세정보"}),(0,i.jsxs)(eS,{onClick:()=>R("tastings"),style:{padding:"12px 20px",backgroundColor:"tastings"===F?"#3B82F6":"transparent",border:"none",borderRadius:"8px 8px 0 0",color:"tastings"===F?"white":"#9CA3AF",fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease"},children:["\uD83C\uDF77 시음기록 (",S.length,")"]})]})]}),(0,i.jsx)("div",{style:{flex:1,overflow:"auto",padding:"24px"},children:"details"===F?(0,i.jsxs)("div",{children:[j.image_url&&(0,i.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginBottom:"24px",minHeight:"200px"},children:(0,i.jsx)("img",{src:j.image_url,alt:j.name,style:{maxWidth:"100%",maxHeight:"300px",borderRadius:"12px",objectFit:"contain",boxShadow:"0 8px 25px rgba(0, 0, 0, 0.3)"}})}),void 0!==j.current_level&&null!==j.current_level&&(0,i.jsxs)("div",{style:{backgroundColor:"#1E293B",border:"2px solid #374151",borderRadius:"12px",padding:"20px",marginBottom:"24px",textAlign:"center"},children:[(0,i.jsx)("div",{style:{fontSize:"14px",color:"#9CA3AF",marginBottom:"8px"},children:"\uD83D\uDCCA 현재 남은량"}),(0,i.jsxs)("div",{style:{fontSize:"32px",fontWeight:"700",color:j.current_level>50?"#10B981":j.current_level>20?"#F59E0B":"#EF4444",marginBottom:"12px"},children:[j.current_level,"%"]}),(0,i.jsx)("div",{style:{width:"100%",height:"12px",backgroundColor:"#374151",borderRadius:"6px",overflow:"hidden"},children:(0,i.jsx)("div",{style:{width:"".concat(j.current_level,"%"),height:"100%",backgroundColor:j.current_level>50?"#10B981":j.current_level>20?"#F59E0B":"#EF4444",borderRadius:"6px",transition:"width 0.3s ease"}})}),(0,i.jsx)("div",{style:{fontSize:"12px",color:"#6B7280",marginTop:"8px"},children:j.current_level>80?"거의 가득함":j.current_level>50?"절반 이상":j.current_level>20?"부족함":"거의 비어있음"})]}),null!==T&&(0,i.jsxs)("div",{style:{backgroundColor:"#1E293B",border:"2px solid #374151",borderRadius:"12px",padding:"20px",marginBottom:"24px",textAlign:"center"},children:[(0,i.jsxs)("div",{style:{fontSize:"14px",color:"#9CA3AF",marginBottom:"8px"},children:["⭐ 평균 평점 (",S.length,"회 시음)"]}),(0,i.jsxs)("div",{style:{fontSize:"32px",fontWeight:"700",color:I(T),marginBottom:"8px"},children:[T,"/10"]}),(0,i.jsx)("div",{style:{fontSize:"12px",color:"#6B7280"},children:T>=9?"매우 우수":T>=7?"우수":T>=5?"보통":"개선 필요"})]}),(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:[((null==(c=j.brands)?void 0:c.name)||(null==(p=j.brands)?void 0:p.country)||(null==(x=j.brands)?void 0:x.region)||(null==(u=j.brands)?void 0:u.description)||j.custom_brand)&&(0,i.jsxs)("div",{style:{backgroundColor:"#1E293B",border:"1px solid #374151",borderRadius:"12px",padding:"20px"},children:[(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px",fontSize:"16px",fontWeight:"600",color:"white"},children:"\uD83C\uDFF7️ 브랜드 정보"}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:[((null==(g=j.brands)?void 0:g.name)||j.custom_brand)&&(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:"브랜드명"}),(0,i.jsx)("div",{style:{fontSize:"16px",fontWeight:"600",color:"white",padding:"8px 12px",backgroundColor:"#374151",borderRadius:"6px",border:"1px solid #4B5563"},children:(null==(h=j.brands)?void 0:h.name)||j.custom_brand})]}),((null==(b=j.brands)?void 0:b.country)||j.country)&&(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:"국가"}),(0,i.jsxs)("div",{style:{fontSize:"14px",color:"white",padding:"8px 12px",backgroundColor:"#374151",borderRadius:"6px",border:"1px solid #4B5563",display:"flex",alignItems:"center",gap:"6px"},children:["\uD83C\uDF0D ",(null==(m=j.brands)?void 0:m.country)||j.country]})]}),((null==(f=j.brands)?void 0:f.region)||j.region)&&(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:"지역"}),(0,i.jsxs)("div",{style:{fontSize:"14px",color:"white",padding:"8px 12px",backgroundColor:"#374151",borderRadius:"6px",border:"1px solid #4B5563",display:"flex",alignItems:"center",gap:"6px"},children:["\uD83C\uDFD4️ ",(null==(y=j.brands)?void 0:y.region)||j.region]})]}),(null==(v=j.brands)?void 0:v.description)&&(0,i.jsxs)("div",{style:{gridColumn:"1 / -1"},children:[(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:"브랜드 설명"}),(0,i.jsx)("div",{style:{fontSize:"14px",color:"#D1D5DB",padding:"12px",backgroundColor:"#374151",borderRadius:"6px",border:"1px solid #4B5563",lineHeight:"1.5",whiteSpace:"pre-wrap"},children:j.brands.description})]})]})]}),(j.type||j.abv||j.description)&&(0,i.jsxs)("div",{style:{backgroundColor:"#1E293B",border:"1px solid #374151",borderRadius:"12px",padding:"20px"},children:[(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px",fontSize:"16px",fontWeight:"600",color:"white"},children:"\uD83E\uDD43 기본 정보"}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:[j.type&&(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:"타입"}),(0,i.jsx)("div",{style:{fontSize:"14px",color:"white",padding:"8px 12px",backgroundColor:"#374151",borderRadius:"6px",border:"1px solid #4B5563"},children:j.type})]}),j.abv&&(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:"알코올 도수"}),(0,i.jsxs)("div",{style:{fontSize:"14px",color:"white",padding:"8px 12px",backgroundColor:"#374151",borderRadius:"6px",border:"1px solid #4B5563",display:"flex",alignItems:"center",gap:"6px"},children:["\uD83C\uDF7E ",j.abv,"%"]})]}),j.description&&(0,i.jsxs)("div",{style:{gridColumn:"1 / -1"},children:[(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:"상세 설명"}),(0,i.jsx)("div",{style:{fontSize:"14px",color:"#D1D5DB",lineHeight:"1.5"},children:j.description})]})]})]}),(j.vintage||j.age_years||j.bottled_year)&&(0,i.jsxs)("div",{style:{backgroundColor:"#1E293B",border:"1px solid #374151",borderRadius:"12px",padding:"20px"},children:[(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px",fontSize:"16px",fontWeight:"600",color:"white"},children:"\uD83D\uDCC5 연도 정보"}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:[j.vintage&&(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:"빈티지"}),(0,i.jsxs)("div",{style:{fontSize:"14px",color:"white"},children:["\uD83C\uDF47 ",j.vintage,"년"]})]}),j.age_years&&(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:"숙성 연수"}),(0,i.jsxs)("div",{style:{fontSize:"14px",color:"white"},children:["⏰ ",j.age_years,"년"]})]}),j.bottled_year&&(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:"병입년도"}),(0,i.jsxs)("div",{style:{fontSize:"14px",color:"white"},children:["\uD83D\uDCC5 ",j.bottled_year,"년"]})]})]})]}),(j.distillery||j.bottler||j.cask_type||j.cask_number||j.bottle_count)&&(0,i.jsxs)("div",{style:{backgroundColor:"#1E293B",border:"1px solid #374151",borderRadius:"12px",padding:"20px"},children:[(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px",fontSize:"16px",fontWeight:"600",color:"white"},children:"\uD83C\uDFED 제조 정보"}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:[j.distillery&&(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:"증류소"}),(0,i.jsxs)("div",{style:{fontSize:"14px",color:"white"},children:["\uD83C\uDFED ",j.distillery]})]}),j.bottler&&(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:"병입업체"}),(0,i.jsxs)("div",{style:{fontSize:"14px",color:"white"},children:["\uD83C\uDFE2 ",j.bottler]})]}),j.cask_type&&(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:"캐스크 타입"}),(0,i.jsxs)("div",{style:{fontSize:"14px",color:"white"},children:["\uD83D\uDEE2️ ",j.cask_type]})]}),j.cask_number&&(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:"캐스크 번호"}),(0,i.jsxs)("div",{style:{fontSize:"14px",color:"white"},children:["\uD83D\uDD22 ",j.cask_number]})]}),j.bottle_count&&(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:"병 수량"}),(0,i.jsxs)("div",{style:{fontSize:"14px",color:"white"},children:["\uD83D\uDCE6 ",j.bottle_count,"병"]})]})]})]}),j.whiskybase_rating&&(0,i.jsxs)("div",{style:{backgroundColor:"#1E293B",border:"1px solid #374151",borderRadius:"12px",padding:"20px"},children:[(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px",fontSize:"16px",fontWeight:"600",color:"white"},children:"⭐ 평점 정보"}),(0,i.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:j.whiskybase_rating&&(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:"Whiskybase 평점"}),(0,i.jsxs)("div",{style:{fontSize:"16px",color:"#F59E0B",fontWeight:"600"},children:["⭐ ",j.whiskybase_rating,"/10"]})]})})]}),j.tags&&(0,i.jsxs)("div",{style:{backgroundColor:"#1E293B",border:"1px solid #374151",borderRadius:"12px",padding:"20px"},children:[(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px",fontSize:"16px",fontWeight:"600",color:"white"},children:"\uD83C\uDFF7️ 태그"}),(0,i.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px"},children:j.tags.split(",").map((e,t)=>(0,i.jsxs)("span",{style:{padding:"4px 8px",backgroundColor:"#374151",borderRadius:"4px",fontSize:"12px",color:"#9CA3AF"},children:["#",e.trim()]},t))})]}),(j.retail_price||j.purchase_price||j.discount_rate)&&(0,i.jsxs)("div",{style:{backgroundColor:"#1E293B",border:"1px solid #374151",borderRadius:"12px",padding:"20px"},children:[(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px",fontSize:"16px",fontWeight:"600",color:"white"},children:"\uD83D\uDCB0 가격 정보"}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:[j.retail_price&&(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:"시중가"}),(0,i.jsxs)("div",{style:{fontSize:"16px",fontWeight:"600",color:"white"},children:["\uD83D\uDCB0 ",j.retail_price.toLocaleString(),"원"]})]}),j.purchase_price&&(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:"구매가"}),(0,i.jsxs)("div",{style:{fontSize:"16px",fontWeight:"600",color:"#10B981"},children:["\uD83D\uDCB3 ",j.purchase_price.toLocaleString(),"원"]})]}),j.discount_rate&&(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:"할인율"}),(0,i.jsxs)("div",{style:{fontSize:"16px",fontWeight:"600",color:"#F59E0B"},children:["\uD83D\uDCC9 ",j.discount_rate,"%"]})]})]})]}),(j.purchase_location||j.purchase_date||j.bottle_status)&&(0,i.jsxs)("div",{style:{backgroundColor:"#1E293B",border:"1px solid #374151",borderRadius:"12px",padding:"20px"},children:[(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px",fontSize:"16px",fontWeight:"600",color:"white"},children:"\uD83D\uDCCD 구매 정보"}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:[j.purchase_location&&(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:"구매장소"}),(0,i.jsxs)("div",{style:{fontSize:"14px",color:"white"},children:["\uD83C\uDFEA ",j.purchase_location]})]}),j.purchase_date&&(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:"구매일"}),(0,i.jsxs)("div",{style:{fontSize:"14px",color:"white"},children:["\uD83D\uDCC5 ",W(j.purchase_date)]})]}),j.bottle_status&&(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:"병상태"}),(0,i.jsxs)("div",{style:{fontSize:"14px",color:"white"},children:["\uD83C\uDF7E ","opened"===j.bottle_status?"오픈":"unopened"===j.bottle_status?"미오픈":"low"===j.bottle_status?"부족":"empty"===j.bottle_status?"빈병":"미지정"]})]})]})]}),(j.total_volume_ml||j.remaining_volume_ml)&&(0,i.jsxs)("div",{style:{backgroundColor:"#1E293B",border:"1px solid #374151",borderRadius:"12px",padding:"20px"},children:[(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px",fontSize:"16px",fontWeight:"600",color:"white"},children:"\uD83D\uDCCA 용량 정보"}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px"},children:[j.total_volume_ml&&(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:"총 용량"}),(0,i.jsxs)("div",{style:{fontSize:"14px",color:"white"},children:["\uD83C\uDF7E ",j.total_volume_ml,"ml"]})]}),j.remaining_volume_ml&&(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:"남은 용량"}),(0,i.jsxs)("div",{style:{fontSize:"14px",color:"white"},children:["\uD83D\uDCCA ",j.remaining_volume_ml,"ml"]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:"등록일"}),(0,i.jsxs)("div",{style:{fontSize:"14px",color:"white"},children:["\uD83D\uDCC5 ",W(j.created_at)]})]})]})]}),j.whiskybase_url&&(0,i.jsxs)("div",{style:{backgroundColor:"#1E293B",border:"1px solid #374151",borderRadius:"12px",padding:"20px"},children:[(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px",fontSize:"16px",fontWeight:"600",color:"white"},children:"\uD83D\uDD17 링크 정보"}),(0,i.jsx)("div",{children:(0,i.jsx)("a",{href:j.whiskybase_url,target:"_blank",rel:"noopener noreferrer",style:{display:"inline-flex",alignItems:"center",gap:"8px",padding:"12px 16px",backgroundColor:"#3B82F6",color:"white",textDecoration:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease"},onMouseEnter:e=>e.currentTarget.style.backgroundColor="#2563EB",onMouseLeave:e=>e.currentTarget.style.backgroundColor="#3B82F6",children:"\uD83D\uDD17 Whiskybase에서 보기"})})]}),(j.nose_notes||j.palate_notes||j.finish_notes)&&(0,i.jsxs)("div",{style:{backgroundColor:"#1E293B",border:"1px solid #374151",borderRadius:"12px",padding:"20px"},children:[(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px",fontSize:"16px",fontWeight:"600",color:"white"},children:"\uD83D\uDC43 Whiskybase 노트"}),(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[j.nose_notes&&(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:"코 노트"}),(0,i.jsxs)("div",{style:{fontSize:"14px",color:"#D1D5DB",padding:"12px",backgroundColor:"#374151",borderRadius:"6px",border:"1px solid #4B5563",lineHeight:"1.5",whiteSpace:"pre-wrap"},children:["\uD83D\uDC43 ",j.nose_notes]})]}),j.palate_notes&&(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:"입맛 노트"}),(0,i.jsxs)("div",{style:{fontSize:"14px",color:"#D1D5DB",padding:"12px",backgroundColor:"#374151",borderRadius:"6px",border:"1px solid #4B5563",lineHeight:"1.5",whiteSpace:"pre-wrap"},children:["\uD83D\uDC45 ",j.palate_notes]})]}),j.finish_notes&&(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:"피니시 노트"}),(0,i.jsxs)("div",{style:{fontSize:"14px",color:"#D1D5DB",padding:"12px",backgroundColor:"#374151",borderRadius:"6px",border:"1px solid #4B5563",lineHeight:"1.5",whiteSpace:"pre-wrap"},children:["\uD83D\uDD25 ",j.finish_notes]})]})]})]}),j.notes&&(0,i.jsxs)("div",{style:{backgroundColor:"#1E293B",border:"1px solid #374151",borderRadius:"12px",padding:"20px"},children:[(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px",fontSize:"16px",fontWeight:"600",color:"white"},children:"\uD83D\uDCDD 메모"}),(0,i.jsx)("div",{style:{fontSize:"14px",color:"#D1D5DB",lineHeight:"1.6",whiteSpace:"pre-wrap"},children:j.notes})]})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"12px",marginTop:"24px"},children:[C&&(0,i.jsx)(eS,{onClick:()=>C(j),style:{flex:1,padding:"12px 20px",backgroundColor:"#3B82F6",border:"none",borderRadius:"8px",color:"white",fontSize:"14px",fontWeight:"500"},children:"✏️ 수정"}),k&&(0,i.jsx)(eS,{onClick:()=>k(j),style:{flex:1,padding:"12px 20px",backgroundColor:"#10B981",border:"none",borderRadius:"8px",color:"white",fontSize:"14px",fontWeight:"500"},children:"\uD83C\uDF77 시음기록 추가"})]})]}):(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[(0,i.jsxs)("h3",{style:{margin:0,fontSize:"18px",fontWeight:"600",color:"white"},children:["시음기록 (",S.length,"개)"]}),k&&(0,i.jsx)(eS,{onClick:()=>k(j),style:{padding:"8px 16px",backgroundColor:"#10B981",border:"none",borderRadius:"6px",color:"white",fontSize:"14px",fontWeight:"500"},children:"+ 시음기록 추가"})]}),B?(0,i.jsx)("div",{style:{textAlign:"center",padding:"40px",color:"#9CA3AF"},children:"시음기록을 불러오는 중..."}):0===S.length?(0,i.jsx)("div",{style:{textAlign:"center",padding:"40px",color:"#9CA3AF"},children:"아직 시음기록이 없습니다."}):(0,i.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"16px"},children:S.map(e=>(0,i.jsxs)("div",{className:"tasting-card",style:{backgroundColor:"#374151",border:"1px solid #4B5563",borderRadius:"12px",padding:"16px",transform:"scale(1)",transition:"none",cursor:"default",userSelect:"none",WebkitUserSelect:"none",WebkitTapHighlightColor:"transparent"},children:[(0,i.jsx)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"8px"},children:W(e.tasting_date)}),e.location&&(0,i.jsxs)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"8px"},children:["\uD83D\uDCCD ",e.location]}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px"},children:[(0,i.jsxs)("span",{style:{fontSize:"16px",fontWeight:"600",color:I(e.overall_rating||e.rating)},children:["⭐ ",(e=>{if(null==e)return"평점 없음";let t=Number(e);return isNaN(t)||t<0||t>10?"평점 오류":"".concat(t,"/10")})(e.overall_rating||e.rating)]}),(e.nose_rating||e.palate_rating||e.finish_rating)&&(0,i.jsxs)("div",{style:{display:"flex",gap:"4px",fontSize:"12px"},children:[e.nose_rating&&(0,i.jsxs)("span",{style:{color:"#9CA3AF"},children:["\uD83D\uDC43 ",e.nose_rating]}),e.palate_rating&&(0,i.jsxs)("span",{style:{color:"#9CA3AF"},children:["\uD83D\uDC45 ",e.palate_rating]}),e.finish_rating&&(0,i.jsxs)("span",{style:{color:"#9CA3AF"},children:["\uD83D\uDD25 ",e.finish_rating]})]})]}),(e.nose_notes||e.palate_notes||e.finish_notes||e.additional_notes)&&(0,i.jsxs)("div",{style:{marginBottom:"12px"},children:[e.nose_notes&&(0,i.jsxs)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:["\uD83D\uDC43 코: ",e.nose_notes]}),e.palate_notes&&(0,i.jsxs)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:["\uD83D\uDC45 입: ",e.palate_notes]}),e.finish_notes&&(0,i.jsxs)("div",{style:{fontSize:"12px",color:"#9CA3AF",marginBottom:"4px"},children:["\uD83D\uDD25 피니시: ",e.finish_notes]}),e.additional_notes&&(0,i.jsxs)("div",{style:{fontSize:"12px",color:"#9CA3AF"},children:["\uD83D\uDCDD 추가: ",e.additional_notes]})]}),e.consumed_volume_ml&&(0,i.jsxs)("div",{style:{fontSize:"12px",color:"#6B7280",marginBottom:"8px"},children:["\uD83C\uDF77 소비량: ",e.consumed_volume_ml,"ml"]}),e.companions&&(0,i.jsxs)("div",{style:{fontSize:"12px",color:"#6B7280"},children:["\uD83D\uDC65 동반자: ",e.companions]})]},e.id))})]})})]})}):null}function eB(){let{isMobile:e}=y(),[t,n]=(0,o.useState)(null),[r,a]=(0,o.useState)(!1),[l,s]=(0,o.useState)(!1);(0,o.useEffect)(()=>{(()=>{if(window.matchMedia("(display-mode: standalone)").matches||!0===window.navigator.standalone)return s(!0);let e=e=>{e.preventDefault(),n(e),a(!0)},t=()=>{s(!0),a(!1)};return window.addEventListener("beforeinstallprompt",e),window.addEventListener("appinstalled",t),()=>{window.removeEventListener("beforeinstallprompt",e),window.removeEventListener("appinstalled",t)}})(),"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(e=>{e.length})},[]);let d=async()=>{if(t)try{await t.prompt();let{outcome:e}=await t.userChoice;"accepted"===e&&s(!0)}catch(e){}finally{n(null),a(!1)}},c=()=>{a(!1),n(null)};return l||!r?null:(0,i.jsxs)("div",{style:{position:"fixed",bottom:e?"80px":"20px",left:"20px",right:"20px",backgroundColor:"#1F2937",border:"1px solid #374151",borderRadius:"12px",padding:e?"16px":"20px",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.3)",zIndex:1e3,maxWidth:"400px",margin:"0 auto"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px"},children:[(0,i.jsx)("div",{style:{fontSize:"24px",color:"#3B82F6"},children:"\uD83D\uDCF1"}),(0,i.jsxs)("div",{style:{flex:1},children:[(0,i.jsx)("h3",{style:{margin:"0 0 8px 0",fontSize:e?"16px":"18px",fontWeight:"600",color:"white"},children:"앱으로 설치하기"}),(0,i.jsx)("p",{style:{margin:"0 0 16px 0",fontSize:e?"13px":"14px",color:"#9CA3AF",lineHeight:"1.5"},children:"Whisky Log를 홈 화면에 추가하여 더 빠르고 편리하게 사용하세요."}),(0,i.jsxs)("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[(0,i.jsx)("button",{onClick:d,style:{backgroundColor:"#3B82F6",color:"white",border:"none",padding:e?"8px 16px":"10px 20px",borderRadius:"8px",fontSize:e?"13px":"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#2563EB",e.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="#3B82F6",e.currentTarget.style.transform="translateY(0)"},children:"설치하기"}),(0,i.jsx)("button",{onClick:c,style:{backgroundColor:"transparent",color:"#9CA3AF",border:"1px solid #4B5563",padding:e?"8px 16px":"10px 20px",borderRadius:"8px",fontSize:e?"13px":"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.1)",e.currentTarget.style.color="white"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.color="#9CA3AF"},children:"나중에"})]})]}),(0,i.jsx)("button",{onClick:c,style:{backgroundColor:"transparent",border:"none",color:"#9CA3AF",fontSize:"18px",cursor:"pointer",padding:"4px",borderRadius:"4px",lineHeight:1},onMouseEnter:e=>{e.currentTarget.style.color="white",e.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.1)"},onMouseLeave:e=>{e.currentTarget.style.color="#9CA3AF",e.currentTarget.style.backgroundColor="transparent"},children:"\xd7"})]}),(0,i.jsx)("div",{style:{marginTop:"16px",padding:"12px",backgroundColor:"rgba(59, 130, 246, 0.1)",borderRadius:"8px",border:"1px solid rgba(59, 130, 246, 0.2)"},children:(0,i.jsxs)("div",{style:{fontSize:e?"12px":"13px",color:"#93C5FD",display:"flex",flexDirection:"column",gap:"4px"},children:[(0,i.jsx)("div",{children:"✨ 홈 화면에서 바로 접근"}),(0,i.jsx)("div",{children:"\uD83D\uDE80 더 빠른 로딩 속도"}),(0,i.jsx)("div",{children:"\uD83D\uDCF1 네이티브 앱 같은 경험"}),(0,i.jsx)("div",{children:"\uD83D\uDD12 오프라인에서도 사용 가능"})]})})]})}function ez(){let[e,t]=(0,o.useState)(null),[n,r]=(0,o.useState)(!0),[s,d]=(0,o.useState)([]),[c,p]=(0,o.useState)(!0),[x,h]=(0,o.useState)("collection"),[b,f]=(0,o.useState)(!1),[v,j]=(0,o.useState)(!1),[_,w]=(0,o.useState)(!1),[C,S]=(0,o.useState)(!1),[D,A]=(0,o.useState)(null),[W,I]=(0,o.useState)(null),[T,E]=(0,o.useState)(null),M=()=>{f(!1),j(!1),w(!1),S(!1),A(null),I(null),E(null)},N=e=>{M(),h(e)},L=async()=>{try{p(!0);let{data:e,error:t}=await l.supabase.from("brands").select("*").order("name");if(t)throw t;d(e||[])}catch(e){}finally{p(!1)}},[O,U]=(0,o.useState)(!1),[q,H]=(0,o.useState)(""),[G,Y]=(0,o.useState)(""),[J,V]=(0,o.useState)(!1),[K,X]=(0,o.useState)(""),{isMobile:Z,isTablet:Q,isDesktop:$}=y(),ee=[{id:"collection",label:"위스키 컬렉션",icon:"\uD83E\uDD43"},{id:"tastings",label:"시음 기록",icon:"\uD83D\uDCDD"},{id:"statistics",label:"통계",icon:"\uD83D\uDCCA"},{id:"predictions",label:"취향",icon:"\uD83C\uDFAF"},{id:"recommendations",label:"추천",icon:"\uD83C\uDFAF"},{id:"wishlist",label:"위시리스트",icon:"❤️"},{id:"export",label:"데이터 관리",icon:"⚙️"}];(0,o.useEffect)(()=>{let e=e=>{"Escape"===e.key&&M()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[]),(0,o.useEffect)(()=>{(async()=>{let{data:{session:e}}=await l.supabase.auth.getSession();t(null==e?void 0:e.user),r(!1),(null==e?void 0:e.user)&&(u(),m().startAutoBackup(),L())})();let{data:{subscription:e}}=l.supabase.auth.onAuthStateChange((e,n)=>{t(null==n?void 0:n.user),r(!1),(null==n?void 0:n.user)?(u(),m().startAutoBackup()):(g(),m().stopAutoBackup())});return()=>{e.unsubscribe(),g(),m().stopAutoBackup()}},[]);let et=async e=>{e.preventDefault(),V(!0),X("");try{if(O){let{error:e}=await l.supabase.auth.signUp({email:q,password:G,options:{emailRedirectTo:"https://asurama.github.io/whisky-Log/"}});if(e)throw e;X("이메일을 확인하여 계정을 활성화해주세요.")}else{let{error:e}=await l.supabase.auth.signInWithPassword({email:q,password:G});if(e)throw e}}catch(e){X(e.message)}finally{V(!1)}};return n?(0,i.jsx)("div",{style:{width:"100vw",height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#111827",color:"white"},children:(0,i.jsxs)("div",{style:{textAlign:"center"},children:[(0,i.jsx)("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"\uD83E\uDD43"}),(0,i.jsx)("p",{children:"로딩중..."})]})}):e?(0,i.jsxs)("div",{style:{width:"100%",height:"100%",margin:0,padding:0,display:"flex",flexDirection:"column",position:"relative"},children:[e&&(0,i.jsx)(eB,{}),(0,i.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundImage:"\n          radial-gradient(circle at 20% 80%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),\n          radial-gradient(circle at 80% 20%, rgba(16, 185, 129, 0.1) 0%, transparent 50%),\n          radial-gradient(circle at 40% 40%, rgba(245, 158, 11, 0.1) 0%, transparent 50%)\n        ",pointerEvents:"none"}}),(0,i.jsxs)("div",{className:"glass",style:{padding:Z?"12px 16px":"20px",borderBottom:"1px solid rgba(255, 255, 255, 0.1)",display:"flex",justifyContent:"space-between",alignItems:"center",position:"relative",zIndex:10,flexWrap:"nowrap",minHeight:"fit-content"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:Z?"8px":"12px",cursor:"pointer",padding:"8px",borderRadius:"8px",transition:"all 0.2s ease",userSelect:"none",flexShrink:0},onClick:()=>h("collection"),onMouseEnter:e=>{e.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.1)",e.currentTarget.style.transform="scale(1.02)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.transform="scale(1)"},children:[(0,i.jsx)("div",{style:{width:Z?"24px":"36px",height:Z?"24px":"36px",filter:"drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3))",flexShrink:0,borderRadius:"8px",overflow:"hidden"},children:(0,i.jsx)("img",{src:"/whisky-Log/icons/icon-192x192.png",alt:"Whisky Log",style:{width:"100%",height:"100%",objectFit:"cover"}})}),(0,i.jsx)("h1",{style:{margin:0,fontSize:Z?"14px":"28px",fontWeight:"700",background:"linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",whiteSpace:"nowrap",flexShrink:0,lineHeight:Z?"1.1":"1.4",letterSpacing:Z?"-0.5px":"normal"},children:"Whisky Log"})]}),(0,i.jsx)("div",{style:{flexShrink:0},children:(0,i.jsx)(el,{user:e,onTabChange:N})})]}),Z?(0,i.jsx)(ea,{tabs:ee,activeTab:x,onTabChange:N,zIndex:b||v||_||C?100:1e3}):(0,i.jsx)(eo,{tabs:ee,activeTab:x,onTabChange:N}),(0,i.jsxs)("div",{className:Z?"mobile-scrollable mobile-content-fixed":"",style:{flex:1,overflow:"auto",paddingBottom:Z?"calc(72px + env(safe-area-inset-bottom))":"0",minHeight:Z?"calc(100vh - 72px - env(safe-area-inset-bottom))":"auto",maxHeight:Z?"calc(100vh - 72px - env(safe-area-inset-bottom))":"auto",WebkitOverflowScrolling:"touch",transform:"translateZ(0)",willChange:"scroll-position",position:"relative",top:0,transformOrigin:Z?"top center":"initial",WebkitTransformOrigin:Z?"top center":"initial"},children:["collection"===x&&(0,i.jsx)(k,{user:e,brands:s,onShowWhiskyModal:e=>{A(e||null),f(!0)},onShowTastingModal:e=>{E(e),j(!0)},onShowTastingHistory:e=>{E(e),w(!0)},onShowDetailModal:e=>{E(e),S(!0)}}),"tastings"===x&&(0,i.jsx)(B,{user:e,brands:s,onShowTastingModal:e=>{e&&e.id?(I(e),E(e.bottles||null)):e&&e.bottles?(I(null),E(e.bottles)):(I(null),E(null)),j(!0)}}),"statistics"===x&&(0,i.jsx)(z,{user:e,brands:s}),"predictions"===x&&(0,i.jsx)(F,{user:e,brands:s}),"recommendations"===x&&(0,i.jsx)(R,{user:e,brands:s}),"wishlist"===x&&(0,i.jsx)(P,{user:e,brands:s}),"export"===x&&(0,i.jsx)(er,{user:e,onBrandsUpdate:(e,t)=>{e?d(t=>{let n=t.findIndex(t=>t.id===e.id);if(!(n>=0))return[...t,e];{let i=[...t];return i[n]=e,i}}):t&&d(e=>e.filter(e=>e.id!==t))},brands:s})]}),b&&(Z?(0,i.jsx)("div",{style:{position:"fixed",top:window.scrollY+"px",left:0,right:0,bottom:"calc(100vh - ".concat(window.scrollY,"px)"),zIndex:999999,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsx)(ew,{user:e,brands:s,editingBottle:D,onClose:()=>{f(!1),A(null)},onBottleSaved:()=>{f(!1),A(null),window.location.reload()}})}):(0,i.jsx)(ew,{user:e,brands:s,editingBottle:D,onClose:()=>{f(!1),A(null)},onBottleSaved:()=>{f(!1),A(null),window.location.reload()}})),v&&(Z?(0,i.jsx)("div",{style:{position:"fixed",top:window.scrollY+"px",left:0,right:0,bottom:"calc(100vh - ".concat(window.scrollY,"px)"),zIndex:999999,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsx)(eC,{user:e,bottle:T,editingTasting:W,onClose:()=>{j(!1),E(null),I(null)},onTastingAdded:()=>{j(!1),E(null),I(null),window.location.reload()}})}):(0,i.jsx)(eC,{user:e,bottle:T,editingTasting:W,onClose:()=>{j(!1),E(null),I(null)},onTastingAdded:()=>{j(!1),E(null),I(null),window.location.reload()}})),_&&(Z?(0,i.jsx)("div",{style:{position:"fixed",top:window.scrollY+"px",left:0,right:0,bottom:"calc(100vh - ".concat(window.scrollY,"px)"),zIndex:999999,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsx)(ek,{user:e,bottle:T,onClose:()=>{w(!1),E(null)}})}):(0,i.jsx)(ek,{user:e,bottle:T,onClose:()=>{w(!1),E(null)}})),C&&(Z?(0,i.jsx)("div",{style:{position:"fixed",top:window.scrollY+"px",left:0,right:0,bottom:"calc(100vh - ".concat(window.scrollY,"px)"),zIndex:999999,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsx)(eD,{bottle:T,isOpen:C,onClose:()=>{S(!1),E(null)},onEdit:e=>{A(e),S(!1),f(!0)},onAddTasting:e=>{E(e),S(!1),j(!0)}})}):(0,i.jsx)(eD,{bottle:T,isOpen:C,onClose:()=>{S(!1),E(null)},onEdit:e=>{A(e),S(!1),f(!0)},onAddTasting:e=>{E(e),S(!1),j(!0)}}))]}):(0,i.jsxs)("div",{style:{width:"100vw",height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",position:"relative",overflow:"hidden"},className:"jsx-3095063c2c31268 gradient-bg",children:[(0,i.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundImage:"\n            radial-gradient(circle at 20% 80%, rgba(59, 130, 246, 0.15) 0%, transparent 50%),\n            radial-gradient(circle at 80% 20%, rgba(16, 185, 129, 0.15) 0%, transparent 50%),\n            radial-gradient(circle at 40% 40%, rgba(245, 158, 11, 0.15) 0%, transparent 50%)\n          ",pointerEvents:"none"},className:"jsx-3095063c2c31268"}),O&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{style:{position:"absolute",top:"10%",left:"10%",fontSize:"120px",opacity:.1,animation:"float 6s ease-in-out infinite",transform:"rotate(-15deg)"},className:"jsx-3095063c2c31268",children:"\uD83E\uDD43"}),(0,i.jsx)("div",{style:{position:"absolute",bottom:"15%",right:"10%",fontSize:"80px",opacity:.1,animation:"float 8s ease-in-out infinite reverse",transform:"rotate(15deg)"},className:"jsx-3095063c2c31268",children:"\uD83C\uDF77"}),(0,i.jsx)("div",{style:{position:"absolute",top:"50%",left:"5%",fontSize:"60px",opacity:.1,animation:"float 7s ease-in-out infinite",transform:"rotate(10deg)"},className:"jsx-3095063c2c31268",children:"\uD83C\uDF78"})]}),(0,i.jsxs)("div",{style:{padding:O?"40px":"32px",borderRadius:"20px",width:"90%",maxWidth:O?"500px":"400px",position:"relative",zIndex:10,border:O?"2px solid rgba(245, 158, 11, 0.3)":"1px solid rgba(255, 255, 255, 0.1)",boxShadow:O?"0 25px 50px -12px rgba(0, 0, 0, 0.4), 0 0 0 1px rgba(245, 158, 11, 0.1)":"0 10px 25px -5px rgba(0, 0, 0, 0.3)",transform:O?"scale(1.02)":"scale(1)",transition:"all 0.3s ease"},className:"jsx-3095063c2c31268 glass",children:[O&&(0,i.jsxs)("div",{style:{textAlign:"center",marginBottom:"30px",padding:"20px",borderRadius:"15px",background:"linear-gradient(135deg, rgba(245, 158, 11, 0.1) 0%, rgba(59, 130, 246, 0.1) 100%)",border:"1px solid rgba(245, 158, 11, 0.2)"},className:"jsx-3095063c2c31268",children:[(0,i.jsx)("div",{style:{fontSize:"48px",marginBottom:"10px"},className:"jsx-3095063c2c31268",children:"\uD83C\uDF89"}),(0,i.jsx)("h2",{style:{margin:"0 0 8px 0",fontSize:"28px",fontWeight:"700",background:"linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},className:"jsx-3095063c2c31268",children:"환영합니다!"}),(0,i.jsx)("p",{style:{margin:0,color:"#d1d5db",fontSize:"16px",fontWeight:"500"},className:"jsx-3095063c2c31268",children:"위스키 로그와 함께 특별한 여정을 시작하세요"})]}),!O&&(0,i.jsxs)("div",{style:{textAlign:"center",marginBottom:"24px"},className:"jsx-3095063c2c31268",children:[(0,i.jsx)("div",{style:{fontSize:"32px",marginBottom:"12px"},className:"jsx-3095063c2c31268",children:"\uD83E\uDD43"}),(0,i.jsx)("h2",{style:{margin:"0 0 8px 0",fontSize:"24px",fontWeight:"600",color:"white"},className:"jsx-3095063c2c31268",children:"로그인"}),(0,i.jsx)("p",{style:{margin:0,color:"#9ca3af",fontSize:"14px"},className:"jsx-3095063c2c31268",children:"위스키 로그에 오신 것을 환영합니다!"})]}),(0,i.jsxs)("form",{onSubmit:et,style:{marginBottom:"24px"},className:"jsx-3095063c2c31268",children:[(0,i.jsxs)("div",{style:{marginBottom:"16px"},className:"jsx-3095063c2c31268",children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"6px",color:"#d1d5db",fontSize:"14px",fontWeight:"500"},className:"jsx-3095063c2c31268",children:"이메일"}),(0,i.jsx)("input",{type:"email",placeholder:"your@email.com",value:q,onChange:e=>H(e.target.value),required:!0,style:{width:"100%",padding:"14px 16px",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"12px",backgroundColor:"rgba(255, 255, 255, 0.05)",color:"white",fontSize:"16px",transition:"all 0.3s ease",backdropFilter:"blur(10px)"},className:"jsx-3095063c2c31268 input-field"})]}),(0,i.jsxs)("div",{style:{marginBottom:"16px"},className:"jsx-3095063c2c31268",children:[(0,i.jsx)("label",{style:{display:"block",marginBottom:"6px",color:"#d1d5db",fontSize:"14px",fontWeight:"500"},className:"jsx-3095063c2c31268",children:"비밀번호"}),(0,i.jsx)("input",{type:"password",placeholder:O?"최소 6자 이상":"비밀번호",value:G,onChange:e=>Y(e.target.value),required:!0,style:{width:"100%",padding:"14px 16px",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"12px",backgroundColor:"rgba(255, 255, 255, 0.05)",color:"white",fontSize:"16px",transition:"all 0.3s ease",backdropFilter:"blur(10px)"},className:"jsx-3095063c2c31268 input-field"})]}),O&&(0,i.jsxs)("div",{style:{padding:"16px",borderRadius:"12px",backgroundColor:"rgba(59, 130, 246, 0.1)",border:"1px solid rgba(59, 130, 246, 0.2)",marginBottom:"16px"},className:"jsx-3095063c2c31268",children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},className:"jsx-3095063c2c31268",children:[(0,i.jsx)("span",{style:{fontSize:"16px"},className:"jsx-3095063c2c31268",children:"✨"}),(0,i.jsx)("span",{style:{color:"#60a5fa",fontSize:"14px",fontWeight:"600"},className:"jsx-3095063c2c31268",children:"회원가입 혜택"})]}),(0,i.jsxs)("ul",{style:{margin:0,paddingLeft:"20px",color:"#9ca3af",fontSize:"13px",lineHeight:"1.4"},className:"jsx-3095063c2c31268",children:[(0,i.jsx)("li",{className:"jsx-3095063c2c31268",children:"무제한 위스키 컬렉션 관리"}),(0,i.jsx)("li",{className:"jsx-3095063c2c31268",children:"상세한 시음 기록 작성"}),(0,i.jsx)("li",{className:"jsx-3095063c2c31268",children:"개인화된 통계 및 분석"}),(0,i.jsx)("li",{className:"jsx-3095063c2c31268",children:"데이터 백업 및 동기화"})]})]}),(0,i.jsx)("button",{type:"submit",disabled:J,style:{width:"100%",padding:"16px",border:"none",borderRadius:"12px",fontSize:"16px",fontWeight:"600",cursor:J?"not-allowed":"pointer",opacity:J?.6:1,marginBottom:"16px",background:O?"linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%)":"linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)",color:"white",transition:"all 0.3s ease",transform:J?"scale(0.98)":"scale(1)",boxShadow:O?"0 10px 25px -5px rgba(245, 158, 11, 0.4)":"0 10px 25px -5px rgba(59, 130, 246, 0.4)"},className:"jsx-3095063c2c31268 btn-primary",children:J?(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},className:"jsx-3095063c2c31268",children:[(0,i.jsx)("div",{style:{width:"16px",height:"16px",border:"2px solid rgba(255, 255, 255, 0.3)",borderTop:"2px solid white",borderRadius:"50%",animation:"spin 1s linear infinite"},className:"jsx-3095063c2c31268"}),"처리중..."]}):(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},className:"jsx-3095063c2c31268",children:O?"\uD83C\uDF89 회원가입 시작하기":"\uD83D\uDD10 로그인"})})]}),K&&(0,i.jsx)("div",{style:{padding:"16px",borderRadius:"12px",backgroundColor:K.includes("확인")?"rgba(16, 185, 129, 0.1)":"rgba(239, 68, 68, 0.1)",border:K.includes("확인")?"1px solid rgba(16, 185, 129, 0.2)":"1px solid rgba(239, 68, 68, 0.2)",color:K.includes("확인")?"#10b981":"#ef4444",fontSize:"14px",marginBottom:"16px",textAlign:"center",fontWeight:"500"},className:"jsx-3095063c2c31268",children:K}),(0,i.jsx)("button",{onClick:()=>{U(!O),X("")},style:{width:"100%",padding:"12px",backgroundColor:"transparent",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"12px",color:"#9ca3af",fontSize:"14px",cursor:"pointer",marginBottom:"16px",transition:"all 0.3s ease",backdropFilter:"blur(10px)"},className:"jsx-3095063c2c31268",children:O?"이미 계정이 있으신가요? 로그인":"계정이 없으신가요? 회원가입"}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"16px"},className:"jsx-3095063c2c31268",children:[(0,i.jsx)("div",{style:{flex:1,height:"1px",backgroundColor:"rgba(255, 255, 255, 0.1)"},className:"jsx-3095063c2c31268"}),(0,i.jsx)("span",{style:{padding:"0 16px",color:"#9ca3af",fontSize:"14px"},className:"jsx-3095063c2c31268",children:"또는"}),(0,i.jsx)("div",{style:{flex:1,height:"1px",backgroundColor:"rgba(255, 255, 255, 0.1)"},className:"jsx-3095063c2c31268"})]}),(0,i.jsxs)("button",{onClick:()=>l.supabase.auth.signInWithOAuth({provider:"google",options:{redirectTo:"https://asurama.github.io/whisky-Log/"}}),style:{width:"100%",padding:"16px",backgroundColor:"#4285f4",border:"none",borderRadius:"12px",color:"white",fontSize:"16px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",transition:"all 0.3s ease",boxShadow:"0 4px 6px -1px rgba(66, 133, 244, 0.3)"},className:"jsx-3095063c2c31268",children:[(0,i.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",className:"jsx-3095063c2c31268",children:[(0,i.jsx)("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",className:"jsx-3095063c2c31268"}),(0,i.jsx)("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",className:"jsx-3095063c2c31268"}),(0,i.jsx)("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",className:"jsx-3095063c2c31268"}),(0,i.jsx)("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",className:"jsx-3095063c2c31268"})]}),"Google로 로그인"]})]}),(0,i.jsx)(a(),{id:"3095063c2c31268",children:"@keyframes float{0%,100%{transform:translatey(0px)rotate(-15deg)}50%{transform:translatey(-20px)rotate(-15deg)}}@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}"})]})}n(4534)}},e=>{e.O(0,[111,524,78,441,964,358],()=>e(e.s=2609)),_N_E=e.O()}]);